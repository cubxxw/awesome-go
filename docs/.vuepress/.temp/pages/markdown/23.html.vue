<template><div><h1 id="goè¯­è¨€æ“ä½œredis" tabindex="-1"><a class="header-anchor" href="#goè¯­è¨€æ“ä½œredis" aria-hidden="true">#</a> Goè¯­è¨€æ“ä½œredis</h1>
<nav class="table-of-contents"><ul><li><router-link to="#goè¯­è¨€æ“ä½œredis-1">Goè¯­è¨€æ“ä½œredis</router-link></li><li><router-link to="#è¿æ¥æœ¬åœ°æœåŠ¡å™¨">è¿æ¥æœ¬åœ°æœåŠ¡å™¨</router-link></li><li><router-link to="#ä¼ ç»Ÿè¿æ¥redis">ä¼ ç»Ÿè¿æ¥redis:</router-link></li><li><router-link to="#è¿æ¥æ± ">è¿æ¥æ± </router-link></li><li><router-link to="#è¿æ¥æ± æ ¸å¿ƒä»£ç ">è¿æ¥æ± æ ¸å¿ƒä»£ç </router-link></li><li><router-link to="#end-é“¾æ¥">END é“¾æ¥</router-link></li></ul></nav>
<p>[toc]</p>
<p>ğŸ˜¶â€ğŸŒ«ï¸goè¯­è¨€å®˜æ–¹ç¼–ç¨‹æŒ‡å—ï¼š<a href="https://golang.org/#" target="_blank" rel="noopener noreferrer">https://golang.org/#<ExternalLinkIcon/></a></p>
<blockquote>
<p>goè¯­è¨€çš„å®˜æ–¹æ–‡æ¡£å­¦ä¹ ç¬”è®°å¾ˆå…¨ï¼Œæ¨èå»å®˜ç½‘å­¦ä¹ </p>
</blockquote>
<p>ğŸ˜¶â€ğŸŒ«ï¸æˆ‘çš„å­¦ä¹ ç¬”è®°ï¼šgithub: <a href="https://github.com/3293172751/golang-rearn" target="_blank" rel="noopener noreferrer">https://github.com/3293172751/golang-rearn<ExternalLinkIcon/></a></p>
<hr>
<p><strong>åŒºå—é“¾æŠ€æœ¯ï¼ˆä¹Ÿç§°ä¹‹ä¸ºåˆ†å¸ƒå¼è´¦æœ¬æŠ€æœ¯ï¼‰</strong>ï¼Œæ˜¯ä¸€ç§äº’è”ç½‘æ•°æ®åº“æŠ€æœ¯ï¼Œå…¶ç‰¹ç‚¹æ˜¯å»ä¸­å¿ƒåŒ–ï¼Œå…¬å¼€é€æ˜ï¼Œè®©æ¯ä¸€ä¸ªäººå‡å¯å‚ä¸çš„æ•°æ®åº“è®°å½•</p>
<blockquote>
<p>â¤ï¸ğŸ’•ğŸ’•å…³äºåŒºå—é“¾æŠ€æœ¯ï¼Œå¯ä»¥å…³æ³¨æˆ‘ï¼Œå…±åŒå­¦ä¹ æ›´å¤šçš„åŒºå—é“¾æŠ€æœ¯ã€‚åšå®¢<a href="http://nsddd.top" target="_blank" rel="noopener noreferrer">http://nsddd.top<ExternalLinkIcon/></a></p>
</blockquote>
<hr>
<h2 id="goè¯­è¨€æ“ä½œredis-1" tabindex="-1"><a class="header-anchor" href="#goè¯­è¨€æ“ä½œredis-1" aria-hidden="true">#</a> Goè¯­è¨€æ“ä½œredis</h2>
<p><strong>ä½¿ç”¨Goè¯­è¨€æ“ä½œrediséœ€è¦å®‰è£…ç¬¬ä¸‰æ–¹å¼€æºçš„redisåº“ï¼š<a href="https://github.com/garyburd/redigo/redis" target="_blank" rel="noopener noreferrer">github.com/garyburd/redigo/redis<ExternalLinkIcon/></a></strong></p>
<p>ç°åœ¨çš„åœ°å€ï¼šhttps://github.com/gomodule/redigo/tree/master/redis</p>
<p><strong>åœ¨gopathä¸‹é¢å®‰è£…æŒ‡ä»¤ï¼š</strong></p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>go get github.com/garyburd/redigo/redis
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>å‰æï¼šå®‰è£…git</strong></p>
<h2 id="è¿æ¥æœ¬åœ°æœåŠ¡å™¨" tabindex="-1"><a class="header-anchor" href="#è¿æ¥æœ¬åœ°æœåŠ¡å™¨" aria-hidden="true">#</a> è¿æ¥æœ¬åœ°æœåŠ¡å™¨</h2>
<div class="language-go ext-go line-numbers-mode"><pre v-pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
    <span class="token string">"github.com/garyburd/redigo/redis"</span>
	<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    conn<span class="token punctuation">,</span>err <span class="token operator">:=</span> redis<span class="token punctuation">.</span><span class="token function">Dial</span><span class="token punctuation">(</span><span class="token string">"tcp"</span><span class="token punctuation">,</span><span class="token string">"127.0.0.1:6379"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span><span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Ptintln</span><span class="token punctuation">(</span><span class="token string">"err  = "</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span>
       	<span class="token keyword">return</span> 
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"conn succ..."</span><span class="token punctuation">,</span>conn<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>åœ¨æˆ‘ä»¬è°ƒç”¨github.com/garyburd/redigo/rediséœ€è¦æŒåŒ…</strong></p>
<h2 id="ä¼ ç»Ÿè¿æ¥redis" tabindex="-1"><a class="header-anchor" href="#ä¼ ç»Ÿè¿æ¥redis" aria-hidden="true">#</a> ä¼ ç»Ÿè¿æ¥redis:</h2>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>conn := redis.Dial()
ä½¿ç”¨conn
conn.Close()
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="è¿æ¥æ± " tabindex="-1"><a class="header-anchor" href="#è¿æ¥æ± " aria-hidden="true">#</a> è¿æ¥æ± </h2>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>conn1
conn2
conn3
ç”¨å®Œä¸å…³ï¼Œæ­¤æ—¶ç”¨å®Œè¿˜æ˜¯å¯ä»¥è¿æ¥
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Golangéœ€è¦æ“ä½œredisï¼Œç›´æ¥é€šè¿‡è¿æ¥æ± </strong></p>
<ol>
<li>äº‹å…ˆåˆå§‹åŒ–ä¸€å®šæ•°é‡çš„è¿æ¥ï¼Œæ”¾åœ¨è¿æ¥æ± </li>
<li>å½“Goéœ€è¦æ“ä½œredisæ—¶å€™ï¼Œç›´æ¥ä»redisè¿æ¥æ± ä¸­å–å‡ºè¿æ¥</li>
</ol>
<blockquote>
<p>è¿™æ ·å¯ä»¥èŠ‚çº¦ä¸´æ—¶è·å–redisæ—¶é—´ï¼Œæé«˜æ•ˆç‡</p>
</blockquote>
<h2 id="è¿æ¥æ± æ ¸å¿ƒä»£ç " tabindex="-1"><a class="header-anchor" href="#è¿æ¥æ± æ ¸å¿ƒä»£ç " aria-hidden="true">#</a> è¿æ¥æ± æ ¸å¿ƒä»£ç </h2>
<div class="language-go ext-go line-numbers-mode"><pre v-pre class="language-go"><code><span class="token keyword">var</span> pool <span class="token operator">*</span>redis<span class="token punctuation">.</span>Pool
pool <span class="token operator">=</span> <span class="token operator">&amp;</span>redis<span class="token punctuation">.</span>Pool<span class="token punctuation">{</span>
	Maxldle<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">,</span>      <span class="token comment">//æœ€å¤§ç©ºé—²ï¼Œè¿æ¥æ•°ç›®</span>
	MaxActive<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>    <span class="token comment">//è¡¨ç¤ºå’Œæ•°æ®åº“çš„æœ€å¤§è¿æ¥æ•°</span>
	IdleTimeout<span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">,</span>   <span class="token comment">//æœ€å¤§ç©ºé—²æ—¶é—´</span>
	Dial<span class="token punctuation">:</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>redis<span class="token punctuation">.</span>Conn<span class="token punctuation">,</span><span class="token builtin">error</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment">//åˆå§‹åŒ–è¿æ¥ä»£ç ï¼Œè¿æ¥å“ªä¸€ä¸ªipçš„redis</span>
	<span class="token keyword">return</span> redis<span class="token punctuation">,</span><span class="token function">Dial</span><span class="token punctuation">(</span><span class="token string">"top"</span><span class="token punctuation">,</span><span class="token string">"localhost:6379"</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
c <span class="token operator">:=</span> pool<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment">//ä»è¿æ¥æ± ä¸­å–å‡ºä¸€ä¸ªé“¾æ¥</span>
pool<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>   <span class="token comment">//å…³é—­è¿æ¥æ± </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>**æœ€å¤§è¿æ¥æ•°æ˜¯æœ€å¤šçš„æœ‰å¤šå°‘è¿æ¥ï¼Œ<code v-pre>MaxActive:0,</code>è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼Œä½†æ˜¯ç³»ç»Ÿæ˜¯æœ‰é™åˆ¶çš„ï¼ˆå¹¶å‘å’ŒMaxIdleæ•°ç›®ï¼‰  **</p>
<p><strong>pool.Close()   å…³é—­è¿æ¥æ± åå°±ä¸å¯ä»¥å†ä»è¿æ¥æ± ä¸­å–å‡ºè¿æ¥äº†</strong></p>
<p>ğŸ’¡ç®€å•çš„ä¸€ä¸ªæ¡ˆä¾‹å¦‚ä¸‹ï¼š</p>
<div class="language-go ext-go line-numbers-mode"><pre v-pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"fmt"</span>
    <span class="token string">"github.com/garyburd/redigo/redis"</span>
<span class="token punctuation">)</span>

<span class="token comment">//å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡</span>
<span class="token keyword">var</span> pool <span class="token operator">*</span>redis<span class="token punctuation">.</span>Pool
<span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>   <span class="token comment">//æ³¨æ„ï¼šinitå‡½æ•°æ˜¯å…ˆæ‰§è¡Œçš„ï¼Œåœ¨ä¸»å‡½æ•°æ‰§è¡Œä¹‹å‰æ‰§è¡Œinitå‡½æ•°</span>
    
    pool <span class="token operator">=</span> <span class="token operator">&amp;</span>redis<span class="token punctuation">.</span>Pool<span class="token punctuation">{</span>
        Maxldle<span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">,</span>      <span class="token comment">//æœ€å¤§ç©ºé—²ï¼Œè¿æ¥æ•°ç›®</span>
        MaxActive<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>    <span class="token comment">//è¡¨ç¤ºå’Œæ•°æ®åº“çš„æœ€å¤§è¿æ¥æ•°</span>
        IdleTimeout<span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">,</span>   <span class="token comment">//æœ€å¤§ç©ºé—²æ—¶é—´</span>
        Dial<span class="token punctuation">:</span><span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>redis<span class="token punctuation">.</span>Conn<span class="token punctuation">,</span><span class="token builtin">error</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment">//åˆå§‹åŒ–è¿æ¥ä»£ç ï¼Œè¿æ¥å“ªä¸€ä¸ªipçš„redis</span>
        <span class="token keyword">return</span> redis<span class="token punctuation">,</span><span class="token function">Dial</span><span class="token punctuation">(</span><span class="token string">"top"</span><span class="token punctuation">,</span><span class="token string">"localhost:6379"</span><span class="token punctuation">)</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//å…ˆä»poolå–å‡ºä¸€ä¸ªè¿æ¥</span>
    conn<span class="token punctuation">,</span>err <span class="token operator">:=</span> pool<span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err<span class="token operator">!=</span> ok<span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"err = "</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">defer</span> conn<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>       <span class="token comment">//defer å»¶è¿Ÿå…³é—­ï¼Œdeferæ˜¯åœ¨å‡½æ•°éƒ½æ‰§è¡Œå®Œæ¯•åå…³é—­èµ„æº</span>

    <span class="token boolean">_</span><span class="token punctuation">,</span>err <span class="token operator">:=</span> conn<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token string">"set"</span><span class="token punctuation">,</span><span class="token string">"name"</span><span class="token punctuation">,</span><span class="token string">"æ±¤å§†çŒ«"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err<span class="token operator">!=</span> ok<span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"conn.Do err = "</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">//å–å‡º</span>
    r<span class="token punctuation">,</span>err <span class="token operator">:=</span> redis<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span>conn<span class="token punctuation">.</span><span class="token function">Do</span><span class="token punctuation">(</span><span class="token string">"Get"</span><span class="token punctuation">,</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">//è½¬ä¸ºå­—ç¬¦ä¸²</span>
    <span class="token keyword">if</span> err<span class="token operator">!=</span> ok<span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"conn.Do err = "</span><span class="token punctuation">,</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"r = "</span><span class="token punctuation">,</span>r<span class="token punctuation">)</span>
    
  
<span class="token punctuation">}</span><span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><em>yum</em></p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>r = æ±¤å§†çŒ«
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>å¦‚æœæˆ‘ä»¬è¦ä»poolä¸­å–å‡ºè¿æ¥ï¼Œä¸€å®šè¦ä¿è¯è¿æ¥æ± æ˜¯æ²¡æœ‰å…³é—­çš„ï¼ï¼ï¼ï¼ï¼ï¼</strong></p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>pool.Close()
conn2 := pool.Get()
  _,err := conn2.Do("set","name","æ±¤å§†çŒ«")
    if err!= ok{
        fmt.Println("conn.Do err = ",err)
    }
    
    //å–å‡º2
    r2,err := redis.String(conn.Do("Get","name"))
    //è½¬ä¸ºå­—ç¬¦ä¸²
    if err!= ok{
        fmt.Println("conn2.Do err = ",err)
    }
    fmt.Println("r2 = ",r2)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="end-é“¾æ¥" tabindex="-1"><a class="header-anchor" href="#end-é“¾æ¥" aria-hidden="true">#</a> END é“¾æ¥</h2>
<ul><li><div><a href = '22.md' style='float:left'>â¬†ï¸ä¸Šä¸€èŠ‚ğŸ”—</a><a href = '24.md' style='float: right'>â¬‡ï¸ä¸‹ä¸€èŠ‚ğŸ”—</a></div></li></ul>
<ul>
<li>
<p><RouterLink to="/">â“‚ï¸å›åˆ°ç›®å½•ğŸ </RouterLink></p>
</li>
<li>
<p><a href="https://nsddd.top/archives/contributors" target="_blank" rel="noopener noreferrer"><strong>ğŸ«µå‚ä¸è´¡çŒ®ğŸ’â¤ï¸â€ğŸ”¥ğŸ’–</strong><ExternalLinkIcon/></a>)</p>
</li>
<li>
<p>âœ´ï¸ç‰ˆæƒå£°æ˜ Â© :æœ¬ä¹¦æ‰€æœ‰å†…å®¹éµå¾ª<a href="http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="noopener noreferrer">CC-BY-SA 3.0åè®®ï¼ˆç½²å-ç›¸åŒæ–¹å¼å…±äº«ï¼‰Â©<ExternalLinkIcon/></a></p>
</li>
</ul>
</div></template>


