<template><div><h1 id="dockeræ­å»ºgitlab-æœåŠ¡å™¨" tabindex="-1"><a class="header-anchor" href="#dockeræ­å»ºgitlab-æœåŠ¡å™¨" aria-hidden="true">#</a> dockeræ­å»ºGitlab æœåŠ¡å™¨</h1>
<p>[toc]</p>
<h2 id="è­¦å‘Š" tabindex="-1"><a class="header-anchor" href="#è­¦å‘Š" aria-hidden="true">#</a> è­¦å‘Šï¼</h2>
<div class="custom-container danger"><p class="custom-container-title">âš ï¸ è­¦å‘Š</p>
<p>ä¸ªäººçº¯å±çˆ±å¥½ï¼Œæ­å»ºä¸ªäººçš„gitlabæœåŠ¡å™¨ï¼Œgitlabå¾ˆæ¶ˆè€—å†…å­˜</p>
</div>
<h2 id="å‰è¨€" tabindex="-1"><a class="header-anchor" href="#å‰è¨€" aria-hidden="true">#</a> å‰è¨€</h2>
<p>æˆ‘éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šé¢éƒ¨ç½²ä¸€ä¸ªä»“åº“ï¼Œæ–¹ä¾¿æäº¤ï¼Œè€Œä¸”ä¾›ä¸»æœºå’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®ä¼ è¾“</p>
<ul>
<li>ç³»ç»Ÿï¼šcentos</li>
</ul>
<h2 id="å®‰è£…é•œåƒ" tabindex="-1"><a class="header-anchor" href="#å®‰è£…é•œåƒ" aria-hidden="true">#</a> å®‰è£…é•œåƒ</h2>
<p>ğŸ‡«ğŸ‡®<strong>æŸ¥æ‰¾é•œåƒ</strong></p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code># æŸ¥æ‰¾Gitlabé•œåƒ
docker search gitlab
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ğŸ¤æ‹‰å–Gitlabé•œåƒ</strong></p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>docker pull gitlab/gitlab-ce:latest
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>ğŸŒ å¯åŠ¨dockeré•œåƒ</strong></p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token comment"># å¯åŠ¨å®¹å™¨</span>
<span class="token function">docker</span> run <span class="token punctuation">\</span>
 <span class="token parameter variable">-itd</span>  <span class="token punctuation">\</span>
 <span class="token parameter variable">-p</span> <span class="token number">9980</span>:80 <span class="token punctuation">\</span>
 <span class="token parameter variable">-p</span> <span class="token number">9922</span>:22 <span class="token punctuation">\</span>
 <span class="token parameter variable">-v</span> D:<span class="token punctuation">\</span>docker<span class="token punctuation">\</span>gitlab<span class="token punctuation">\</span>etc:/etc/gitlab  <span class="token punctuation">\</span>
 <span class="token parameter variable">-v</span> D:<span class="token punctuation">\</span>docker<span class="token punctuation">\</span>gitlab<span class="token punctuation">\</span>log:/var/log/gitlab <span class="token punctuation">\</span>
 <span class="token parameter variable">-v</span> D:<span class="token punctuation">\</span>docker<span class="token punctuation">\</span>gitlab<span class="token punctuation">\</span>opt:/var/opt/gitlab <span class="token punctuation">\</span>
 <span class="token parameter variable">--restart</span> always <span class="token punctuation">\</span>
 <span class="token parameter variable">--privileged</span><span class="token operator">=</span>true <span class="token punctuation">\</span>
 <span class="token parameter variable">--name</span> gitlab <span class="token punctuation">\</span>
 gitlab/gitlab-ce
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code># å¯åŠ¨å®¹å™¨
docker run -itd -p 9980:80 -p 9922:22 -v D:\docker\gitlab\etc:/etc/gitlab -v D:\docker\gitlab\log:/var/log/gitlab -v D:\docker\gitlab\opt:/var/opt/gitlab  --restart always --privileged=true --name gitlab gitlab/gitlab-ce
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ğŸˆ è§£é‡Šï¼š</p>
<table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>-i</td>
<td>ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨å‘½ä»¤è§£é‡Š</td>
</tr>
<tr>
<td>-t</td>
<td>ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨</td>
</tr>
<tr>
<td>-d</td>
<td>åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨ ID</td>
</tr>
<tr>
<td>-p 9980:80</td>
<td>å°†å®¹å™¨å†… 80 ç«¯å£æ˜ å°„è‡³å®¿ä¸»æœº 9980 ç«¯å£ï¼Œè¿™æ˜¯è®¿é—® gitlab çš„ç«¯å£</td>
</tr>
<tr>
<td>-p 9922:22</td>
<td>å°†å®¹å™¨å†… 22 ç«¯å£æ˜ å°„è‡³å®¿ä¸»æœº 9922 ç«¯å£ï¼Œè¿™æ˜¯è®¿é—® ssh çš„ç«¯å£</td>
</tr>
<tr>
<td>-v /home/gitlab/etc:/etc/gitlab</td>
<td>å°†å®¹å™¨ / etc/gitlab ç›®å½•æŒ‚è½½åˆ°å®¿ä¸»æœº / usr/local/gitlab-test/etc ç›®å½•ä¸‹ï¼Œè‹¥å®¿ä¸»æœºå†…æ­¤ç›®å½•ä¸å­˜åœ¨å°†ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œå…¶ä»–ä¸¤ä¸ªæŒ‚è½½åŒè¿™ä¸ªä¸€æ ·</td>
</tr>
<tr>
<td>--restart always</td>
<td>å®¹å™¨è‡ªå¯åŠ¨</td>
</tr>
<tr>
<td>--privileged=true</td>
<td>è®©å®¹å™¨è·å–å®¿ä¸»æœº root æƒé™</td>
</tr>
<tr>
<td>--name gitlab</td>
<td>è®¾ç½®å®¹å™¨åç§°ä¸º gitlab</td>
</tr>
<tr>
<td>gitlab/gitlab-ce</td>
<td>é•œåƒçš„åç§°ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥å†™é•œåƒ ID</td>
</tr>
</tbody>
</table>
<p><strong>ğŸ¤³ä¿®æ”¹é…ç½®</strong></p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token comment">#è¿›å®¹å™¨å†…éƒ¨</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> gitlab /bin/bash
 
<span class="token comment">#ä¿®æ”¹gitlab.rb</span>
<span class="token function">vi</span> /etc/gitlab/gitlab.rb
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>â¤ï¸ åŠ å…¥å¦‚ä¸‹</p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token comment">#gitlabè®¿é—®åœ°å€ï¼Œå¯ä»¥å†™åŸŸåã€‚å¦‚æœç«¯å£ä¸å†™çš„è¯é»˜è®¤ä¸º80ç«¯å£</span>
external_url <span class="token string">'http://192.168.124.194'</span>

<span class="token comment">#sshä¸»æœºip</span>
gitlab_rails<span class="token punctuation">[</span><span class="token string">'gitlab_ssh_host'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'192.168.124.194'</span>

<span class="token comment">#sshè¿æ¥ç«¯å£</span>
gitlab_rails<span class="token punctuation">[</span><span class="token string">'gitlab_shell_ssh_port'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">9922</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ğŸ¤è®©é…ç½®ç”Ÿæ•ˆ</p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>gitlab-ctl reconfigure
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote>
<p>âš ï¸ æ³¨æ„ä¸è¦é‡å¯ï¼Œ<code v-pre>/etc/gitlab/gitlab.rb</code>æ–‡ä»¶çš„é…ç½®ä¼šæ˜ å°„åˆ°<code v-pre>gitlab.yml</code>è¿™ä¸ªæ–‡ä»¶ï¼Œç”±äºå’±ä»¬åœ¨<a href="https://so.csdn.net/so/search?q=docker&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">docker<ExternalLinkIcon/></a>ä¸­è¿è¡Œï¼Œåœ¨<code v-pre>gitlab</code>ä¸Šç”Ÿæˆçš„<code v-pre>http</code>åœ°å€åº”è¯¥æ˜¯http://192.168.124.194:9980,æ‰€ä»¥ï¼Œè¦ä¿®æ”¹ä¸‹é¢æ–‡ä»¶</p>
</blockquote>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code># ä¿®æ”¹httpå’Œsshé…ç½®
vi /opt/gitlab/embedded/service/gitlab-rails/config/gitlab.yml
 
  gitlab:
    host: 192.168.124.194
    port: 9980 # è¿™é‡Œæ”¹ä¸º9980
    https: false
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://sm.nsddd.top/smimage-20220924225234548.png?xxw@nsddd.top" alt="image-20220924225234548"></p>
<p>ğŸ¤è®©é…ç½®ç”Ÿæ•ˆ å¹¶ä¸”é€€å‡ºå®¹å™¨</p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>gitlab-ctl reconfigure
exit
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æµè§ˆå™¨è®¿é—®" tabindex="-1"><a class="header-anchor" href="#æµè§ˆå™¨è®¿é—®" aria-hidden="true">#</a> æµè§ˆå™¨è®¿é—®</h2>
<p>è·¯å¾„è®¿é—®ï¼šhttp://192.168.124.194:9980/</p>
<blockquote>
<p>âš ï¸ æœºå™¨é…ç½®è¦å¤§äº<code v-pre>4g</code>ï¼Œå¦åˆ™å¾ˆå®¹æ˜“å¯åŠ¨ä¸äº†ï¼ŒæŠ¥<code v-pre>502</code></p>
<ul>
<li>ç¬¬ä¸€æ¬¡è®¿é—®ï¼Œä¼šè®©ä¿®æ”¹rootå¯†ç </li>
<li>ä¿®æ”¹åä»¥rootç”¨æˆ·ç™»å½•å³å¯</li>
</ul>
</blockquote>
<h3 id="ä¿®æ”¹å¯†ç " tabindex="-1"><a class="header-anchor" href="#ä¿®æ”¹å¯†ç " aria-hidden="true">#</a> ä¿®æ”¹å¯†ç </h3>
<p><strong>è¿›å…¥å®¹å™¨å†…éƒ¨ï¼š</strong></p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>docker exec -it gitlab /bin/bash
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>è¿›å…¥æ§åˆ¶å°ï¼š</strong></p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>gitlab-rails console -e production
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>æŸ¥è¯¢idä¸º1çš„ç”¨æˆ·ï¼Œidä¸º1çš„ç”¨æˆ·æ˜¯è¶…çº§ç®¡ç†å‘˜ï¼š</strong></p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>user = User.where(id:1).first
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="http://sm.nsddd.top/smimage-20220924230110134.png?xxw@nsddd.top" alt="image-20220924230110134"></p>
<p><strong>ä¿®æ”¹å¯†ç ä¸º<code v-pre>1234</code>ï¼š</strong></p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>user.password='1234' 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>ä¿å­˜ï¼š</strong></p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>user.save!
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>é€€å‡ºï¼š</strong></p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>exit
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="http://sm.nsddd.top/smimage-20220924230332131.png?xxw@nsddd.top" alt="image-20220924230332131"></p>
<h2 id="é‡ç½®ç®¡ç†å‘˜å¯†ç " tabindex="-1"><a class="header-anchor" href="#é‡ç½®ç®¡ç†å‘˜å¯†ç " aria-hidden="true">#</a> é‡ç½®ç®¡ç†å‘˜å¯†ç </h2>
<p><strong>è¿›å…¥docker gitlab å®¹å™¨ä¸­</strong></p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>docker exec -it gitlabï¼ˆå®¹å™¨åå­—ï¼‰ bash
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>è¿›å…¥gitlab æ§åˆ¶å°</strong></p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>gitlab-rails console -e production   #å¯èƒ½ä¼šç­‰å¥½å‡ ç§’é’Ÿ 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>æœç´¢ç”¨æˆ·</strong></p>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token comment">#è¿™é‡Œæä¾›ä¸¤ç§æœç´¢æ–¹å¼  é€šè¿‡id</span>
user <span class="token operator">=</span> User.where<span class="token punctuation">(</span>id:1<span class="token punctuation">)</span>.first
<span class="token comment">#æˆ–è€… é€šè¿‡ç”µå­é‚®ä»¶æœç´¢  æˆ–è€…ç”¨æˆ·å</span>
user <span class="token operator">=</span> User.find_by<span class="token punctuation">(</span>email:<span class="token string">'admin@example.com'</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://sm.nsddd.top/smsmimage-20220924231302178.png?xxw@nsddd.top" alt="asdf"></p>
<p><strong>ä¿®æ”¹å¯†ç </strong></p>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼šå¯†ç ä¸èƒ½è®¾ç½®å¤ªç®€å•ï¼Œæ•°æ®åº“æ²¡åŠæ³•é€šè¿‡</p>
</blockquote>
<div class="language-bash ext-sh line-numbers-mode"><pre v-pre class="language-bash"><code><span class="token comment">#æ³¨æ„è¿™ä¸¤ä¸ªé€‰é¡¹éƒ½å¾—è®¾ç½®,1234ä¸ºä½ è¦è®¾ç½®çš„å¯†ç </span>
user.password <span class="token operator">=</span><span class="token string">'1234'</span>
user.password_confirmation <span class="token operator">=</span><span class="token string">'1234'</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä¿å­˜é€€å‡ºï¼šwq</strong></p>
<div class="language-text ext-text line-numbers-mode"><pre v-pre class="language-text"><code>user.save!
exit
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="http://sm.nsddd.top/smimage-20220924232113215.png?xxw@nsddd.top" alt="image-20220924232113215"></p>
<p><strong>ç™»é™†æˆåŠŸğŸ˜˜ğŸ˜˜</strong><img src="http://sm.nsddd.top/smimage-20220924233008364.png?xxw@nsddd.top" alt="image-20220924233008364"></p>
</div></template>


