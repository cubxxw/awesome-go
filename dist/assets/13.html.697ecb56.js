import{_ as c,r as l,o as u,c as r,a as n,b as a,w as t,e as s,d as p}from"./app.bdc458db.js";const d={},k={href:"https://github.com/cubxxw/iam",target:"_blank",rel:"noopener noreferrer"},g=s("\u{1F525} \u5F00\u6E90\u5730\u5740"),v=n("h1",{id:"\u7B2C13\u8282-\u4ECE-0-\u7F16\u5199\u4E00\u4E2A\u65E5\u5FD7\u5305",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u7B2C13\u8282-\u4ECE-0-\u7F16\u5199\u4E00\u4E2A\u65E5\u5FD7\u5305","aria-hidden":"true"},"#"),s(" \u7B2C13\u8282 \u4ECE 0 \u7F16\u5199\u4E00\u4E2A\u65E5\u5FD7\u5305")],-1),m=n("br",null,null,-1),b=n("div",null,[n("a",{href:"12.md",style:{float:"left"}},"\u2B06\uFE0F\u4E0A\u4E00\u8282\u{1F517} "),n("a",{href:"14.md",style:{float:"right"}}," \u2B07\uFE0F\u4E0B\u4E00\u8282\u{1F517}")],-1),q=n("br",null,null,-1),f=s("\u2764\uFE0F\u{1F495}\u{1F495}During the winter vacation, I followed up and learned two projects: tiktok project and IAM project, and summarized and practiced the CloudNative project and Go language. I learned a lot in the process.Myblog:"),h={href:"http://nsddd.top/",target:"_blank",rel:"noopener noreferrer"},_=s("http://nsddd.top"),y=n("hr",null,null,-1),x={class:"table-of-contents"},L=s("\u4F18\u79C0\u7684\u5F00\u6E90\u65E5\u5FD7\u5305"),w=s("\u6807\u51C6\u5E93log\u5305\u4F7F\u7528"),I=s("glog"),F=s("logrus\u4ECB\u7ECD"),E=s("zap\u5305\u4ECB\u7ECD"),z=s("zap\u4F7F\u7528\u65B9\u6CD5"),C=s("\u5176\u5B83\u5F00\u6E90\u5305"),N=s("\u5F00\u6E90\u65E5\u5FD7\u5305\u9009\u62E9"),S=s("\u4ECE0\u7F16\u5199\u4E00\u4E2A\u65E5\u5FD7\u5305"),D=s("\u5B9A\u4E49\u65E5\u5FD7\u7EA7\u522B\u548C\u65E5\u5FD7\u9009\u9879"),O=s("\u521B\u5EFALogger\u53CA\u5404\u7EA7\u522B\u65E5\u5FD7\u6253\u5370\u65B9\u6CD5"),W=s("\u5C06\u65E5\u5FD7\u8F93\u51FA\u5230\u652F\u6301\u7684\u8F93\u51FA\u4E2D"),P=s("\u81EA\u5B9A\u4E49\u65E5\u5FD7\u8F93\u51FA\u683C\u5F0F"),T=s("\u6D4B\u8BD5\u65E5\u5FD7\u5305"),R=s("IAM\u9879\u76EE\u65E5\u5FD7\u5305\u8BBE\u8BA1"),V=s("\u603B\u7ED3"),A=s("\u8BFE\u540E\u7EC3\u4E60"),j=s("END \u94FE\u63A5"),K=p(`<p>[TOC]</p><h2 id="\u4F18\u79C0\u7684\u5F00\u6E90\u65E5\u5FD7\u5305" tabindex="-1"><a class="header-anchor" href="#\u4F18\u79C0\u7684\u5F00\u6E90\u65E5\u5FD7\u5305" aria-hidden="true">#</a> \u4F18\u79C0\u7684\u5F00\u6E90\u65E5\u5FD7\u5305</h2><p>\u5728\u505A\u9879\u76EE\u5F00\u53D1\u65F6\uFF0C\u6211\u4EEC\u53EF\u4EE5\u4ECE0\u7F16\u5199\u81EA\u5DF1\u7684\u65E5\u5FD7\u5305\u3001\u4E5F\u53EF\u4EE5\u4F7F\u7528Go\u8BED\u8A00\u6807\u51C6\u5E93\u7684log\u5305\uFF0C\u8FD8\u53EF\u4EE5\u4F7F\u7528\u5F00\u6E90\u7684\u65E5\u5FD7\u5305\uFF0C\u4F46\u66F4\u591A\u7684\u662F\u57FA\u4E8E\u4F18\u79C0\u7684\u5F00\u6E90\u65E5\u5FD7\u5305\u8FDB\u884C\u4E8C\u6B21\u5F00\u53D1\uFF0C\u6765\u5B9E\u73B0\u5B9A\u5236\u5316\u7684\u65E5\u5FD7\u529F\u80FD\u3002Go\u751F\u6001\u4E2D\u4E5F\u6709\u4E00\u4E9B\u975E\u5E38\u4F18\u79C0\u7684\u5F00\u6E90\u65E5\u5FD7\u5305\uFF0C\u4F8B\u5982\u6807\u51C6\u5E93log\u5305\u3001glog\u3001logrus\u3001zap\u3001seelog\u3001zerolog\u7B49\u3002\u7528\u7684\u6BD4\u8F83\u591A\u7684\u662F<code>glog</code>\u3001<code>logrus</code>\u548C<code>zap</code>\u3002</p><h2 id="\u6807\u51C6\u5E93log\u5305\u4F7F\u7528" tabindex="-1"><a class="header-anchor" href="#\u6807\u51C6\u5E93log\u5305\u4F7F\u7528" aria-hidden="true">#</a> \u6807\u51C6\u5E93log\u5305\u4F7F\u7528</h2><p>\u6807\u51C6\u5E93log\u5305\u529F\u80FD\u975E\u5E38\u7B80\u5355\uFF0C\u63D0\u4F9B\u4E86\u5F00\u7BB1\uFF0C\u4EC5\u63D0\u4F9B\u4E86Print\u3001Panic\u548CFatal\u4E09\u7C7B\u51FD\u6570\u7528\u4E8E\u65E5\u5FD7\u8F93\u51FA\u3002\u56E0\u4E3A\u662F\u6807\u51C6\u5E93\u81EA\u5E26\u7684\uFF0C\u6240\u4EE5\u4E0D\u9700\u8981\u6211\u4EEC\u4E0B\u8F7D\u5B89\u88C5\uFF0C\u4F7F\u7528\u8D77\u6765\u975E\u5E38\u65B9\u4FBF\u3002\u6807\u51C6\u5E93log\u5305\u53EA\u6709\u4E0D\u5230400\u884C\u7684\u4EE3\u7801\u91CF\uFF0C\u5982\u679C\u8BFB\u8005\u60F3\u7814\u7A76\u5982\u4F55\u5B9E\u73B0\u4E00\u4E2A\u65E5\u5FD7\u5305\uFF0C\u9605\u8BFB\u6807\u51C6\u5E93log\u5305\u662F\u4E00\u4E2A\u4E0D\u9519\u7684\u5F00\u59CB\u3002Go\u7684\u6807\u51C6\u5E93\u5927\u91CF\u4F7F\u7528\u4E86log\u5305\uFF0C\u4F8B\u5982\uFF1A<code>net/http\u3001net/rpc</code>\u7B49\u3002</p><p><strong>log\u5305\u4F7F\u7528</strong></p><p>\u5728\u4F7F\u7528log\u5305\u65F6\uFF0C\u9700\u8981\u9996\u5148\u521B\u5EFA\u4E00\u4E2A<code>*log. Logger</code>\u7C7B\u578B\u7684log\u5B9E\u4F8B\uFF0C\u6240\u6709\u7684\u65E5\u5FD7\u8F93\u51FA\u90FD\u662F\u901A\u8FC7\u8BE5\u5B9E\u4F8B\u63D0\u4F9B\u7684\u65B9\u6CD5\u6765\u5B8C\u6210\u7684\u3002</p><p>\u53EF\u4EE5\u4F7F\u7528log\u5305\u63D0\u4F9B\u7684\u5168\u5C40\u5168\u5C40\u53D8\u91CF<code>std</code>\uFF0C<code>std</code>\u5B9A\u4E49\u5982\u4E0B\uFF08\u4F4D\u4E8EGo\u6807\u51C6\u5305log\u76EE\u5F55\u4E0B\u7684log.go\u6587\u4EF6\u4E2D\uFF09\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> std <span class="token operator">=</span> <span class="token function">New</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Stderr<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> LstdFlags<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4E5F\u4E5F\u53EF\u4EE5\u4F7F\u7528<code>log.New\u51FD</code>\u6570\u521B\u5EFA\u81EA\u5DF1\u7684logger\uFF0C\u5728\u521B\u5EFA\u65F6\uFF0C\u53EF\u4EE5\u6307\u5B9A\u8F93\u51FA\u7684\u4F4D\u7F6E\u3001\u6BCF\u884C\u65E5\u5FD7\u7684\u524D\u7F00\u548C\u65E5\u5FD7\u5C5E\u6027\uFF0C\u4F8B\u5982\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>logger := log.New(logFile, &quot;[Debug]&quot;, log.Lshortfile)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6709\u5982\u4E0B\u51E0\u79CD\u65E5\u5FD7\u5C5E\u6027\u53EF\u4F9B\u9009\u62E9\uFF1A</p><ul><li>Ldate\uFF1A\u5F53\u524D\u65F6\u533A\u7684\u65E5\u671F\uFF0C\u683C\u5F0F\u662F\uFF1A2009/01/23\u3002</li><li>Ltime\uFF1A\u5F53\u524D\u65F6\u533A\u7684\u65F6\u95F4\uFF0C\u683C\u5F0F\u662F\uFF1A01:23:23\uFF0C\u7CBE\u786E\u5230\u79D2\u3002</li><li>Lmicroseconds\uFF1A\u5F53\u524D\u65F6\u533A\u7684\u65F6\u95F4\uFF0C\u683C\u5F0F\u662F\uFF1A01:23:23.862600\uFF0C\u7CBE\u786E\u5230\u5FAE\u5999\u3002</li><li>Llongfile\uFF1A\u5168\u6587\u4EF6\u540D\u548C\u884C\u53F7\u3002</li><li>Lshortfile\uFF1A\u5F53\u524D\u6587\u4EF6\u540D\u548C\u884C\u53F7\uFF0C\u4F1A\u8986\u76D6Llongfile\u3002</li><li>LUTC\uFF1A\u4F7F\u7528UTC\u800C\u975E\u672C\u5730\u65F6\u533A\u3002</li><li>Lmsgprefix\uFF1A\u5C06\u201C\u524D\u7F00\u201D\u4ECE\u884C\u7684\u5F00\u5934\u79FB\u81F3\u6D88\u606F\u4E4B\u524D\u3002</li><li>LstdFlags\uFF1A\u6807\u51C6Logger\u7684\u9ED8\u8BA4\u503C\uFF08Ldate\u3001Ltime\uFF09\u3002</li></ul><p>\u9664\u4E86\u5728\u6267\u884Clog.New\u65F6\u914D\u7F6Elog.Logger\u4E4B\u5916\uFF0C\u521B\u5EFA\u4E4B\u540E\u8FD8\u53EF\u4EE5\u901A\u8FC7log.Logger\u63D0\u4F9B\u76843\u79CD\u65B9\u6CD5\u6765\u6539\u53D8log.Logger\u7684\u914D\u7F6E\uFF1A</p><ul><li>SetOutput\uFF1A\u6307\u5B9A\u8F93\u51FA\u7684\u4F4D\u7F6E\u3002</li><li>SetPrefix\uFF1A\u8BBE\u7F6E\u6BCF\u884C\u65E5\u5FD7\u7684\u524D\u7F00\u3002</li><li>SetFlags\uFF1A\u8BBE\u7F6E\u65E5\u5FD7\u5C5E\u6027\u3002</li></ul><p>log.Logger\u63D0\u4F9B\u4E86Print\u3001Panic\u3001Fatal\u51FD\u6570\u6765\u8BB0\u5F55\u65E5\u5FD7\uFF1A</p><ul><li>Print\uFF1A\u6253\u5370\u65E5\u5FD7\uFF0C\u4F8B\u5982\uFF1Alog.Print(&quot;call Print: line1&quot;)</li><li>Panic\uFF1A\u6253\u5370\u65E5\u5FD7\u540E\u6267\u884Cpanic(s)\uFF0Cs\u4E3A\u65E5\u5FD7\u5185\u5BB9\u3002</li><li>Fatal\uFF1A\u6253\u5370\u65E5\u5FD7\u540E\u6267\u884Cos.Exit(1)\u3002</li></ul><p>Print\u3001Panic\u3001Fatal\u51FD\u6570\u8FD8\u63D0\u4F9BPrintln\u3001Printf\u3001Panicln\u3001Panicf\u3001Fatalln\u3001Fatalf\u6765\u683C\u5F0F\u5316\u6253\u5370\u65E5\u5FD7\u3002Print\u5E95\u5C42\u8C03\u7528<code>fmt.Sprint(v...)</code>\uFF0CPrintln\u5E95\u5C42\u8C03\u7528<code>fmt.Sprintln(v...)</code>\uFF0CPrintf\u5E95\u5C42\u8C03\u7528\u4E86<code>fmt.Sprintf(format, v...)</code>\u3002</p><p>\u6807\u51C6\u5E93log\u7684\u4F7F\u7528\u793A\u4F8B\uFF08main.go\u6587\u4EF6\uFF09\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>package main

import (
    &quot;log&quot;
    &quot;os&quot;
)

func main() {
    // \u8F93\u51FA\u5230\u6587\u4EF6
    logFile, err := os.Create(&quot;./log.log&quot;)
    defer logFile.Close()
    if err != nil {
        log.Fatalln(&quot;create file log.log failed&quot;)
    }
    logger := log.New(logFile, &quot;[Debug] &quot;, log.Lshortfile)
    logger.SetOutput(os.Stdout)
    logger.Print(&quot;call Print: line1&quot;)
    logger.Println(&quot;call Println: line2&quot;)

    // \u4FEE\u6539\u65E5\u5FD7\u914D\u7F6E
    logger.SetPrefix(&quot;[Info] &quot;)
    logger.SetFlags(log.Ldate)
    logger.SetOutput(os.Stdout)
    logger.Print(&quot;Info check stdout&quot;)
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6267\u884C\u5982\u4E0B\u547D\u4EE4\u6267\u884C\u4E0A\u8FF0\u7A0B\u5E8F\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ go run main.go
[Debug] main.go:17: call Print: line1
[Debug] main.go:18: call Println: line2
[Info] 2020/11/28 Info check stdout
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="glog" tabindex="-1"><a class="header-anchor" href="#glog" aria-hidden="true">#</a> glog</h2>`,23),G={href:"https://github.com/golang/glog",target:"_blank",rel:"noopener noreferrer"},M=s("glog"),X=s("\u662FGoogle\u63A8\u51FA\u7684\u65E5\u5FD7\u5305\uFF0C\u8DDF\u6807\u51C6\u5E93log\u5305\u4E00\u6837\uFF0C\u662F\u4E00\u4E2A\u8F7B\u91CF\u7EA7\u7684\u65E5\u5FD7\u5305\uFF0C\u4F7F\u7528\u7B80\u5355\u65B9\u4FBF\uFF0C\u4F46\u8981\u6BD4\u6807\u51C6\u5E93log\u5305\u63D0\u4F9B\u66F4\u591A\u7684\u529F\u80FD\uFF0Cglog\u5177\u6709\u5982\u4E0B\u7279\u6027\uFF1A"),B=p(`<ul><li>\u652F\u63014\u79CD\u65E5\u5FD7\u7EA7\u522B\uFF1AINFO\u3001WARNING\u3001ERROR\u3001FATAL\u3002</li><li>\u652F\u6301\u547D\u4EE4\u884C\u9009\u9879\uFF0C\u4F8B\u5982\uFF1A<code>-alsologtostderr</code>\u3001<code>-log_backtrace_at</code>\u3001<code>-log_dir</code>\u3001<code>-logtostderr</code>\u3001<code>-v</code>\u7B49\uFF0C\u6BCF\u4E2A\u53C2\u6570\u5B9E\u73B0\u67D0\u79CD\u529F\u80FD\u3002</li><li>\u652F\u6301\u6839\u636E\u6587\u4EF6\u5927\u5C0F\u5207\u5272\u65E5\u5FD7\u6587\u4EF6\u3002</li><li>\u652F\u6301\u65E5\u5FD7\u6309\u7EA7\u522B\u5206\u7C7B\u8F93\u51FA\u3002</li><li>\u652F\u6301V level\uFF0CV level\u7279\u6027\u53EF\u4EE5\u4F7F\u5F00\u53D1\u8005\u81EA\u5B9A\u4E49\u65E5\u5FD7\u7EA7\u522B\u3002</li><li>\u652F\u6301vmodule\uFF0Cvmodule\u53EF\u4EE5\u4F7F\u5F00\u53D1\u8005\u5BF9\u4E0D\u540C\u7684\u6587\u4EF6\u4F7F\u7528\u4E0D\u540C\u7684\u65E5\u5FD7\u7EA7\u522B\u3002</li><li>\u652F\u6301traceLocation\uFF0CtraceLocation\u53EF\u4EE5\u6253\u5370\u51FA\u6307\u5B9A\u4F4D\u7F6E\u7684\u6808\u4FE1\u606F\u3002</li></ul><p>kubernetes\u9879\u76EE\u5C31\u4F7F\u7528\u4E86\u57FA\u4E8Eglog\u5C01\u88C5\u7684klog\u4F5C\u4E3A\u5176\u65E5\u5FD7\u5E93\u3002</p><p><strong>glog\u4F7F\u7528\u65B9\u6CD5</strong></p><p>glog\u4F7F\u7528\u975E\u5E38\u7B80\u5355\uFF0C\u5E38\u89C1\u7684\u7528\u6CD5\u5982\u4E0B\u3002</p><ol><li>\u57FA\u672C\u7528\u6CD5</li></ol><p>glog\u7684\u6700\u5E38\u7528\u7684\u4F7F\u7528\u65B9\u6CD5\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>package main

import (
    &quot;flag&quot;

    &quot;github.com/golang/glog&quot;
)

func main() {
    glog.MaxSize = 1024 * 1024 * 1024 // 1G\u81EA\u52A8\u5206\u5272
    flag.Parse()
    defer glog.Flush()

    glog.Info(&quot;This is info message&quot;)
    glog.Infof(&quot;This is info message: %v&quot;, 123)

    glog.Warning(&quot;This is warning message&quot;)
    glog.Warningf(&quot;This is warning message: %v&quot;, 123)

    glog.Error(&quot;This is error message&quot;)
    glog.Errorf(&quot;This is error message: %v&quot;, 123)

    //glog.Fatal(&quot;This is fatal message&quot;)
    //glog.Fatalf(&quot;This is fatal message: %v&quot;, 123)
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>glog\u652F\u63014\u79CD\u65E5\u5FD7\u7EA7\u522B\uFF0C\u4ECE\u4F4E\u5230\u9AD8\u4F9D\u6B21\u4E3A\uFF1AINFO\u3001WARNING\u3001ERROR\u3001FATAL\u3002glog\u652F\u6301\u547D\u4EE4\u884C\u53C2\u6570\uFF0C\u5728\u7A0B\u5E8F\u4E2D\uFF0C\u53EA\u9700\u8981\u5728\u4F7F\u7528glog\u4E4B\u524D\u8C03\u7528flag.Parse()\u5373\u53EF\uFF0C\u652F\u6301\u5982\u4E0B7\u4E2A\u547D\u4EE4\u884C\u53C2\u6570\uFF1A</p><ul><li><code>-alsologtostderr</code>\uFF1A\u540C\u65F6\u5C06\u65E5\u5FD7\u6253\u5370\u5230\u6587\u4EF6\u548C\u6807\u51C6\u9519\u8BEF\u8F93\u51FA\u3002</li><li><code>-log_backtrace_at value</code>\uFF1A\u6307\u5B9A\u4EE3\u7801\u8FD0\u884C\u5230\u6307\u5B9A\u884C\u65F6\uFF0C\u628A\u8BE5\u4EE3\u7801\u7684\u6808\u4FE1\u606F\u6253\u5370\u51FA\u6765\u3002</li><li><code>-log_dir</code>\uFF1A\u6307\u5B9A\u65E5\u5FD7\u5B58\u50A8\u7684\u6587\u4EF6\u5939\u3002</li><li><code>-logtostderr</code>\uFF1A\u65E5\u5FD7\u6253\u5370\u5230\u6807\u51C6\u9519\u8BEF\u8F93\u51FA\uFF0C\u800C\u4E0D\u662F\u6587\u4EF6\u4E2D\u3002</li><li><code>-stderrthreshold value</code>\uFF1A\u6307\u5B9A\u5927\u4E8E\u6216\u8005\u7B49\u4E8E\u8BE5\u7EA7\u522B\u7684\u65E5\u5FD7\u624D\u4F1A\u88AB\u8F93\u51FA\u5230\u6807\u51C6\u9519\u8BEF\u8F93\u51FA\uFF0C\u9ED8\u8BA4\u4E3AERROR\u3002</li><li><code>-v value</code>\uFF1A\u6307\u5B9A\u65E5\u5FD7\u7EA7\u522B\u3002</li><li><code>-vmodule value</code>\uFF1A\u5BF9\u4E0D\u540C\u7684\u6587\u4EF6\u4F7F\u7528\u4E0D\u540C\u7684\u65E5\u5FD7\u7EA7\u522B\u3002</li></ul><p>\u6267\u884C\u4E0A\u8FF0\u4EE3\u7801\uFF08\u5047\u8BBE\u4FDD\u5B58\u5728example1.go\u6587\u4EF6\u4E2D\uFF09\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ mkdir -p log &amp;&amp; go run example1.go -log_dir=log -alsologtostderr
I1202 09:43:49.618480   26223 example1.go:14] This is info message
I1202 09:43:49.618781   26223 example1.go:15] This is info message: 123
W1202 09:43:49.618792   26223 example1.go:17] This is warning message
W1202 09:43:49.618830   26223 example1.go:18] This is warning message: 123
E1202 09:43:49.618840   26223 example1.go:20] This is error message
E1202 09:43:49.618877   26223 example1.go:21] This is error message: 123
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4EE5\u4E0A\u547D\u4EE4\u4F1A\u540C\u65F6\u5C06\u65E5\u5FD7\u6253\u5370\u5728log\u76EE\u5F55\u548C\u6807\u51C6\u9519\u8BEF\u8F93\u51FA\u4E2D\uFF08<code>-alsologtostderr</code>\uFF09\uFF0Clog\u76EE\u5F55\u4E0B\u6587\u4EF6\u5217\u8868\u4E3A\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>main.colin.colin.log.ERROR.20201202-081133.24123
main.colin.colin.log.INFO.20201202-081133.24123
main.colin.colin.log.WARNING.20201202-081133.24123
main.ERROR -&gt; main.colin.colin.log.ERROR.20201202-081133.24123
main.INFO -&gt; main.colin.colin.log.INFO.20201202-081133.24123
main.WARNING -&gt; main.colin.colin.log.WARNING.20201202-081133.24123
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>main.INFO\u6587\u4EF6\u662F\u4E00\u4E2A\u8F6F\u94FE\u63A5\uFF0C\u94FE\u63A5\u5230\u6700\u65B0\u7684INFO\u7EA7\u522B\u7684\u65E5\u5FD7\u6587\u4EF6\uFF0C\u4F4E\u4F18\u5148\u7EA7\u7684\u65E5\u5FD7\u6587\u4EF6\u5305\u542B\u9AD8\u4F18\u5148\u7EA7\u7684\u65E5\u5FD7\uFF0C\u4F8B\u5982INFO\u7EA7\u522B\u7684\u65E5\u5FD7\u6587\u4EF6\u4E2D\u5305\u542BWARNING\u3001ERROR\u3001FATAL\u7EA7\u522B\u7684\u65E5\u5FD7\u3002\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u5F53\u5355\u4E2A\u65E5\u5FD7\u6587\u4EF6\u8FBE\u52301.8G\u65F6,\uFF0Cglog\u4F1A\u5BF9\u65E5\u5FD7\u6587\u4EF6\u8FDB\u884C\u8F6C\u5B58\uFF1A\u5173\u95ED\u5F53\u524D\u7684\u6587\u4EF6\uFF0C\u65B0\u5EFA\u65E5\u5FD7\u6587\u4EF6\uFF0C\u53EF\u4EE5\u901A\u8FC7glog.MaxSize\u8BBE\u7F6E\u8F6C\u5B58\u9608\u503C\u3002</p><p>\u4ECE\u4E0A\u9762\u7684\u8F93\u51FA\u53EF\u4EE5\u53D1\u73B0\uFF0Cglog\u7684\u65E5\u5FD7\u8F93\u51FA\u683C\u5F0F\u4E3A\uFF1A<code>&lt;header&gt;] &lt;message&gt;</code>\uFF0C\u5176\u4E2Dheader\u7684\u683C\u5F0F\u4E3A\uFF1A<code>Lmmdd hh:mm:ss.uuuuuu threadid file:line</code>\uFF1A</p><ul><li>Lmmdd\uFF1AL\u4EE3\u8868\u4E86glog\u7684\u65E5\u5FD7\u7EA7\u522B\uFF1AI -&gt; INFO\u3001W -&gt; WARNING\u3001E -&gt; ERROR\u3001F -&gt; FATAL\u3002</li><li>hh:mm:ss.uuuuuu\uFF1A\u4EE3\u8868\u4E86\u65F6\u95F4\u4FE1\u606F\uFF0C\u4F8B\u598210:12:32.995956\u3002</li><li>threadid\uFF0C\u662F\u8FDB\u7A0BPID\uFF0C\u5373os.Getpid()\u7684\u8FD4\u56DE\u503C\u3002</li><li>file:line\uFF1A\u6307\u660E\u4E86\u6253\u5370\u65E5\u5FD7\u7684\u4F4D\u7F6E\uFF1A\u6587\u4EF6\u540D\u548C\u884C\u53F7\u3002</li></ul><p>\u4F7F\u7528glog.Info\u3001glog.Warning\u7B49\u51FD\u6570\u8BB0\u5F55\u65E5\u5FD7\u540E\uFF0C\u4E3A\u4E86\u63D0\u9AD8\u6027\u80FD\uFF0C\u8FD9\u4E9B\u65E5\u5FD7\u4F1A\u6682\u5B58\u5728\u5185\u5B58\u7684buffer\u4E2D\uFF0C\u800C\u4E0D\u662F\u76F4\u63A5\u5199\u5165\u6587\u4EF6\u4E2D\uFF0C\u53EA\u6709\u663E\u5F0F\u7684\u8C03\u7528glog.Flush()\uFF0C\u6570\u636E\u624D\u4F1A\u88AB\u5199\u5165\u6587\u4EF6\u3002glog\u7684init\u51FD\u6570\u4E2D\u542F\u52A8\u4E86\u4E00\u4E2Agoroutine\u6765\u5468\u671F\u6027\u7684\u8C03\u7528glog.Flush()\uFF0C\u9ED8\u8BA4\u7684flush\u95F4\u9694\u4E3A30\u79D2\u3002\u5982\u679C\u7A0B\u5E8F\u9000\u51FA\uFF0C\u81EA\u4E0A\u6B21glog.Flush()\u51FD\u6570\u6267\u884C\u4E4B\u540E\u4EA7\u751F\u7684\u65E5\u5FD7\uFF0C\u5C31\u4F1A\u88AB\u4E22\u5931\uFF0C\u6240\u4EE5\u5728\u7A0B\u5E8F\u9000\u51FA\u65F6\uFF0C\u9700\u8981\u8C03\u7528glog.Flush()\u5C06\u65E5\u5FD7\u5237\u65B0\u5230\u78C1\u76D8\u6587\u4EF6\u4E2D\u3002</p><p>\u8FD9\u91CC\u8981\u6CE8\u610F\uFF0C\u8C03\u7528glog.Fatal\u51FD\u6570\u540E\uFF0Cglog\u4F1A\u6253\u5370\u65E5\u5FD7\u5E76\u9000\u51FA\u7A0B\u5E8F\uFF0C\u5728\u7A0B\u5E8F\u9000\u51FA\u524D\uFF0C\u4F1A\u5C06\u7F13\u5B58\u4E2D\u7684\u6240\u6709\u65E5\u5FD7\u90FD\u5199\u5165\u65E5\u5FD7\uFF0C\u4F46\u662F\u5BF9\u4E8Eglog.Info\u3001glog.Warning\u3001glog.Error\u51FD\u6570\u5219\u4E0D\u4F1A\u3002</p><ol><li>vmodule\u529F\u80FD</li></ol><p>glog \u6700\u5E38\u7528\u7684\u5C31\u662F V level \u7684\u529F\u80FD\uFF0CV\u8D8A\u5C0F\uFF0C\u8BF4\u660E\u65E5\u5FD7\u7EA7\u522B\u8D8A\u9AD8\u3002\u793A\u4F8B\u5982\u4E0B\uFF1A\uFF08\u4FDD\u5B58\u5728example2.go\u6587\u4EF6\u4E2D\uFF09\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>package main

import (
    &quot;flag&quot;

    &quot;github.com/golang/glog&quot;
)

func main() {
    flag.Parse()
    defer glog.Flush()

    glog.V(3).Info(&quot;LEVEL 3 message&quot;) // \u4F7F\u7528\u65E5\u5FD7\u7EA7\u522B 3
    glog.V(5).Info(&quot;LEVEL 5 message&quot;) // \u4F7F\u7528\u65E5\u5FD7\u7EA7\u522B 5
    glog.V(7).Info(&quot;LEVEL 7 message&quot;) // \u4F7F\u7528\u65E5\u5FD7\u7EA7\u522B 7
    glog.V(8).Info(&quot;LEVEL 8 message&quot;) // \u4F7F\u7528\u65E5\u5FD7\u7EA7\u522B 8
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6267\u884C\u4E0A\u8FF0\u4EE3\u7801\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ go run example2.go -log_dir=log -alsologtostderr
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4E0A\u9762\u7684\u547D\u4EE4\u4E0D\u4F1A\u6709\u4EFB\u4F55\u8F93\u51FA\uFF0C\u56E0\u4E3A\u65E5\u5FD7\u7EA7\u522B\u4E0D\u591F\uFF0C\u53EF\u4EE5\u901A\u8FC7<code>-v</code>\u8BBE\u7F6E\u65E5\u5FD7\u7EA7\u522B\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ go run example2.go -log_dir=log -alsologtostderr -v=5
I1202 09:52:44.163989   29042 example2.go:13] LEVEL 3 message
I1202 09:52:44.164335   29042 example2.go:14] LEVEL 5 message
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6B64\u65F6\uFF0C\u65E5\u5FD7\u7EA7\u522B\u9AD8\u4E8E\u6216\u8005\u7B49\u4E8E5\uFF08V\u503C\u5C0F\u4E8E\u6216\u8005\u7B49\u4E8E5\uFF09\u7684\u65E5\u5FD7\u5C06\u88AB\u6253\u5370\u51FA\u6765\u3002</p><p>glog\u8FD8\u652F\u6301\u5BF9\u4E0D\u540C\u7684\u6587\u4EF6\u4F7F\u7528\u4E0D\u540C\u7684\u65E5\u5FD7\u7EA7\u522B\uFF08<code>-vmodule</code>\uFF09\uFF0C\u4F8B\u5982\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ go run main.go foo.go -v=3 -log_dir=log -alsologtostderr -vmodule=foo=5
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u901A\u8FC7\u6307\u5B9A<code>-vmodule=foo=5</code>\u53C2\u6570\uFF0C\u53EF\u4EE5\u8BBE\u7F6E\u5BF9foo.go\u6587\u4EF6\u4F7F\u75285\u7EA7\u522B\uFF0C\u5BF9\u5176\u5B83\u6587\u4EF6\u4F7F\u75283\u7EA7\u522B\u3002<code>-vmodule</code>\u7684\u8F93\u5165\u53C2\u6570\u7701\u53BB\u4E86.go\u540E\u7F00\uFF0C\u8BED\u6CD5\u683C\u5F0F\u4E3A\uFF1A<code>-vmodule=file1=2,file2=1,fs*=3</code>\u3002</p><ol><li>traceLocation\u529F\u80FD</li></ol><p>traceLocation\u53EF\u4EE5\u6253\u5370\u51FA\u6307\u5B9A\u4F4D\u7F6E\u7684\u6808\u4FE1\u606F\uFF08<code>-log_backtrace_at=filename:line_number</code>\uFF09\uFF0C\u4F8B\u5982\u6709\u5982\u4E0B\u4EE3\u7801\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;flag&quot;</span>

    <span class="token string">&quot;github.com/golang/glog&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    glog<span class="token punctuation">.</span>MaxSize <span class="token operator">=</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token comment">// 1G\u81EA\u52A8\u5206\u5272</span>
    flag<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">defer</span> glog<span class="token punctuation">.</span><span class="token function">Flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    glog<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;This is info message&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6267\u884C\u4EE5\u4E0A\u4EE3\u7801\uFF08\u4FDD\u5B58\u5728example3.go\u6587\u4EF6\u4E2D\uFF09\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ go run example3.go -log_dir=log -alsologtostderr -log_backtrace_at=example3.go:13
I1202 10:12:41.304582    1340 example3.go:13] This is info message
goroutine 1 [running]:
... \u6253\u5370backtrace\uFF0C\u6B64\u5904\u7701\u7565 ...
I1202 10:12:41.304779    1340 example3.go:14] This is info message: 123
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="logrus\u4ECB\u7ECD" tabindex="-1"><a class="header-anchor" href="#logrus\u4ECB\u7ECD" aria-hidden="true">#</a> logrus\u4ECB\u7ECD</h2>`,35),U={href:"https://github.com/sirupsen/logrus",target:"_blank",rel:"noopener noreferrer"},H=s("logrus"),J=s("\u662F\u76EE\u524DGithub\u4E0Astar\u6570\u91CF\u6700\u591A\u7684\u65E5\u5FD7\u5305\uFF0C\u529F\u80FD\u5F3A\u5927\u3001\u6027\u80FD\u9AD8\u6548\u3001\u9AD8\u5EA6\u7075\u6D3B\uFF0C\u8FD8\u63D0\u4F9B\u4E86\u81EA\u5B9A\u4E49\u63D2\u4EF6\u7684\u529F\u80FD\u3002\u5F88\u591A\u4F18\u79C0\u7684\u5F00\u6E90\u9879\u76EE\uFF0C\u4F8B\u5982\uFF1A"),$=n("code",null,"docker",-1),Y=s("\u3001"),Q=n("code",null,"prometheus",-1),Z=s("\u7B49\u90FD\u4F7F\u7528\u4E86logrus\u3002logrus\u9664\u4E86\u5177\u6709\u65E5\u5FD7\u7684\u57FA\u672C\u529F\u80FD\u5916\uFF0C\u8FD8\u5177\u6709\u5982\u4E0B\u7279\u6027\uFF1A"),nn=p(`<ul><li>\u652F\u6301\u5E38\u7528\u7684\u65E5\u5FD7\u7EA7\u522B\uFF0Clogrus\u652F\u6301\u5982\u4E0B\u65E5\u5FD7\u7EA7\u522B\uFF1ADebug\u3001Info\u3001Warn\u3001Error\u3001Fatal\u548CPanic\u3002</li><li>\u53EF\u6269\u5C55\uFF0Clogrus\u7684hook\u673A\u5236\u5141\u8BB8\u4F7F\u7528\u8005\u901A\u8FC7hook\u7684\u65B9\u5F0F\u5C06\u65E5\u5FD7\u5206\u53D1\u5230\u4EFB\u610F\u5730\u65B9\uFF0C\u4F8B\u5982\uFF1A\u672C\u5730\u6587\u4EF6\u3001\u6807\u51C6\u8F93\u51FA\u3001elasticsearch\u3001logstash\u3001kafka\u7B49\u3002</li><li>\u652F\u6301\u81EA\u5B9A\u4E49\u65E5\u5FD7\u683C\u5F0F\uFF0Clogrus\u5185\u7F6E\u4E862\u79CD\u683C\u5F0F\uFF1AJSONFormatter\u548CTextFormatter\u3002\u9664\u6B64\u4E4B\u5916\uFF0Clogrus\u5141\u8BB8\u4F7F\u7528\u8005\u901A\u8FC7\u5B9E\u73B0Formatter\u63A5\u53E3\uFF0C\u6765\u81EA\u5B9A\u4E49\u65E5\u5FD7\u683C\u5F0F\u3002</li><li>\u7ED3\u6784\u5316\u65E5\u5FD7\u8BB0\u5F55\uFF0Clogrus\u7684Field\u673A\u5236\u53EF\u4EE5\u5141\u8BB8\u4F7F\u7528\u8005\u81EA\u5B9A\u4E49\u65E5\u5FD7\u5B57\u6BB5\uFF0C\u800C\u4E0D\u662F\u901A\u8FC7\u5197\u957F\u7684\u6D88\u606F\u6765\u8BB0\u5F55\u65E5\u5FD7\u3002</li><li>\u9884\u8BBE\u65E5\u5FD7\u5B57\u6BB5\uFF0Clogrus\u7684Default Fields\u673A\u5236\u53EF\u4EE5\u7ED9\u4E00\u90E8\u5206\u6216\u8005\u5168\u90E8\u65E5\u5FD7\u7EDF\u4E00\u6DFB\u52A0\u5171\u540C\u7684\u65E5\u5FD7\u5B57\u6BB5\uFF0C\u4F8B\u5982\u7ED9\u67D0\u6B21HTTP\u8BF7\u6C42\u7684\u6240\u6709\u65E5\u5FD7\u6DFB\u52A0X-Request-ID\u5B57\u6BB5\u3002</li><li>Fatal handlers\uFF1Alogrus\u5141\u8BB8\u6CE8\u518C\u4E00\u4E2A\u6216\u591A\u4E2Ahandler\uFF0C\u5F53\u53D1\u751Ffatal\u7EA7\u522B\u7684\u65E5\u5FD7\u65F6\u8C03\u7528\u3002\u5F53\u6211\u4EEC\u7684\u7A0B\u5E8F\u9700\u8981\u4F18\u96C5\u5173\u95ED\u65F6\uFF0C\u8BE5\u7279\u6027\u4F1A\u975E\u5E38\u6709\u7528\u3002</li></ul><p>logrus\u4F7F\u7528\u65B9\u6CD5\u5982\u4E0B\uFF1A</p><ol><li>\u57FA\u672C\u7528\u6CD5</li></ol><p>logrus\u53EF\u4EE5\u901A\u8FC7\u7B80\u5355\u7684\u914D\u7F6E\uFF0C\u6765\u5B9A\u4E49\u8F93\u51FA\u3001\u683C\u5F0F\u6216\u8005\u65E5\u5FD7\u7EA7\u522B\u7B49\uFF0C\u793A\u4F8B\u5982\u4E0B\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;os&quot;</span>

    <span class="token string">&quot;github.com/sirupsen/logrus&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// logrus\u8BBE\u7F6E</span>
    logrus<span class="token punctuation">.</span><span class="token function">SetFormatter</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>logrus<span class="token punctuation">.</span>JSONFormatter<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    logrus<span class="token punctuation">.</span><span class="token function">SetOutput</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>Stdout<span class="token punctuation">)</span>
    logrus<span class="token punctuation">.</span><span class="token function">SetLevel</span><span class="token punctuation">(</span>logrus<span class="token punctuation">.</span>WarnLevel<span class="token punctuation">)</span>

    <span class="token comment">// logrus\u4F7F\u7528</span>
    logrus<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token string">&quot;Useful debugging information.&quot;</span><span class="token punctuation">)</span>
    logrus<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;Something noteworthy happened!&quot;</span><span class="token punctuation">)</span>
    logrus<span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">&quot;You should probably take a look at this.&quot;</span><span class="token punctuation">)</span>
    logrus<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Something failed but I&#39;m not quitting.&quot;</span><span class="token punctuation">)</span>

    logrus<span class="token punctuation">.</span><span class="token function">WithFields</span><span class="token punctuation">(</span>logrus<span class="token punctuation">.</span>Fields<span class="token punctuation">{</span>
        <span class="token string">&quot;animal&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;walrus&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;size&quot;</span><span class="token punctuation">:</span>   <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;A group of walrus emerges from the ocean&quot;</span><span class="token punctuation">)</span>

    logrus<span class="token punctuation">.</span><span class="token function">WithFields</span><span class="token punctuation">(</span>logrus<span class="token punctuation">.</span>Fields<span class="token punctuation">{</span>
        <span class="token string">&quot;omg&quot;</span><span class="token punctuation">:</span>    <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token string">&quot;number&quot;</span><span class="token punctuation">:</span> <span class="token number">122</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Warn</span><span class="token punctuation">(</span><span class="token string">&quot;The group&#39;s number increased tremendously!&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u901A\u8FC7logrus.SetFormatter\u8BBE\u7F6E\u8F93\u51FA\u7684\u65E5\u5FD7\u683C\u5F0F\uFF0Clogrus\u81EA\u5E26\u6709JSONFormatter\u548CTextFormatter\u3002\u901A\u8FC7logrus.SetLevel\u6765\u8BBE\u7F6E\u65E5\u5FD7\u7EA7\u522B\uFF0C\u901A\u8FC7logrus.SetOutput\u8BBE\u7F6E\u65E5\u5FD7\u8F93\u51FA\u7B49\u3002</p><p>\u5047\u8BBE\u4E0A\u8FF0\u4EE3\u7801\u4FDD\u5B58\u5728example1.go\u6587\u4EF6\u4E2D\uFF0C\u8FD0\u884C\u4EE3\u7801\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ go run example1.go
{&quot;level&quot;:&quot;warning&quot;,&quot;msg&quot;:&quot;You should probably take a look at this.&quot;,&quot;time&quot;:&quot;2020-12-03T22:35:35+08:00&quot;}
{&quot;level&quot;:&quot;error&quot;,&quot;msg&quot;:&quot;Something failed but I&#39;m not quitting.&quot;,&quot;time&quot;:&quot;2020-12-03T22:35:35+08:00&quot;}
{&quot;level&quot;:&quot;warning&quot;,&quot;msg&quot;:&quot;The group&#39;s number increased tremendously!&quot;,&quot;number&quot;:122,&quot;omg&quot;:true,&quot;time&quot;:&quot;2020-12-03T22:35:35+08:00&quot;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>Default Fields</li></ol><p>\u901A\u5E38\uFF0C\u5728\u4E00\u4E2A\u5E94\u7528\u4E2D\u3001\u6216\u8005\u5E94\u7528\u7684\u4E00\u90E8\u5206\u4E2D\uFF0C\u59CB\u7EC8\u9644\u5E26\u4E00\u4E9B\u56FA\u5B9A\u7684\u8BB0\u5F55\u5B57\u6BB5\u4F1A\u5F88\u6709\u5E2E\u52A9\u3002\u6BD4\u5982\u5728\u5904\u7406\u7528\u6237HTTP\u8BF7\u6C42\u65F6\uFF0C\u4E0A\u4E0B\u6587\u4E2D\u6240\u6709\u7684\u65E5\u5FD7\u90FD\u4F1A\u6709request_id\u3002\u4E3A\u4E86\u907F\u514D\u6BCF\u6B21\u8BB0\u5F55\u65E5\u5FD7\u90FD\u8981\u4F7F\u7528\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>logrus.WithFields(logrus.Fields{&quot;request_id\u201D&quot;, request_id})
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6211\u4EEC\u53EF\u4EE5\u521B\u5EFA\u4E00\u4E2Alogrus.Entry\u5B9E\u4F8B\uFF0C\u4E3A\u8FD9\u4E2A\u5B9E\u4F8B\u8BBE\u7F6E\u9ED8\u8BA4Fields\uFF0C\u628Alogrus.Entry\u5B9E\u4F8B\u8BBE\u7F6E\u5230\u8BB0\u5F55\u5668Logger\uFF0C\u518D\u8BB0\u5F55\u65E5\u5FD7\u65F6\u6BCF\u6B21\u90FD\u4F1A\u9644\u5E26\u4E0A\u8FD9\u4E9B\u9ED8\u8BA4\u7684\u5B57\u6BB5\u3002</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>logger := log.WithFields(log.Fields{&quot;request_id&quot;: request_id})
logger.Info(&quot;something happened on that request&quot;) // \u4E5F\u4F1A\u8BB0\u5F55request_id
logger.Warn(&quot;something not great happened&quot;)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li>Hook\u63A5\u53E3</li></ol><p>logrus\u5177\u6709hook\u80FD\u529B\uFF0C\u5141\u8BB8\u6211\u4EEC\u81EA\u5B9A\u4E49\u4E00\u4E9B\u65E5\u5FD7\u5904\u7406\u903B\u8F91\uFF0C\u5B9E\u73B0\u4E00\u4E2Ahook\u53EA\u9700\u8981\u5B9E\u73B0\u5982\u4E0B\u63A5\u53E3\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>// logrus\u5728\u8BB0\u5F55Levels()\u8FD4\u56DE\u7684\u65E5\u5FD7\u7EA7\u522B\u7684\u6D88\u606F\u65F6\u4F1A\u89E6\u53D1HOOK,
// \u6309\u7167Fire\u65B9\u6CD5\u5B9A\u4E49\u7684\u5185\u5BB9\u4FEE\u6539logrus.Entry.
type Hook interface {
    Levels() []Level
    Fire(*Entry) error
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E00\u4E2A\u7B80\u5355\u81EA\u5B9A\u4E49hook\u5982\u4E0B\uFF0CDefaultFieldHook\u5B9A\u4E49\u4F1A\u5728\u6240\u6709\u7EA7\u522B\u7684\u65E5\u5FD7\u6D88\u606F\u4E2D\u52A0\u5165\u9ED8\u8BA4\u5B57\u6BB5<code>myHook=&quot;MyHookTest&quot;</code>:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>type DefaultFieldHook struct {
}

func (hook *DefaultFieldHook) Fire(entry *log.Entry) error {
    entry.Data[&quot;myHook&quot;] = &quot; MyHookTest &quot;
    return nil
}

func (hook *DefaultFieldHook) Levels() []log.Level {
    return log.AllLevels
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5B9E\u73B0\u4E86hook\u4E4B\u540E\uFF0C\u53EA\u9700\u8981\u8C03\u7528log.AddHook(hook)\u5373\u53EF\u5C06\u81EA\u5B9A\u4E49\u7684hook\u6CE8\u518C\u5230logrus\u4E2D\u3002\u901A\u8FC7hook\u53EF\u4EE5\u5B9E\u73B0\u5F88\u591A\u5F3A\u5927\u7684\u65E5\u5FD7\u5904\u7406\u529F\u80FD\uFF0C\u6BD4\u8F83\u5E38\u89C1\u7684\u7528\u6CD5\u662F\uFF0C\u5F53\u6709\u6307\u5B9A\u7EA7\u522B\u7684\u65E5\u5FD7\u4EA7\u751F\u65F6\uFF0C\u90AE\u4EF6\u901A\u77E5\u6216\u8005\u544A\u8B66\u7ED9\u76F8\u5173\u8D1F\u8D23\u4EBA\u3002</p><h2 id="zap\u5305\u4ECB\u7ECD" tabindex="-1"><a class="header-anchor" href="#zap\u5305\u4ECB\u7ECD" aria-hidden="true">#</a> zap\u5305\u4ECB\u7ECD</h2>`,20),sn={href:"https://github.com/uber-go/zap",target:"_blank",rel:"noopener noreferrer"},an=s("zap"),en=s("\u662Fuber\u5F00\u6E90\u7684\u65E5\u5FD7\u5305\uFF0C\u4EE5\u9AD8\u6027\u80FD\u8457\u79F0\uFF0C\u5F88\u591A\u516C\u53F8\u7684\u65E5\u5FD7\u5305\u90FD\u662F\u57FA\u4E8Ezap\u6539\u9020\u800C\u6765\u3002zap\u9664\u4E86\u5177\u6709\u65E5\u5FD7\u57FA\u672C\u7684\u529F\u80FD\u4E4B\u5916\uFF0C\u8FD8\u5177\u6709\u5F88\u591A\u5F3A\u5927\u7684\u7279\u6027\uFF1A"),tn=p(`<ul><li>\u652F\u6301\u5E38\u7528\u7684\u65E5\u5FD7\u7EA7\u522B\uFF0C\u4F8B\u5982\uFF1ADebug\u3001Info\u3001Warn\u3001Error\u3001DPanic\u3001Panic\u3001Fatal\u3002</li><li>\u6027\u80FD\u975E\u5E38\u9AD8\uFF0Czap\u5177\u6709\u975E\u5E38\u9AD8\u7684\u6027\u80FD\uFF0C\u9002\u5408\u5BF9\u6027\u80FD\u8981\u6C42\u6BD4\u8F83\u9AD8\u7684\u573A\u666F\u3002</li><li>\u50CFlogrus\u4E00\u6837\uFF0C\u652F\u6301\u7ED3\u6784\u5316\u7684\u65E5\u5FD7\u8BB0\u5F55\u3002</li><li>\u652F\u6301\u9884\u8BBE\u65E5\u5FD7\u5B57\u6BB5\u3002</li><li>\u652F\u6301\u9488\u5BF9\u7279\u5B9A\u7684\u65E5\u5FD7\u7EA7\u522B\uFF0C\u8F93\u51FA\u8C03\u7528\u5806\u6808\u3002</li><li>\u652F\u6301hook\u3002</li></ul><h3 id="zap\u4F7F\u7528\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#zap\u4F7F\u7528\u65B9\u6CD5" aria-hidden="true">#</a> zap\u4F7F\u7528\u65B9\u6CD5</h3><p><strong>\u57FA\u672C\u7528\u6CD5\uFF1A</strong></p><p>zap\u4F7F\u7528\u65B9\u6CD5\u8DDF\u5176\u4ED6\u65E5\u5FD7\u5305\u4F7F\u7528\u65B9\u6CD5\u6BD4\u8F83\u7C7B\u4F3C\uFF0C\u5982\u4E0B\u662F\u4E00\u4E2A\u5E38\u89C1\u7684\u7528\u6CD5\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;time&quot;</span>

    <span class="token string">&quot;go.uber.org/zap&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    logger<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> zap<span class="token punctuation">.</span><span class="token function">NewProduction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">defer</span> logger<span class="token punctuation">.</span><span class="token function">Sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// flushes buffer, if any</span>
    url <span class="token operator">:=</span> <span class="token string">&quot;http://marmotedu.com&quot;</span>
    logger<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;failed to fetch URL&quot;</span><span class="token punctuation">,</span>
        zap<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">,</span>
        zap<span class="token punctuation">.</span><span class="token function">Int</span><span class="token punctuation">(</span><span class="token string">&quot;attempt&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        zap<span class="token punctuation">.</span><span class="token function">Duration</span><span class="token punctuation">(</span><span class="token string">&quot;backoff&quot;</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>

    sugar <span class="token operator">:=</span> logger<span class="token punctuation">.</span><span class="token function">Sugar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    sugar<span class="token punctuation">.</span><span class="token function">Infow</span><span class="token punctuation">(</span><span class="token string">&quot;failed to fetch URL&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;url&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span>
        <span class="token string">&quot;attempt&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
        <span class="token string">&quot;backoff&quot;</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    sugar<span class="token punctuation">.</span><span class="token function">Infof</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to fetch URL: %s&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5C06\u4E0A\u8FF0\u4EE3\u7801\u4FDD\u5B58\u5728 <code>example1.go</code>\u6587\u4EF6\u4E2D\uFF0C\u8FD0\u884C\uFF1A</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;level&quot;</span><span class="token operator">:</span><span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;ts&quot;</span><span class="token operator">:</span><span class="token number">1607006503.3008754</span><span class="token punctuation">,</span><span class="token property">&quot;caller&quot;</span><span class="token operator">:</span><span class="token string">&quot;zap/example1.go:13&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;msg&quot;</span><span class="token operator">:</span><span class="token string">&quot;failed to fetch URL&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;url&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://marmotedu.com&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;attempt&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token property">&quot;backoff&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;level&quot;</span><span class="token operator">:</span><span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;ts&quot;</span><span class="token operator">:</span><span class="token number">1607006503.3009226</span><span class="token punctuation">,</span><span class="token property">&quot;caller&quot;</span><span class="token operator">:</span><span class="token string">&quot;zap/example1.go:20&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;msg&quot;</span><span class="token operator">:</span><span class="token string">&quot;failed to fetch URL&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;url&quot;</span><span class="token operator">:</span><span class="token string">&quot;http://marmotedu.com&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;attempt&quot;</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token property">&quot;backoff&quot;</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">&quot;level&quot;</span><span class="token operator">:</span><span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;ts&quot;</span><span class="token operator">:</span><span class="token number">1607006503.300958</span><span class="token punctuation">,</span><span class="token property">&quot;caller&quot;</span><span class="token operator">:</span><span class="token string">&quot;zap/example1.go:25&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;msg&quot;</span><span class="token operator">:</span><span class="token string">&quot;Failed to fetch URL: http://marmotedu.com&quot;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u9ED8\u8BA4\u7684\u65E5\u5FD7\u8F93\u51FA\u683C\u5F0F\u4E3AJSON\u683C\u5F0F\uFF0C\u5E76\u8BB0\u5F55\u4E86\u6587\u4EF6\u540D\u548C\u884C\u53F7\u3002</p><p>\u4E0A\u8FF0\u4EE3\u7801\u901A\u8FC7<code>zap.NewProduction()</code>\u521B\u5EFA\u4E86\u4E00\u4E2Alogger\uFF0Czap\u8FD8\u63D0\u4F9B\u4E86<code>zap.NewExample()</code>\u3001<code>zap.NewDevelopment()</code>\u6765\u5FEB\u901F\u521B\u5EFA\u4E00\u4E2Alogger\uFF0C\u4E0D\u540C\u65B9\u6CD5\u521B\u5EFA\u7684logger\u5177\u6709\u4E0D\u540C\u7684\u8BBE\u7F6E\uFF0CExample\u9002\u5408\u7528\u5728\u6D4B\u8BD5\u4EE3\u7801\u4E2D\uFF0CDevelopment\u5728\u5F00\u53D1\u73AF\u5883\u4E2D\u4F7F\u7528\uFF0CProduction\u7528\u5728\u751F\u4EA7\u73AF\u5883\u3002\u5982\u679C\u60F3\u81EA\u5B9A\u4E49logger\uFF0C\u53EF\u4EE5\u8C03\u7528<code>zap.New()</code>\u65B9\u6CD5\u6765\u521B\u5EFA\u3002logger\u63D0\u4F9B\u4E86Debug\u3001Info\u3001Warn\u3001Error\u3001Panic\u3001Fatal\u7B49\u65B9\u6CD5\uFF0C\u7528\u6765\u8BB0\u5F55\u4E0D\u540C\u7EA7\u522B\u7684\u65E5\u5FD7\u3002\u5728\u7A0B\u5E8F\u9000\u51FA\u65F6\uFF0C\u6CE8\u610F\u8981\u8C03\u7528<code>defer logger.Sync()</code>\u5C06\u7F13\u5B58\u4E2D\u7684\u65E5\u5FD7\u5237\u65B0\u5230\u78C1\u76D8\u6587\u4EF6\u4E2D\u3002</p><p><strong>\u5F53\u6211\u4EEC\u5BF9\u65E5\u5FD7\u7684\u6027\u80FD\u8981\u6C42\u6BD4\u8F83\u9AD8\u65F6\uFF0C\u53EF\u4EE5\u4F7F\u7528Logger\u800C\u975ESugaredLogger\uFF0CLogger\u6027\u80FD\u66F4\u597D\uFF0C\u5185\u5B58\u5206\u914D\u6B21\u6570\u66F4\u5C11\u3002</strong> \u4E3A\u4E86\u63D0\u9AD8\u6027\u80FD\uFF0CLogger\u6CA1\u6709\u4F7F\u7528<code>interface</code>\u548C\u53CD\u5C04\uFF0C\u5E76\u4E14Logger\u53EA\u652F\u6301\u7ED3\u6784\u5316\u7684\u65E5\u5FD7\uFF0C\u6240\u4EE5\u5728\u4F7F\u7528Logger\u65F6\uFF0C\u9700\u8981\u6307\u5B9A\u5177\u4F53\u7684\u7C7B\u578B\u548Ckey-value\u683C\u5F0F\u7684\u65E5\u5FD7\u5B57\u6BB5\uFF0C\u4F8B\u5982\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>logger<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;failed to fetch URL&quot;</span><span class="token punctuation">,</span>
    zap<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token string">&quot;url&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span><span class="token punctuation">,</span>
    zap<span class="token punctuation">.</span><span class="token function">Int</span><span class="token punctuation">(</span><span class="token string">&quot;attempt&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    zap<span class="token punctuation">.</span><span class="token function">Duration</span><span class="token punctuation">(</span><span class="token string">&quot;backoff&quot;</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u679C\u89C9\u5F97Logger\u7684\u65E5\u5FD7\u683C\u5F0F\u6BD4\u8F83\u7E41\u7410\uFF0C\u53EF\u4EE5\u4F7F\u7528\u66F4\u52A0\u4FBF\u6377\u7684<code>SugaredLogger</code>\uFF0C\u8C03\u7528<code>logger.Sugar()</code>\u5373\u53EF\u521B\u5EFA<code>SugaredLogger</code>\u3002<code>SugaredLogger</code>\u7684\u4F7F\u7528\u6BD4<code>Logger</code>\u7B80\u5355\uFF0C\u4F46\u6027\u80FD\u6BD4Logger\u4F4E 50% \u5DE6\u53F3\uFF0C\u53EF\u4EE5\u7528\u5728\u8C03\u7528\u6B21\u6570\u4E0D\u9AD8\u7684\u51FD\u6570\u4E2D\uFF0C\u8C03\u7528\u65B9\u5F0F\u5982\u4E0B\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>sugar <span class="token operator">:=</span> logger<span class="token punctuation">.</span><span class="token function">Sugar</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    sugar<span class="token punctuation">.</span><span class="token function">Infow</span><span class="token punctuation">(</span><span class="token string">&quot;failed to fetch URL&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;url&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span>
    <span class="token string">&quot;attempt&quot;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token string">&quot;backoff&quot;</span><span class="token punctuation">,</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">,</span>
<span class="token punctuation">)</span>
sugar<span class="token punctuation">.</span><span class="token function">Infof</span><span class="token punctuation">(</span><span class="token string">&quot;Failed to fetch URL: %s&quot;</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5B9A\u5236Logger</strong></p><p>\u53EF\u4EE5\u4F7F\u7528<code>NexExample()/NewDevelopment()/NewProduction()</code>\u51FD\u6570\u521B\u5EFA\u9ED8\u8BA4\u7684Logger\uFF0C\u6BCF\u79CD\u65B9\u6CD5\u521B\u5EFA\u7684Logger\u914D\u7F6E\u4E0D\u4E00\u6837\uFF0C\u4E5F\u53EF\u4EE5\u521B\u5EFA\u4E00\u4E2A\u5B9A\u5236\u5316\u7684Logger\uFF0C\u521B\u5EFA\u65B9\u5F0F\u5982\u4E0B\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;encoding/json&quot;</span>

    <span class="token string">&quot;go.uber.org/zap&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    rawJSON <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">\`{
    &quot;level&quot;:&quot;debug&quot;,
    &quot;encoding&quot;:&quot;json&quot;,
    &quot;outputPaths&quot;: [&quot;stdout&quot;, &quot;test.log&quot;],
    &quot;errorOutputPaths&quot;: [&quot;stderr&quot;],
    &quot;initialFields&quot;:{&quot;name&quot;:&quot;dj&quot;},
    &quot;encoderConfig&quot;: {
      &quot;messageKey&quot;: &quot;message&quot;,
      &quot;levelKey&quot;: &quot;level&quot;,
      &quot;levelEncoder&quot;: &quot;lowercase&quot;
    }
  }\`</span><span class="token punctuation">)</span>

    <span class="token keyword">var</span> cfg zap<span class="token punctuation">.</span>Config
    <span class="token keyword">if</span> err <span class="token operator">:=</span> json<span class="token punctuation">.</span><span class="token function">Unmarshal</span><span class="token punctuation">(</span>rawJSON<span class="token punctuation">,</span> <span class="token operator">&amp;</span>cfg<span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    logger<span class="token punctuation">,</span> err <span class="token operator">:=</span> cfg<span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        <span class="token function">panic</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">defer</span> logger<span class="token punctuation">.</span><span class="token function">Sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    logger<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;server start work successfully!&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4EE5\u4E0A\u793A\u4F8B\u8C03\u7528zap.Config\u7684Build\u65B9\u6CD5\u521B\u5EFA\u4E86\u4E00\u4E2A\u8F93\u51FA\u5230\u6807\u51C6\u8F93\u51FA\u548C\u6587\u4EF6test.log\u7684Logger\uFF0C\u5C06\u4E0A\u8FF0\u4EE3\u7801\u4FDD\u5B58\u5728<code>example2.go</code>\u6587\u4EF6\u4E2D\uFF0C\u8FD0\u884C\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ go run example2.go
<span class="token punctuation">{</span><span class="token string">&quot;level&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;info&quot;</span>,<span class="token string">&quot;message&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;server start work successfully!&quot;</span>,<span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;dj&quot;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>zap.Config\u5B9A\u4E49\u5982\u4E0B\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Config <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    Level AtomicLevel
    Development <span class="token builtin">bool</span>
    DisableCaller <span class="token builtin">bool</span>
    DisableStacktrace <span class="token builtin">bool</span>
    Sampling <span class="token operator">*</span>SamplingConfig
    Encoding <span class="token builtin">string</span>
    EncoderConfig zapcore<span class="token punctuation">.</span>EncoderConfig
    OutputPaths <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
    ErrorOutputPaths <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
    InitialFields <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Config\u7ED3\u6784\u4F53\uFF0C\u5404\u5B57\u6BB5\u8BF4\u660E\u5982\u4E0B\uFF1A</p><ul><li>Level\uFF1A\u65E5\u5FD7\u7EA7\u522B\u3002</li><li>Development\uFF1A\u8BBE\u7F6ELogger\u7684\u6A21\u5F0F\u4E3Adevelopment\u6A21\u5F0F\u3002</li><li>DisableCaller\uFF1A\u7981\u7528\u8C03\u7528\u4FE1\u606F. \u8BE5\u5B57\u6BB5\u503C\u4E3A true \u65F6, \u65E5\u5FD7\u4E2D\u5C06\u4E0D\u518D\u663E\u793A\u8BE5\u65E5\u5FD7\u6240\u5728\u7684\u51FD\u6570\u8C03\u7528\u4FE1\u606F\u3002</li><li>DisableStacktrace\uFF1A\u7981\u7528\u81EA\u52A8\u5806\u6808\u8DDF\u8E2A\u6355\u83B7\u3002</li><li>Sampling\uFF1A\u6D41\u63A7\u914D\u7F6E, \u4E5F\u53EB\u91C7\u6837. \u5355\u4F4D\u662F\u6BCF\u79D2\u949F, \u4F5C\u7528\u662F\u9650\u5236\u65E5\u5FD7\u5728\u6BCF\u79D2\u949F\u5185\u7684\u8F93\u51FA\u6570\u91CF, \u4EE5\u9632\u6B62CPU\u548CIO\u88AB\u8FC7\u5EA6\u5360\u7528\u3002</li><li>Encoding\uFF1A\u6307\u5B9A\u65E5\u5FD7\u7F16\u7801\u5668, \u76EE\u524D\u4EC5\u652F\u6301\u4E24\u79CD\u7F16\u7801\u5668\uFF1Aconsole\u548Cjson\uFF0C\u9ED8\u8BA4\u4E3Ajson\u3002</li><li>EncoderConfig\uFF1A\u7F16\u7801\u914D\u7F6E\u3002</li><li>OutputPaths\uFF1A\u914D\u7F6E\u65E5\u5FD7\u6807\u51C6\u8F93\u51FA\uFF0C\u53EF\u4EE5\u914D\u7F6E\u591A\u4E2A\u65E5\u5FD7\u8F93\u51FA\u8DEF\u5F84, \u4E00\u822C\u60C5\u51B5\u53EF\u4EE5\u4EC5\u914D\u7F6E\u6807\u51C6\u8F93\u51FA\u6216\u8F93\u51FA\u5230\u6587\u4EF6, \u5982\u6709\u9700\u6C42\u7684\u8BDD, \u4E5F\u53EF\u4EE5\u4E24\u8005\u540C\u65F6\u914D\u7F6E\u3002</li><li>ErrorOutputPaths\uFF1A\u9519\u8BEF\u8F93\u51FA\u8DEF\u5F84\uFF0C\u53EF\u4EE5\u662F\u591A\u4E2A\u3002</li><li>InitialFields\uFF1A\u521D\u59CB\u5316\u5B57\u6BB5\u914D\u7F6E, \u8BE5\u914D\u7F6E\u7684\u5B57\u6BB5\u4F1A\u4EE5\u7ED3\u6784\u5316\u7684\u5F62\u5F0F\u6253\u5370\u5728\u6BCF\u6761\u65E5\u5FD7\u8F93\u51FA\u4E2D\u3002</li></ul><p>\u8C03\u7528zap.Config\u7684Build()\u65B9\u6CD5\uFF0C\u53EF\u4EE5\u4F7F\u7528zap.Config\u914D\u7F6E\u521B\u5EFA\u4E00\u4E2ALogger\u3002</p><p>\u5176\u4E2DEncoderConfig\u4E3A\u7F16\u7801\u914D\u7F6E\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> EncoderConfig <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    MessageKey    <span class="token builtin">string</span> <span class="token string">\`json:&quot;messageKey&quot; yaml:&quot;messageKey&quot;\`</span>
    LevelKey      <span class="token builtin">string</span> <span class="token string">\`json:&quot;levelKey&quot; yaml:&quot;levelKey&quot;\`</span>
    TimeKey       <span class="token builtin">string</span> <span class="token string">\`json:&quot;timeKey&quot; yaml:&quot;timeKey&quot;\`</span>
    NameKey       <span class="token builtin">string</span> <span class="token string">\`json:&quot;nameKey&quot; yaml:&quot;nameKey&quot;\`</span>
    CallerKey     <span class="token builtin">string</span> <span class="token string">\`json:&quot;callerKey&quot; yaml:&quot;callerKey&quot;\`</span>
    FunctionKey   <span class="token builtin">string</span> <span class="token string">\`json:&quot;functionKey&quot; yaml:&quot;functionKey&quot;\`</span>
    StacktraceKey <span class="token builtin">string</span> <span class="token string">\`json:&quot;stacktraceKey&quot; yaml:&quot;stacktraceKey&quot;\`</span>
    LineEnding    <span class="token builtin">string</span> <span class="token string">\`json:&quot;lineEnding&quot; yaml:&quot;lineEnding&quot;\`</span>
    EncodeLevel    LevelEncoder    <span class="token string">\`json:&quot;levelEncoder&quot; yaml:&quot;levelEncoder&quot;\`</span>
    EncodeTime     TimeEncoder     <span class="token string">\`json:&quot;timeEncoder&quot; yaml:&quot;timeEncoder&quot;\`</span>
    EncodeDuration DurationEncoder <span class="token string">\`json:&quot;durationEncoder&quot; yaml:&quot;durationEncoder&quot;\`</span>
    EncodeCaller   CallerEncoder   <span class="token string">\`json:&quot;callerEncoder&quot; yaml:&quot;callerEncoder&quot;\`</span>
    EncodeName NameEncoder <span class="token string">\`json:&quot;nameEncoder&quot; yaml:&quot;nameEncoder&quot;\`</span>
    ConsoleSeparator <span class="token builtin">string</span> <span class="token string">\`json:&quot;consoleSeparator&quot; yaml:&quot;consoleSeparator&quot;\`</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5E38\u7528\u7684\u8BBE\u7F6E\u5982\u4E0B\uFF1A</p><ul><li>MessageKey\uFF1A\u65E5\u5FD7\u4E2D\u4FE1\u606F\u7684\u952E\u540D\uFF0C\u9ED8\u8BA4\u4E3Amsg\u3002</li><li>LevelKey\uFF1A\u65E5\u5FD7\u4E2D\u7EA7\u522B\u7684\u952E\u540D\uFF0C\u9ED8\u8BA4\u4E3Alevel\u3002</li><li>EncodeLevel\uFF1A\u65E5\u5FD7\u4E2D\u7EA7\u522B\u7684\u683C\u5F0F\uFF0C\u9ED8\u8BA4\u4E3A\u5C0F\u5199\uFF0C\u5982debug/info\u3002</li></ul><ol><li>\u9009\u9879</li></ol><p>zap\u652F\u6301\u591A\u79CD\u9009\u9879\uFF0C\u9009\u9879\u7684\u4F7F\u7528\u65B9\u5F0F\u5982\u4E0B\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;go.uber.org/zap&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    logger<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> zap<span class="token punctuation">.</span><span class="token function">NewProduction</span><span class="token punctuation">(</span>zap<span class="token punctuation">.</span><span class="token function">AddCaller</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">defer</span> logger<span class="token punctuation">.</span><span class="token function">Sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    logger<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5C06\u4E0A\u8FF0\u4EE3\u7801\u4FDD\u5B58\u5728example3.go\u4E2D\uFF0C\u6267\u884C\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ go run example3.go
{&quot;level&quot;:&quot;info&quot;,&quot;ts&quot;:1607010625.6718638,&quot;caller&quot;:&quot;zap/example3.go:9&quot;,&quot;msg&quot;:&quot;hello world&quot;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u8FF0\u65E5\u5FD7\u8F93\u51FA\u4E86\u65E5\u5FD7\u7684\u8C03\u7528\u4FE1\u606F\uFF08\u6587\u4EF6\u540D:\u884C\u53F7\uFF09<code>&quot;caller&quot;:&quot;zap/example3.go:9&quot;</code>\u3002zap\u63D0\u4F9B\u4E86\u591A\u4E2A\u9009\u9879\u53EF\u4F9B\u9009\u62E9\uFF1A</p><ul><li><code>AddStacktrace(lvl zapcore.LevelEnabler)</code>\uFF1A\u7528\u6765\u5728\u6307\u5B9A\u7EA7\u522B\u53CA\u4EE5\u4E0A\u7EA7\u522B\u8F93\u51FA\u8C03\u7528\u5806\u6808\u3002</li><li><code>zap.WithCaller(enabled bool)</code>\uFF1A\u6307\u5B9A\u662F\u5426\u5728\u65E5\u5FD7\u8F93\u51FA\u5185\u5BB9\u4E2D\u589E\u52A0\u6587\u4EF6\u540D\u548C\u884C\u53F7\u3002</li><li><code>zap.AddCaller()</code>\uFF1A\u4E0Ezap.WithCaller(true)\u7B49\u4EF7\uFF0C\u6307\u5B9A\u5728\u65E5\u5FD7\u8F93\u51FA\u5185\u5BB9\u4E2D\u589E\u52A0\u884C\u53F7\u548C\u6587\u4EF6\u540D\u3002</li><li><code>zap. AddCallerSkip(skip int)</code>\uFF1A\u6307\u5B9A\u5728\u8C03\u7528\u6808\u4E2D\u8DF3\u8FC7\u7684\u8C03\u7528\u6DF1\u5EA6\uFF0C\u5426\u5219\u901A\u8FC7\u8C03\u7528\u6808\u83B7\u5F97\u7684\u884C\u53F7\u53EF\u80FD\u603B\u662F\u65E5\u5FD7\u7EC4\u4EF6\u4E2D\u7684\u884C\u53F7\u3002</li><li><code>zap. IncreaseLevel(lvl zapcore.LevelEnabler)</code>\uFF1A\u63D0\u9AD8\u65E5\u5FD7\u7EA7\u522B\uFF0C\u5982\u679C\u4F20\u5165\u7684lvl\u6BD4\u5F53\u524Dlogger\u7684\u7EA7\u522B\u4F4E\uFF0C\u5219\u4E0D\u4F1A\u6539\u53D8\u65E5\u5FD7\u7EA7\u522B\u3002</li><li><code>ErrorOutput(w zapcore.WriteSyncer)</code>\uFF1A\u6307\u5B9A\u65E5\u5FD7\u7EC4\u4EF6\u4E2D\u51FA\u73B0\u5F02\u5E38\u65F6\u7684\u8F93\u51FA\u4F4D\u7F6E\u3002</li><li><code>Fields(fs ...Field)</code>\uFF1A\u6DFB\u52A0\u516C\u5171\u5B57\u6BB5\u3002</li><li><code>Hooks(hooks ...func(zapcore.Entry) error)</code>\uFF1A\u6CE8\u518C\u94A9\u5B50\u51FD\u6570\uFF0C\u7528\u6765\u5728\u65E5\u5FD7\u6253\u5370\u65F6\u540C\u65F6\u8C03\u7528hook\u65B9\u6CD5\u3002</li><li><code>WrapCore(f func(zapcore.Core) zapcore.Core)</code>\uFF1A\u66FF\u6362Logger\u7684zapcore.Core\u3002 -<code> Development()</code>\uFF1A\u5C06Logger\u4FEE\u6539\u4E3ADevelopment\u6A21\u5F0F\u3002</li></ul><p><strong>\u9884\u8BBE\u65E5\u5FD7\u5B57\u6BB5</strong></p><p>\u5982\u679C\u6BCF\u6761\u65E5\u5FD7\u90FD\u671F\u671B\u52A0\u4E00\u4E9B\u516C\u5171\u5B57\u6BB5\uFF0C\u4F8B\u5982requestID\uFF0C\u53EF\u4EE5\u5728\u521B\u5EFALogger\u65F6\u4F7F\u7528<code>Fields(fs ...Field)</code>\u9009\u9879\uFF0C\u5982\u4E0B\u4EE3\u7801\u4E2D\uFF0C\u6DFB\u52A0\u4E86requestID\u3001userID\u516C\u5171\u5B57\u6BB5\u5230\u6BCF\u6761\u65E5\u5FD7\u4E2D\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token string">&quot;go.uber.org/zap&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    logger <span class="token operator">:=</span> zap<span class="token punctuation">.</span><span class="token function">NewExample</span><span class="token punctuation">(</span>zap<span class="token punctuation">.</span><span class="token function">Fields</span><span class="token punctuation">(</span>
        zap<span class="token punctuation">.</span><span class="token function">Int</span><span class="token punctuation">(</span><span class="token string">&quot;userID&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        zap<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token string">&quot;requestID&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;fbf54504&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span>

    logger<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token string">&quot;This is a debug message&quot;</span><span class="token punctuation">)</span>
    logger<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;This is a info message&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5C06\u4E0A\u8FF0\u4EE3\u7801\u4FDD\u5B58\u5230<code>preset_field.go</code>\u6587\u4EF6\u4E2D\uFF0C\u8FD0\u884C\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ go run preset_field.go
<span class="token punctuation">{</span><span class="token string">&quot;level&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;debug&quot;</span>,<span class="token string">&quot;msg&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;This is a debug message&quot;</span>,<span class="token string">&quot;userID&quot;</span>:10,<span class="token string">&quot;requestID&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;fbf54504&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;level&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;info&quot;</span>,<span class="token string">&quot;msg&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;This is a info message&quot;</span>,<span class="token string">&quot;userID&quot;</span>:10,<span class="token string">&quot;requestID&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;fbf54504&quot;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u5168\u5C40Logger\uFF1A</strong></p><p>zap\u63D0\u4F9B\u4E862\u4E2A\u5168\u5C40Logger\uFF0C\u53EF\u4EE5\u65B9\u4FBF\u6211\u4EEC\u8C03\u7528\uFF1A</p><ul><li><code>*zap.Logger</code>\uFF1A\u53EF\u901A\u8FC7zap.L()\u83B7\u5F97\uFF0C\u63D0\u4F9B\u4E86Debug()\u3001Info()\u3001Warn()\u3001Error()\u3001Panic()\u3001DPanic()\u3001Fatal()\u65B9\u6CD5\u6765\u8BB0\u5F55\u65E5\u5FD7\u3002</li><li><code>*zap.SugaredLogger</code>\uFF1A\u53EF\u901A\u8FC7zap.S()\u83B7\u5F97\uFF0C\u63D0\u4F9B\u4E86Debugf()\u3001Debugw()\u3001Infof()\u3001Infow()\u3001Warnf()\u3001Warnw()\u3001Errorf()\u3001Errorw()\u3001Panicf()\u3001Panicw()\u3001DPanicf()\u3001DPanicw()\u3001Fatalf()\u3001Fatalw()\u65B9\u6CD5\u6765\u8BB0\u5F55\u65E5\u5FD7\u3002</li></ul><p>\u9ED8\u8BA4\u7684\u5168\u5C40Logger\u4E0D\u4F1A\u8BB0\u5F55\u4EFB\u4F55\u65E5\u5FD7\uFF0C\u5B83\u662F\u4E00\u4E2A\u65E0\u7528\u7684Logger\uFF0C\u4F8B\u5982zap.L()\u8FD4\u56DE\u4E86\u540D\u4E3A<code>_globalL</code>\u7684Logger\uFF0C<code>_globalL</code>\u5B9A\u4E49\u4E3A\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>_globalL  <span class="token operator">=</span> <span class="token function">NewNop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">NewNop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span>Logger <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&amp;</span>Logger<span class="token punctuation">{</span>
        core<span class="token punctuation">:</span>        zapcore<span class="token punctuation">.</span><span class="token function">NewNopCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        errorOutput<span class="token punctuation">:</span> zapcore<span class="token punctuation">.</span><span class="token function">AddSync</span><span class="token punctuation">(</span>ioutil<span class="token punctuation">.</span>Discard<span class="token punctuation">)</span><span class="token punctuation">,</span>
        addStack<span class="token punctuation">:</span>    zapcore<span class="token punctuation">.</span>FatalLevel <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>zapcore.NewNopCore()</code>\u51FD\u6570\u5B9A\u4E49\u4E3A\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> nopCore <span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// NewNopCore returns a no-op Core.</span>
<span class="token keyword">func</span> <span class="token function">NewNopCore</span><span class="token punctuation">(</span><span class="token punctuation">)</span> Core                                        <span class="token punctuation">{</span> <span class="token keyword">return</span> nopCore<span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>nopCore<span class="token punctuation">)</span> <span class="token function">Enabled</span><span class="token punctuation">(</span>Level<span class="token punctuation">)</span> <span class="token builtin">bool</span>                            <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span> <span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>n nopCore<span class="token punctuation">)</span> <span class="token function">With</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span>Field<span class="token punctuation">)</span> Core                           <span class="token punctuation">{</span> <span class="token keyword">return</span> n <span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>nopCore<span class="token punctuation">)</span> <span class="token function">Check</span><span class="token punctuation">(</span><span class="token boolean">_</span> Entry<span class="token punctuation">,</span> ce <span class="token operator">*</span>CheckedEntry<span class="token punctuation">)</span> <span class="token operator">*</span>CheckedEntry <span class="token punctuation">{</span> <span class="token keyword">return</span> ce <span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>nopCore<span class="token punctuation">)</span> <span class="token function">Write</span><span class="token punctuation">(</span>Entry<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>Field<span class="token punctuation">)</span> <span class="token builtin">error</span>                    <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">nil</span> <span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>nopCore<span class="token punctuation">)</span> <span class="token function">Sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">error</span>                                   <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">nil</span> <span class="token punctuation">}</span>

<span class="token comment">// NewCore creates a Core that writes logs to a WriteSyncer.</span>
<span class="token keyword">func</span> <span class="token function">NewCore</span><span class="token punctuation">(</span>enc Encoder<span class="token punctuation">,</span> ws WriteSyncer<span class="token punctuation">,</span> enab LevelEnabler<span class="token punctuation">)</span> Core <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&amp;</span>ioCore<span class="token punctuation">{</span>
        LevelEnabler<span class="token punctuation">:</span> enab<span class="token punctuation">,</span>
        enc<span class="token punctuation">:</span>          enc<span class="token punctuation">,</span>
        out<span class="token punctuation">:</span>          ws<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u770B\u5230NewNop()\u521B\u5EFA\u4E00\u4E2A\u4E0D\u8BB0\u5F55\u4EFB\u4F55\u65E5\u5FD7\u3001\u4EFB\u4F55\u5185\u90E8\u9519\u8BEF\u3001\u4E0D\u6267\u884C\u4EFB\u4F55\u94A9\u5B50\u7684Logger\u3002\u53EF\u4EE5\u4F7F\u7528ReplaceGlobals\u51FD\u6570\u5C06\u5168\u5C40Logger\u66FF\u6362\u4E3A\u6211\u4EEC\u521B\u5EFA\u7684Logger\uFF0C\u4F8B\u5982\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>package main

import &quot;go.uber.org/zap&quot;

func main() {
    zap.L().Info(&quot;default global Logger&quot;)
    zap.S().Info(&quot;default global SugaredLogger&quot;)

    logger := zap.NewExample()
    defer logger.Sync()

    zap.ReplaceGlobals(logger)
    zap.L().Info(&quot;replaced global Logger&quot;)
    zap.S().Info(&quot;replaced global SugaredLogger&quot;)
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5047\u8BBE\u4E0A\u8FF0\u4EE3\u7801\u4FDD\u5B58\u5728<code>global_logger.go</code>\u6587\u4EF6\u4E2D\uFF0C\u8FD0\u884C\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ go run global_logger.go
{&quot;level&quot;:&quot;info&quot;,&quot;msg&quot;:&quot;replaced global Logger&quot;}
{&quot;level&quot;:&quot;info&quot;,&quot;msg&quot;:&quot;replaced global SugaredLogger&quot;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u770B\u5230\u5728<code>zap.ReplaceGlobals(logger)</code>\u4E4B\u524D\u7684\u65E5\u5FD7\uFF0C\u5E76\u6CA1\u6709\u88AB\u6253\u5370\u51FA\u6765\u3002</p><h2 id="\u5176\u5B83\u5F00\u6E90\u5305" tabindex="-1"><a class="header-anchor" href="#\u5176\u5B83\u5F00\u6E90\u5305" aria-hidden="true">#</a> \u5176\u5B83\u5F00\u6E90\u5305</h2><p>\u8FD8\u6709\u5F88\u591A\u5176\u5B83\u4F18\u79C0\u7684\u5F00\u6E90\u65E5\u5FD7\u5305\u4F9B\u6211\u4EEC\u9009\u62E9\uFF0C\u4F8B\u5982\uFF1Alog15\u3001zerolog\u3001seelog\u3001apex/log\u3001go-logging\u7B49\u3002\u4F60\u53EF\u4EE5\u5728\u5F00\u53D1\u4E2D\uFF0C\u90FD\u8BE6\u52A0\u8C03\u7814\uFF0C\u9009\u62E9\u4E00\u4E2A\u9002\u5408\u81EA\u5DF1\u7684\u65E5\u5FD7\u5305\u3002</p><h2 id="\u5F00\u6E90\u65E5\u5FD7\u5305\u9009\u62E9" tabindex="-1"><a class="header-anchor" href="#\u5F00\u6E90\u65E5\u5FD7\u5305\u9009\u62E9" aria-hidden="true">#</a> \u5F00\u6E90\u65E5\u5FD7\u5305\u9009\u62E9</h2><p>\u6211\u4EEC\u4ECB\u7ECD\u4E86\u5F88\u591A\u65E5\u5FD7\u5305\uFF0C\u6BCF\u79CD\u65E5\u5FD7\u5305\u4F7F\u7528\u7684\u573A\u666F\u4E0D\u540C\uFF0C\u4F60\u53EF\u4EE5\u6839\u636E\u81EA\u5DF1\u7684\u9700\u6C42\u7ED3\u5408\u65E5\u5FD7\u5305\u7684\u7279\u6027\u8FDB\u884C\u9009\u62E9\uFF1A</p>`,55),on=n("li",null,[n("strong",null,"\u6807\u51C6\u5E93log\u5305\uFF1A"),s(" \u6807\u51C6\u5E93log\u5305\u4E0D\u652F\u6301\u65E5\u5FD7\u7EA7\u522B\u3001\u65E5\u5FD7\u5206\u5272\u3001\u65E5\u5FD7\u683C\u5F0F\u7B49\u529F\u80FD\uFF0C\u6240\u4EE5\u5728\u5927\u578B\u9879\u76EE\u4E2D\u5F88\u5C11\u76F4\u63A5\u4F7F\u7528\uFF0C\u901A\u5E38\u7528\u4E8E\u4E00\u4E9B\u77ED\u5C0F\u7684\u7A0B\u5E8F\uFF0C\u6BD4\u5982\uFF1A\u7528\u4E8E\u751F\u6210JWT Token\u7684main.go\u6587\u4EF6\u4E2D\u3002\u6807\u51C6\u5E93\u65E5\u5FD7\u5305\u4E5F\u5F88\u9002\u5408\u4E00\u4E9B\u7B80\u77ED\u7684\u4EE3\u7801\uFF0C\u7528\u4E8E\u5FEB\u901F\u8C03\u8BD5\u548C\u9A8C\u8BC1\u3002")],-1),pn=n("li",null,[n("strong",null,"glog\uFF1A"),s(" glog\u5B9E\u73B0\u4E86\u65E5\u5FD7\u5305\u7684\u57FA\u672C\u529F\u80FD\uFF0C\u5BF9\u4E8E\u4E00\u4E9B\u5BF9\u65E5\u5FD7\u529F\u80FD\u8981\u6C42\u4E0D\u591A\u7684\u5C0F\u578B\u9879\u76EE\u975E\u5E38\u9002\u5408\u3002")],-1),ln=n("li",null,[n("strong",null,"logrus\uFF1A"),s(" logrus\u529F\u80FD\u5F3A\u5927\uFF0C\u4E0D\u4EC5\u5B9E\u73B0\u4E86\u65E5\u5FD7\u5305\u7684\u57FA\u672C\u529F\u80FD\uFF0C\u8FD8\u6709\u5F88\u591A\u9AD8\u7EA7\u7279\u6027\uFF0C\u9002\u5408\u4E00\u4E9B\u5927\u578B\u9879\u76EE\uFF0C\u5C24\u5176\u662F\u9700\u8981\u7ED3\u6784\u5316\u65E5\u5FD7\u8BB0\u5F55\u7684\u9879\u76EE\u3002")],-1),cn=n("strong",null,"zap\uFF1A",-1),un=s(" zap\u63D0\u4F9B\u4E86\u5F88\u5F3A\u5927\u7684\u65E5\u5FD7\u529F\u80FD\uFF0C\u6027\u80FD\u9AD8\uFF0C\u5185\u5B58\u5206\u914D\u6B21\u6570\u5C11\uFF0C\u9002\u5408\u5BF9\u65E5\u5FD7\u6027\u80FD\u8981\u6C42\u5F88\u9AD8\u7684\u9879\u76EE\u3002\u53E6\u5916\uFF0Czap\u5305\u4E2D\u7684\u5B50\u5305zapcore\uFF0C\u63D0\u4F9B\u4E86\u5F88\u591A\u5E95\u5C42\u7684\u65E5\u5FD7\u63A5\u53E3\uFF0C\u9002\u5408\u7528\u6765\u505A\u4E8C\u6B21\u5C01\u88C5\u3002\u4F8B\u5982 iam \u9879\u76EE\u4F5C\u8005 \u5C31\u57FA\u4E8Ezap\u548Czapcore\u5C01\u88C5\u4E86"),rn={href:"https://github.com/marmotedu/log",target:"_blank",rel:"noopener noreferrer"},dn=s("marmotedu/log"),kn=s("\u65E5\u5FD7\u5305\uFF0C\u8BE5\u65E5\u5FD7\u5305\u53EF\u4EE5\u5F88\u597D\u7684\u517C\u5BB9glog\uFF0C\u5C01\u88C5\u80CC\u666F\u662F\u56E0\u4E3A\u5728\u505A\u5BB9\u5668\u4E91\u5E73\u53F0\u5F00\u53D1\u65F6\uFF0C\u53D1\u73B0kubernetes\u6E90\u7801\u4E2D\u5927\u91CF\u4F7F\u7528\u4E86glog\uFF0C\u9700\u8981\u65E5\u5FD7\u5305\u80FD\u591F\u517C\u5BB9glog\u3002"),gn=p('<p>\u63A5\u4E0B\u6765\uFF0C\u6211\u4EEC\u6765\u5B66\u4E60\u5982\u4F55\u4ECE\u96F6\u5F00\u59CB\u5F00\u53D1\u51FA\u4E00\u4E2A\u65E5\u5FD7\u5305\uFF1A</p><h2 id="\u4ECE0\u7F16\u5199\u4E00\u4E2A\u65E5\u5FD7\u5305" tabindex="-1"><a class="header-anchor" href="#\u4ECE0\u7F16\u5199\u4E00\u4E2A\u65E5\u5FD7\u5305" aria-hidden="true">#</a> \u4ECE0\u7F16\u5199\u4E00\u4E2A\u65E5\u5FD7\u5305</h2><p>\u63A5\u4E0B\u6765\uFF0C\u6211\u4F1A\u5411\u4F60\u5C55\u793A\u5982\u4F55\u5FEB\u901F\u7F16\u5199\u4E00\u4E2A\u5177\u5907\u57FA\u672C\u529F\u80FD\u7684\u65E5\u5FD7\u5305\uFF0C\u8BA9\u4F60\u901A\u8FC7\u8FD9\u4E2A\u7B80\u77ED\u7684\u65E5\u5FD7\u5305\u5B9E\u73B0\u638C\u63E1\u65E5\u5FD7\u5305\u7684\u6838\u5FC3\u8BBE\u8BA1\u601D\u8DEF\u3002\u8BE5\u65E5\u5FD7\u5305\u4E3B\u8981\u5B9E\u73B0\u4EE5\u4E0B\u51E0\u4E2A\u529F\u80FD\uFF1A</p><ul><li>\u652F\u6301\u81EA\u5B9A\u4E49\u914D\u7F6E\u3002</li><li>\u652F\u6301\u6587\u4EF6\u540D\u548C\u884C\u53F7\u3002</li><li>\u652F\u6301\u65E5\u5FD7\u7EA7\u522B Debug\u3001Info\u3001Warn\u3001Error\u3001Panic\u3001Fatal\u3002</li><li>\u652F\u6301\u8F93\u51FA\u5230\u672C\u5730\u6587\u4EF6\u548C\u6807\u51C6\u8F93\u51FA\u3002</li><li>\u652F\u6301JSON\u548CTEXT\u683C\u5F0F\u7684\u65E5\u5FD7\u8F93\u51FA\uFF0C\u652F\u6301\u81EA\u5B9A\u4E49\u65E5\u5FD7\u683C\u5F0F\u3002</li><li>\u652F\u6301\u9009\u9879\u6A21\u5F0F\u3002</li></ul>',4),vn=s("\u65E5\u5FD7\u5305\u540D\u79F0\u4E3A"),mn=n("code",null,"cuslog",-1),bn=s("\uFF0C\u793A\u4F8B\u9879\u76EE\u5B8C\u6574\u4EE3\u7801\u5B58\u653E\u5728 "),qn={href:"https://github.com/marmotedu/gopractise-demo/tree/main/log/cuslog",target:"_blank",rel:"noopener noreferrer"},fn=s("cuslog"),hn=s("\u3002"),_n=n("p",null,[n("strong",null,"\u5177\u4F53\u5B9E\u73B0\u5206\u4E3A\u4EE5\u4E0B\u56DB\u4E2A\u6B65\u9AA4\uFF1A")],-1),yn=n("ol",null,[n("li",null,"\u5B9A\u4E49\uFF1A\u5B9A\u4E49\u65E5\u5FD7\u7EA7\u522B\u548C\u65E5\u5FD7\u9009\u9879\u3002"),n("li",null,"\u521B\u5EFA\uFF1A\u521B\u5EFALogger\u53CA\u5404\u7EA7\u522B\u65E5\u5FD7\u6253\u5370\u65B9\u6CD5\u3002"),n("li",null,"\u5199\u5165\uFF1A\u5C06\u65E5\u5FD7\u8F93\u51FA\u5230\u652F\u6301\u7684\u8F93\u51FA\u4E2D\u3002"),n("li",null,"\u81EA\u5B9A\u4E49\uFF1A\u81EA\u5B9A\u4E49\u65E5\u5FD7\u8F93\u51FA\u683C\u5F0F\u3002")],-1),xn=n("h3",{id:"\u5B9A\u4E49\u65E5\u5FD7\u7EA7\u522B\u548C\u65E5\u5FD7\u9009\u9879",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5B9A\u4E49\u65E5\u5FD7\u7EA7\u522B\u548C\u65E5\u5FD7\u9009\u9879","aria-hidden":"true"},"#"),s(" \u5B9A\u4E49\u65E5\u5FD7\u7EA7\u522B\u548C\u65E5\u5FD7\u9009\u9879")],-1),Ln=s("\u4E00\u4E2A\u57FA\u672C\u7684\u65E5\u5FD7\u5305\uFF0C\u9996\u5148\u9700\u8981\u5B9A\u4E49\u597D\u65E5\u5FD7\u7EA7\u522B\u548C\u65E5\u5FD7\u9009\u9879\u3002\u672C\u793A\u4F8B\u5C06\u5B9A\u4E49\u4EE3\u7801\u4FDD\u5B58\u5728"),wn={href:"https://github.com/marmotedu/gopractise-demo/blob/main/log/cuslog/options.go",target:"_blank",rel:"noopener noreferrer"},In=s("options.go"),Fn=s("\u6587\u4EF6\u4E2D\u3002"),En=p(`<p>\u53EF\u4EE5\u901A\u8FC7\u5982\u4E0B\u65B9\u5F0F\u5B9A\u4E49\u65E5\u5FD7\u7EA7\u522B\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Level <span class="token builtin">uint8</span>

<span class="token keyword">const</span> <span class="token punctuation">(</span>
    DebugLevel Level <span class="token operator">=</span> <span class="token boolean">iota</span>
    InfoLevel
    WarnLevel
    ErrorLevel
    PanicLevel
    FatalLevel
<span class="token punctuation">)</span>

<span class="token keyword">var</span> LevelNameMapping <span class="token operator">=</span> <span class="token keyword">map</span><span class="token punctuation">[</span>Level<span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
    DebugLevel<span class="token punctuation">:</span> <span class="token string">&quot;DEBUG&quot;</span><span class="token punctuation">,</span>
    InfoLevel<span class="token punctuation">:</span>  <span class="token string">&quot;INFO&quot;</span><span class="token punctuation">,</span>
    WarnLevel<span class="token punctuation">:</span>  <span class="token string">&quot;WARN&quot;</span><span class="token punctuation">,</span>
    ErrorLevel<span class="token punctuation">:</span> <span class="token string">&quot;ERROR&quot;</span><span class="token punctuation">,</span>
    PanicLevel<span class="token punctuation">:</span> <span class="token string">&quot;PANIC&quot;</span><span class="token punctuation">,</span>
    FatalLevel<span class="token punctuation">:</span> <span class="token string">&quot;FATAL&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728\u65E5\u5FD7\u8F93\u51FA\u65F6\uFF0C\u8981\u901A\u8FC7\u5BF9\u6BD4\u5F00\u5173\u7EA7\u522B\u548C\u8F93\u51FA\u7EA7\u522B\u7684\u5927\u5C0F\uFF0C\u6765\u51B3\u5B9A\u662F\u5426\u8F93\u51FA\uFF0C\u6240\u4EE5\u65E5\u5FD7\u7EA7\u522BLevel\u8981\u5B9A\u4E49\u6210\u65B9\u4FBF\u6BD4\u8F83\u7684\u6570\u503C\u7C7B\u578B\u3002\u51E0\u4E4E\u6240\u6709\u7684\u65E5\u5FD7\u5305\u90FD\u662F\u7528\u5E38\u91CF\u8BA1\u6570\u5668<code>iota</code>\u6765\u5B9A\u4E49\u65E5\u5FD7\u7EA7\u522B\u3002</p><p>\u53E6\u5916\uFF0C\u56E0\u4E3A\u8981\u5728\u65E5\u5FD7\u8F93\u51FA\u4E2D\uFF0C\u8F93\u51FA\u53EF\u8BFB\u7684\u65E5\u5FD7\u7EA7\u522B\uFF08\u4F8B\u5982\u8F93\u51FAINFO\u800C\u4E0D\u662F1\uFF09\uFF0C\u6240\u4EE5\u9700\u8981\u6709Level\u5230Level Name\u7684\u6620\u5C04LevelNameMapping\uFF0CLevelNameMapping\u4F1A\u5728\u683C\u5F0F\u5316\u65F6\u7528\u5230\u3002</p><p>\u63A5\u4E0B\u6765\u770B\u5B9A\u4E49\u65E5\u5FD7\u9009\u9879\u3002\u65E5\u5FD7\u9700\u8981\u662F\u53EF\u914D\u7F6E\u7684\uFF0C\u65B9\u4FBF\u5F00\u53D1\u8005\u6839\u636E\u4E0D\u540C\u7684\u73AF\u5883\u8BBE\u7F6E\u4E0D\u540C\u7684\u65E5\u5FD7\u884C\u4E3A\uFF0C\u6BD4\u8F83\u5E38\u89C1\u7684\u914D\u7F6E\u9009\u9879\u4E3A\uFF1A</p><ul><li>\u65E5\u5FD7\u7EA7\u522B\u3002</li><li>\u8F93\u51FA\u4F4D\u7F6E\uFF0C\u4F8B\u5982\u6807\u51C6\u8F93\u51FA\u6216\u8005\u6587\u4EF6\u3002</li><li>\u8F93\u51FA\u683C\u5F0F\uFF0C\u4F8B\u5982JSON\u6216\u8005Text\u3002</li><li>\u662F\u5426\u5F00\u542F\u6587\u4EF6\u540D\u548C\u884C\u53F7\u3002</li></ul><p>\u672C\u793A\u4F8B\u7684\u65E5\u5FD7\u9009\u9879\u5B9A\u4E49\u5982\u4E0B\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> options <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    output        io<span class="token punctuation">.</span>Writer
    level         Level
    stdLevel      Level
    formatter     Formatter
    disableCaller <span class="token builtin">bool</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E3A\u4E86\u7075\u6D3B\u5730\u8BBE\u7F6E\u65E5\u5FD7\u7684\u9009\u9879\uFF0C\u4F60\u53EF\u4EE5\u901A\u8FC7\u9009\u9879\u6A21\u5F0F\uFF0C\u6765\u5BF9\u65E5\u5FD7\u9009\u9879\u8FDB\u884C\u8BBE\u7F6E\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Option <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token operator">*</span>options<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">initOptions</span><span class="token punctuation">(</span>opts <span class="token operator">...</span>Option<span class="token punctuation">)</span> <span class="token punctuation">(</span>o <span class="token operator">*</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    o <span class="token operator">=</span> <span class="token operator">&amp;</span>options<span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> opt <span class="token operator">:=</span> <span class="token keyword">range</span> opts <span class="token punctuation">{</span>
        <span class="token function">opt</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> o<span class="token punctuation">.</span>output <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        o<span class="token punctuation">.</span>output <span class="token operator">=</span> os<span class="token punctuation">.</span>Stderr
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> o<span class="token punctuation">.</span>formatter <span class="token operator">==</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        o<span class="token punctuation">.</span>formatter <span class="token operator">=</span> <span class="token operator">&amp;</span>TextFormatter<span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">WithLevel</span><span class="token punctuation">(</span>level Level<span class="token punctuation">)</span> Option <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">func</span><span class="token punctuation">(</span>o <span class="token operator">*</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        o<span class="token punctuation">.</span>level <span class="token operator">=</span> level
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>
<span class="token keyword">func</span> <span class="token function">SetOptions</span><span class="token punctuation">(</span>opts <span class="token operator">...</span>Option<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    std<span class="token punctuation">.</span><span class="token function">SetOptions</span><span class="token punctuation">(</span>opts<span class="token operator">...</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>logger<span class="token punctuation">)</span> <span class="token function">SetOptions</span><span class="token punctuation">(</span>opts <span class="token operator">...</span>Option<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    l<span class="token punctuation">.</span>mu<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">defer</span> l<span class="token punctuation">.</span>mu<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> opt <span class="token operator">:=</span> <span class="token keyword">range</span> opts <span class="token punctuation">{</span>
        <span class="token function">opt</span><span class="token punctuation">(</span>l<span class="token punctuation">.</span>opt<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5177\u6709\u9009\u9879\u6A21\u5F0F\u7684\u65E5\u5FD7\u5305\uFF0C\u53EF\u901A\u8FC7\u4EE5\u4E0B\u65B9\u5F0F\uFF0C\u6765\u52A8\u6001\u5730\u4FEE\u6539\u65E5\u5FD7\u7684\u9009\u9879\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>cuslog.SetOptions(cuslog.WithLevel(cuslog.DebugLevel))
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4F60\u53EF\u4EE5\u6839\u636E\u9700\u8981\uFF0C\u5BF9\u6BCF\u4E00\u4E2A\u65E5\u5FD7\u9009\u9879\u521B\u5EFA\u8BBE\u7F6E\u51FD\u6570 <code>WithXXXX</code> \u3002\u8FD9\u4E2A\u793A\u4F8B\u65E5\u5FD7\u5305\u652F\u6301\u5982\u4E0B\u9009\u9879\u8BBE\u7F6E\u51FD\u6570\uFF1A</p><ul><li>WithOutput\uFF08output io.Writer\uFF09\uFF1A\u8BBE\u7F6E\u8F93\u51FA\u4F4D\u7F6E\u3002</li><li>WithLevel\uFF08level Level\uFF09\uFF1A\u8BBE\u7F6E\u8F93\u51FA\u7EA7\u522B\u3002</li><li>WithFormatter\uFF08formatter Formatter\uFF09\uFF1A\u8BBE\u7F6E\u8F93\u51FA\u683C\u5F0F\u3002</li><li>WithDisableCaller\uFF08caller bool\uFF09\uFF1A\u8BBE\u7F6E\u662F\u5426\u6253\u5370\u6587\u4EF6\u540D\u548C\u884C\u53F7\u3002</li></ul><h3 id="\u521B\u5EFAlogger\u53CA\u5404\u7EA7\u522B\u65E5\u5FD7\u6253\u5370\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFAlogger\u53CA\u5404\u7EA7\u522B\u65E5\u5FD7\u6253\u5370\u65B9\u6CD5" aria-hidden="true">#</a> \u521B\u5EFALogger\u53CA\u5404\u7EA7\u522B\u65E5\u5FD7\u6253\u5370\u65B9\u6CD5</h3>`,15),zn=s("\u4E3A\u4E86\u6253\u5370\u65E5\u5FD7\uFF0C\u6211\u4EEC\u9700\u8981\u6839\u636E\u65E5\u5FD7\u914D\u7F6E\uFF0C\u521B\u5EFA\u4E00\u4E2ALogger\uFF0C\u7136\u540E\u901A\u8FC7\u8C03\u7528Logger\u7684\u65E5\u5FD7\u6253\u5370\u65B9\u6CD5\uFF0C\u5B8C\u6210\u5404\u7EA7\u522B\u65E5\u5FD7\u7684\u8F93\u51FA\u3002\u672C\u793A\u4F8B\u5C06\u521B\u5EFA\u4EE3\u7801\u4FDD\u5B58\u5728"),Cn={href:"https://github.com/marmotedu/gopractise-demo/blob/main/log/cuslog/logger.go",target:"_blank",rel:"noopener noreferrer"},Nn=s("logger.go"),Sn=s("\u6587\u4EF6\u4E2D\u3002"),Dn=p(`<p>\u53EF\u4EE5\u901A\u8FC7\u5982\u4E0B\u65B9\u5F0F\u521B\u5EFA<code>Logger</code>\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>
<span class="token keyword">var</span> std <span class="token operator">=</span> <span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">type</span> logger <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    opt       <span class="token operator">*</span>options
    mu        sync<span class="token punctuation">.</span>Mutex
    entryPool <span class="token operator">*</span>sync<span class="token punctuation">.</span>Pool
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">New</span><span class="token punctuation">(</span>opts <span class="token operator">...</span>Option<span class="token punctuation">)</span> <span class="token operator">*</span>logger <span class="token punctuation">{</span>
    logger <span class="token operator">:=</span> <span class="token operator">&amp;</span>logger<span class="token punctuation">{</span>opt<span class="token punctuation">:</span> <span class="token function">initOptions</span><span class="token punctuation">(</span>opts<span class="token operator">...</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    logger<span class="token punctuation">.</span>entryPool <span class="token operator">=</span> <span class="token operator">&amp;</span>sync<span class="token punctuation">.</span>Pool<span class="token punctuation">{</span>New<span class="token punctuation">:</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">entry</span><span class="token punctuation">(</span>logger<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token keyword">return</span> logger
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u8FF0\u4EE3\u7801\u4E2D\uFF0C\u5B9A\u4E49\u4E86\u4E00\u4E2ALogger\uFF0C\u5E76\u5B9E\u73B0\u4E86\u521B\u5EFALogger\u7684New\u51FD\u6570\u3002\u65E5\u5FD7\u5305\u90FD\u4F1A\u6709\u4E00\u4E2A\u9ED8\u8BA4\u7684\u5168\u5C40Logger\uFF0C\u672C\u793A\u4F8B\u901A\u8FC7 <code>var std = New()</code> \u521B\u5EFA\u4E86\u4E00\u4E2A\u5168\u5C40\u7684\u9ED8\u8BA4Logger\u3002<code>cuslog.Debug</code>\u3001<code>cuslog.Info</code>\u548C<code>cuslog.Warnf</code>\u7B49\u51FD\u6570\uFF0C\u5219\u662F\u901A\u8FC7\u8C03\u7528<code>std Logger</code>\u6240\u63D0\u4F9B\u7684\u65B9\u6CD5\u6765\u6253\u5370\u65E5\u5FD7\u7684\u3002</p><p>\u5B9A\u4E49\u4E86\u4E00\u4E2ALogger\u4E4B\u540E\uFF0C\u8FD8\u9700\u8981\u7ED9\u8BE5Logger\u6DFB\u52A0\u6700\u6838\u5FC3\u7684\u65E5\u5FD7\u6253\u5370\u65B9\u6CD5\uFF0C\u8981\u63D0\u4F9B\u6240\u6709\u652F\u6301\u7EA7\u522B\u7684\u65E5\u5FD7\u6253\u5370\u65B9\u6CD5\u3002</p><p>\u5982\u679C\u65E5\u5FD7\u7EA7\u522B\u662FXyz\uFF0C\u5219\u901A\u5E38\u9700\u8981\u63D0\u4F9B\u4E24\u7C7B\u65B9\u6CD5\uFF0C\u5206\u522B\u662F\u975E\u683C\u5F0F\u5316\u65B9\u6CD5<code>Xyz(args ...interface{})</code>\u548C\u683C\u5F0F\u5316\u65B9\u6CD5<code>Xyzf(format string, args ...interface{})</code>\uFF0C\u4F8B\u5982\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>logger<span class="token punctuation">)</span> <span class="token function">Debug</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    l<span class="token punctuation">.</span><span class="token function">entry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>DebugLevel<span class="token punctuation">,</span> FmtEmptySeparate<span class="token punctuation">,</span> args<span class="token operator">...</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>logger<span class="token punctuation">)</span> <span class="token function">Debugf</span><span class="token punctuation">(</span>format <span class="token builtin">string</span><span class="token punctuation">,</span> args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    l<span class="token punctuation">.</span><span class="token function">entry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>DebugLevel<span class="token punctuation">,</span> format<span class="token punctuation">,</span> args<span class="token operator">...</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6),On=s("\u672C\u793A\u4F8B\u5B9E\u73B0\u4E86\u5982\u4E0B\u65B9\u6CD5\uFF1ADebug\u3001Debugf\u3001Info\u3001Infof\u3001Warn\u3001Warnf\u3001Error\u3001Errorf\u3001Panic\u3001Panicf\u3001Fatal\u3001Fatalf\u3002\u66F4\u8BE6\u7EC6\u7684\u5B9E\u73B0\uFF0C\u4F60\u53EF\u4EE5\u53C2\u8003 "),Wn={href:"https://github.com/marmotedu/gopractise-demo/blob/main/log/cuslog/logger.go",target:"_blank",rel:"noopener noreferrer"},Pn=s("cuslog/logger.go"),Tn=s("\u3002"),Rn=n("p",null,[s("\u8FD9\u91CC\u8981\u6CE8\u610F\uFF0CPanic\u3001Panicf\u8981\u8C03\u7528panic()\u51FD\u6570\uFF0CFatal\u3001Fatalf\u51FD\u6570\u8981\u8C03\u7528 "),n("code",null,"os.Exit(1)"),s(" \u51FD\u6570\u3002")],-1),Vn=n("h3",{id:"\u5C06\u65E5\u5FD7\u8F93\u51FA\u5230\u652F\u6301\u7684\u8F93\u51FA\u4E2D",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5C06\u65E5\u5FD7\u8F93\u51FA\u5230\u652F\u6301\u7684\u8F93\u51FA\u4E2D","aria-hidden":"true"},"#"),s(" \u5C06\u65E5\u5FD7\u8F93\u51FA\u5230\u652F\u6301\u7684\u8F93\u51FA\u4E2D")],-1),An=s("\u8C03\u7528\u65E5\u5FD7\u6253\u5370\u51FD\u6570\u4E4B\u540E\uFF0C\u8FD8\u9700\u8981\u5C06\u8FD9\u4E9B\u65E5\u5FD7\u8F93\u51FA\u5230\u652F\u6301\u7684\u8F93\u51FA\u4E2D\uFF0C\u6240\u4EE5\u9700\u8981\u5B9E\u73B0"),jn=n("code",null,"write",-1),Kn=s("\u51FD\u6570\uFF0C\u5B83\u7684\u5199\u5165\u903B\u8F91\u4FDD\u5B58\u5728"),Gn={href:"https://github.com/marmotedu/gopractise-demo/blob/main/log/cuslog/entry.go",target:"_blank",rel:"noopener noreferrer"},Mn=s("entry.go"),Xn=s("\u6587\u4EF6\u4E2D\u3002\u5B9E\u73B0\u65B9\u5F0F\u5982\u4E0B\uFF1A"),Bn=p(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Entry <span class="token keyword">struct</span> <span class="token punctuation">{</span>
    logger <span class="token operator">*</span>logger
    Buffer <span class="token operator">*</span>bytes<span class="token punctuation">.</span>Buffer
    Map    <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    Level  Level
    Time   time<span class="token punctuation">.</span>Time
    File   <span class="token builtin">string</span>
    Line   <span class="token builtin">int</span>
    Func   <span class="token builtin">string</span>
    Format <span class="token builtin">string</span>
    Args   <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>e <span class="token operator">*</span>Entry<span class="token punctuation">)</span> <span class="token function">write</span><span class="token punctuation">(</span>level Level<span class="token punctuation">,</span> format <span class="token builtin">string</span><span class="token punctuation">,</span> args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> e<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>level <span class="token operator">&gt;</span> level <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    e<span class="token punctuation">.</span>Time <span class="token operator">=</span> time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    e<span class="token punctuation">.</span>Level <span class="token operator">=</span> level
    e<span class="token punctuation">.</span>Format <span class="token operator">=</span> format
    e<span class="token punctuation">.</span>Args <span class="token operator">=</span> args
    <span class="token keyword">if</span> <span class="token operator">!</span>e<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>disableCaller <span class="token punctuation">{</span>
        <span class="token keyword">if</span> pc<span class="token punctuation">,</span> file<span class="token punctuation">,</span> line<span class="token punctuation">,</span> ok <span class="token operator">:=</span> runtime<span class="token punctuation">.</span><span class="token function">Caller</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">!</span>ok <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span>File <span class="token operator">=</span> <span class="token string">&quot;???&quot;</span>
            e<span class="token punctuation">.</span>Func <span class="token operator">=</span> <span class="token string">&quot;???&quot;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span>File<span class="token punctuation">,</span> e<span class="token punctuation">.</span>Line<span class="token punctuation">,</span> e<span class="token punctuation">.</span>Func <span class="token operator">=</span> file<span class="token punctuation">,</span> line<span class="token punctuation">,</span> runtime<span class="token punctuation">.</span><span class="token function">FuncForPC</span><span class="token punctuation">(</span>pc<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            e<span class="token punctuation">.</span>Func <span class="token operator">=</span> e<span class="token punctuation">.</span>Func<span class="token punctuation">[</span>strings<span class="token punctuation">.</span><span class="token function">LastIndex</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>Func<span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    e<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    e<span class="token punctuation">.</span><span class="token function">writer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    e<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>e <span class="token operator">*</span>Entry<span class="token punctuation">)</span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token boolean">_</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>formatter<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>e <span class="token operator">*</span>Entry<span class="token punctuation">)</span> <span class="token function">writer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>mu<span class="token punctuation">.</span><span class="token function">Lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token boolean">_</span><span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>opt<span class="token punctuation">.</span>output<span class="token punctuation">.</span><span class="token function">Write</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>Buffer<span class="token punctuation">.</span><span class="token function">Bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    e<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>mu<span class="token punctuation">.</span><span class="token function">Unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>e <span class="token operator">*</span>Entry<span class="token punctuation">)</span> <span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    e<span class="token punctuation">.</span>Args<span class="token punctuation">,</span> e<span class="token punctuation">.</span>Line<span class="token punctuation">,</span> e<span class="token punctuation">.</span>File<span class="token punctuation">,</span> e<span class="token punctuation">.</span>Format<span class="token punctuation">,</span> e<span class="token punctuation">.</span>Func <span class="token operator">=</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span>
    e<span class="token punctuation">.</span>Buffer<span class="token punctuation">.</span><span class="token function">Reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    e<span class="token punctuation">.</span>logger<span class="token punctuation">.</span>entryPool<span class="token punctuation">.</span><span class="token function">Put</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u8FF0\u4EE3\u7801\uFF0C\u9996\u5148\u5B9A\u4E49\u4E86\u4E00\u4E2AEntry\u7ED3\u6784\u4F53\u7C7B\u578B\uFF0C\u8BE5\u7C7B\u578B\u7528\u6765\u4FDD\u5B58\u6240\u6709\u7684\u65E5\u5FD7\u4FE1\u606F\uFF0C\u5373\u65E5\u5FD7\u914D\u7F6E\u548C\u65E5\u5FD7\u5185\u5BB9\u3002\u5199\u5165\u903B\u8F91\u90FD\u662F\u56F4\u7ED5Entry\u7C7B\u578B\u7684\u5B9E\u4F8B\u6765\u5B8C\u6210\u7684\u3002</p><p>\u7528Entry\u7684write\u65B9\u6CD5\u6765\u5B8C\u6210\u65E5\u5FD7\u7684\u5199\u5165\uFF0C\u5728write\u65B9\u6CD5\u4E2D\uFF0C\u4F1A\u9996\u5148\u5224\u65AD\u65E5\u5FD7\u7684\u8F93\u51FA\u7EA7\u522B\u548C\u5F00\u5173\u7EA7\u522B\uFF0C\u5982\u679C\u8F93\u51FA\u7EA7\u522B\u5C0F\u4E8E\u5F00\u5173\u7EA7\u522B\uFF0C\u5219\u76F4\u63A5\u8FD4\u56DE\uFF0C\u4E0D\u505A\u4EFB\u4F55\u8BB0\u5F55\u3002</p><p>\u5728write\u4E2D\uFF0C\u8FD8\u4F1A\u5224\u65AD\u662F\u5426\u9700\u8981\u8BB0\u5F55\u6587\u4EF6\u540D\u548C\u884C\u53F7\uFF0C\u5982\u679C\u9700\u8981\u5219\u8C03\u7528 <code>runtime.Caller()</code> \u6765\u83B7\u53D6\u6587\u4EF6\u540D\u548C\u884C\u53F7\uFF0C\u8C03\u7528 <code>runtime.Caller()</code> \u65F6\uFF0C\u8981\u6CE8\u610F\u4F20\u5165\u6B63\u786E\u7684\u6808\u6DF1\u5EA6\u3002</p><p>write\u51FD\u6570\u4E2D\u8C03\u7528 <code>e.format</code> \u6765\u683C\u5F0F\u5316\u65E5\u5FD7\uFF0C\u8C03\u7528 <code>e.writer</code> \u6765\u5199\u5165\u65E5\u5FD7\uFF0C\u5728\u521B\u5EFALogger\u4F20\u5165\u7684\u65E5\u5FD7\u914D\u7F6E\u4E2D\uFF0C\u6307\u5B9A\u4E86\u8F93\u51FA\u4F4D\u7F6E <code>output io.Writer</code> \uFF0Coutput\u7C7B\u578B\u4E3A <code>io.Writer</code> \uFF0C\u793A\u4F8B\u5982\u4E0B\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Writer <span class="token keyword">interface</span> <span class="token punctuation">{</span>    
    <span class="token function">Write</span><span class="token punctuation">(</span>p <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">byte</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>n <span class="token builtin">int</span><span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>io.Writer\u5B9E\u73B0\u4E86Write\u65B9\u6CD5\u53EF\u4F9B\u5199\u5165\uFF0C\u6240\u4EE5\u53EA\u9700\u8981\u8C03\u7528<code>e.logger.opt.output.Write(e.Buffer.Bytes())</code>\u5373\u53EF\u5C06\u65E5\u5FD7\u5199\u5165\u5230\u6307\u5B9A\u7684\u4F4D\u7F6E\u4E2D\u3002\u6700\u540E\uFF0C\u4F1A\u8C03\u7528release()\u65B9\u6CD5\u6765\u6E05\u7A7A\u7F13\u5B58\u548C\u5BF9\u8C61\u6C60\u3002\u81F3\u6B64\uFF0C\u6211\u4EEC\u5C31\u5B8C\u6210\u4E86\u65E5\u5FD7\u7684\u8BB0\u5F55\u548C\u5199\u5165\u3002</p><h3 id="\u81EA\u5B9A\u4E49\u65E5\u5FD7\u8F93\u51FA\u683C\u5F0F" tabindex="-1"><a class="header-anchor" href="#\u81EA\u5B9A\u4E49\u65E5\u5FD7\u8F93\u51FA\u683C\u5F0F" aria-hidden="true">#</a> \u81EA\u5B9A\u4E49\u65E5\u5FD7\u8F93\u51FA\u683C\u5F0F</h3><p>cuslog\u5305\u652F\u6301\u81EA\u5B9A\u4E49\u8F93\u51FA\u683C\u5F0F\uFF0C\u5E76\u4E14\u5185\u7F6E\u4E86JSON\u548C Text \u683C\u5F0F\u7684 <code>Formatter</code>\u3002<code>Formatter</code> \u63A5\u53E3\u5B9A\u4E49\u4E3A\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">type</span> Formatter <span class="token keyword">interface</span> <span class="token punctuation">{</span>    
    <span class="token function">Format</span><span class="token punctuation">(</span>entry <span class="token operator">*</span>Entry<span class="token punctuation">)</span> <span class="token builtin">error</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,10),Un=s("cuslog\u5185\u7F6E\u7684Formatter\u6709\u4E24\u4E2A\uFF1A"),Hn={href:"https://github.com/marmotedu/gopractise-demo/blob/main/log/cuslog/formatter_json.go",target:"_blank",rel:"noopener noreferrer"},Jn=s("JSON"),$n=s("\u548C"),Yn={href:"https://github.com/marmotedu/gopractise-demo/blob/main/log/cuslog/formatter_text.go",target:"_blank",rel:"noopener noreferrer"},Qn=s("TEXT"),Zn=s("\u3002"),ns=p(`<h3 id="\u6D4B\u8BD5\u65E5\u5FD7\u5305" tabindex="-1"><a class="header-anchor" href="#\u6D4B\u8BD5\u65E5\u5FD7\u5305" aria-hidden="true">#</a> \u6D4B\u8BD5\u65E5\u5FD7\u5305</h3><p>cuslog\u65E5\u5FD7\u5305\u5F00\u53D1\u5B8C\u6210\u4E4B\u540E\uFF0C\u53EF\u4EE5\u7F16\u5199\u6D4B\u8BD5\u4EE3\u7801\uFF0C\u8C03\u7528<code>cuslog</code>\u5305\u6765\u6D4B\u8BD5<code>cuslog</code>\u5305\uFF0C\u4EE3\u7801\u5982\u4E0B\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;log&quot;</span>
    <span class="token string">&quot;os&quot;</span>

    <span class="token string">&quot;github.com/marmotedu/gopractise-demo/log/cuslog&quot;</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cuslog<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;std log&quot;</span><span class="token punctuation">)</span>
    cuslog<span class="token punctuation">.</span><span class="token function">SetOptions</span><span class="token punctuation">(</span>cuslog<span class="token punctuation">.</span><span class="token function">WithLevel</span><span class="token punctuation">(</span>cuslog<span class="token punctuation">.</span>DebugLevel<span class="token punctuation">)</span><span class="token punctuation">)</span>
    cuslog<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token string">&quot;change std log to debug level&quot;</span><span class="token punctuation">)</span>
    cuslog<span class="token punctuation">.</span><span class="token function">SetOptions</span><span class="token punctuation">(</span>cuslog<span class="token punctuation">.</span><span class="token function">WithFormatter</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>cuslog<span class="token punctuation">.</span>JsonFormatter<span class="token punctuation">{</span>IgnoreBasicFields<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    cuslog<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span><span class="token string">&quot;log in json format&quot;</span><span class="token punctuation">)</span>
    cuslog<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;another log in json format&quot;</span><span class="token punctuation">)</span>

    <span class="token comment">// \u8F93\u51FA\u5230\u6587\u4EF6</span>
    fd<span class="token punctuation">,</span> err <span class="token operator">:=</span> os<span class="token punctuation">.</span><span class="token function">OpenFile</span><span class="token punctuation">(</span><span class="token string">&quot;test.log&quot;</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span>O_APPEND<span class="token operator">|</span>os<span class="token punctuation">.</span>O_CREATE<span class="token operator">|</span>os<span class="token punctuation">.</span>O_WRONLY<span class="token punctuation">,</span> <span class="token number">0644</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">Fatalln</span><span class="token punctuation">(</span><span class="token string">&quot;create file test.log failed&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">defer</span> fd<span class="token punctuation">.</span><span class="token function">Close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    l <span class="token operator">:=</span> cuslog<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span>cuslog<span class="token punctuation">.</span><span class="token function">WithLevel</span><span class="token punctuation">(</span>cuslog<span class="token punctuation">.</span>InfoLevel<span class="token punctuation">)</span><span class="token punctuation">,</span>
        cuslog<span class="token punctuation">.</span><span class="token function">WithOutput</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span><span class="token punctuation">,</span>
        cuslog<span class="token punctuation">.</span><span class="token function">WithFormatter</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>cuslog<span class="token punctuation">.</span>JsonFormatter<span class="token punctuation">{</span>IgnoreBasicFields<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    l<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;custom log with json formatter&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5C06\u4E0A\u8FF0\u4EE3\u7801\u4FDD\u5B58\u5728main.go\u6587\u4EF6\u4E2D\uFF0C\u8FD0\u884C\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ go run example.go
<span class="token number">2020</span>-12-04T10:32:12+08:00 INFO example.go:11 std log
<span class="token number">2020</span>-12-04T10:32:12+08:00 DEBUG example.go:13 change std log to debug level
<span class="token punctuation">{</span><span class="token string">&quot;file&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;/home/colin/workspace/golang/src/github.com/marmotedu/gopractise-demo/log/cuslog/example/example.go:15&quot;</span>,<span class="token string">&quot;func&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;main.main&quot;</span>,<span class="token string">&quot;message&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;log in json format&quot;</span>,<span class="token string">&quot;level&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;DEBUG&quot;</span>,<span class="token string">&quot;time&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;2020-12-04T10:32:12+08:00&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token string">&quot;level&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;INFO&quot;</span>,<span class="token string">&quot;time&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;2020-12-04T10:32:12+08:00&quot;</span>,<span class="token string">&quot;file&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;/home/colin/workspace/golang/src/github.com/marmotedu/gopractise-demo/log/cuslog/example/example.go:16&quot;</span>,<span class="token string">&quot;func&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;main.main&quot;</span>,<span class="token string">&quot;message&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;another log in json format&quot;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5),ss=s("\u5230\u8FD9\u91CC\u65E5\u5FD7\u5305\u5C31\u5F00\u53D1\u5B8C\u6210\u4E86\uFF0C\u5B8C\u6574\u5305\u89C1 "),as={href:"https://github.com/marmotedu/gopractise-demo/tree/main/log/cuslog",target:"_blank",rel:"noopener noreferrer"},es=s("log/cuslog"),ts=s("\u3002"),os=n("h3",{id:"iam\u9879\u76EE\u65E5\u5FD7\u5305\u8BBE\u8BA1",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#iam\u9879\u76EE\u65E5\u5FD7\u5305\u8BBE\u8BA1","aria-hidden":"true"},"#"),s(" IAM\u9879\u76EE\u65E5\u5FD7\u5305\u8BBE\u8BA1")],-1),ps=n("p",null,"\u8FD9\u4E00\u8BB2\u7684\u6700\u540E\uFF0C\u6211\u4EEC\u518D\u6765\u770B\u4E0B\u6211\u4EEC\u7684IAM\u9879\u76EE\u4E2D\uFF0C\u65E5\u5FD7\u5305\u662F\u600E\u4E48\u8BBE\u8BA1\u7684\u3002",-1),ls=s("\u5148\u6765\u770B\u4E00\u4E0BIAM\u9879\u76EElog\u5305\u7684\u5B58\u653E\u4F4D\u7F6E\uFF1A"),is={href:"https://github.com/marmotedu/iam/tree/v1.0.0/pkg/log",target:"_blank",rel:"noopener noreferrer"},cs=s("pkg/log"),us=s("\u3002\u653E\u5728\u8FD9\u4E2A\u4F4D\u7F6E\uFF0C\u4E3B\u8981\u6709\u4E24\u4E2A\u539F\u56E0\uFF1A"),rs=n("ul",null,[n("li",null,[s("\u7B2C\u4E00\u4E2A\uFF0C"),n("code",null,"log"),s(" \u5305\u5C5E\u4E8EIAM\u9879\u76EE\uFF0C\u6709\u5B9A\u5236\u5F00\u53D1\u7684\u5185\u5BB9\uFF1B")]),n("li",null,[s("\u7B2C\u4E8C\u4E2A\uFF0C"),n("code",null,"log"),s(" \u5305\u529F\u80FD\u5B8C\u5907\u3001\u6210\u719F\uFF0C\u5916\u90E8\u9879\u76EE\u4E5F\u53EF\u4EE5\u4F7F\u7528\u3002")])],-1),ds=s("\u8BE5log\u5305\u662F\u57FA\u4E8E "),ks=n("code",null,"go.uber.org/zap",-1),gs=s(" \u5305\u5C01\u88C5\u800C\u6765\u7684\uFF0C\u6839\u636E\u9700\u8981\u6DFB\u52A0\u4E86\u66F4\u4E30\u5BCC\u7684\u529F\u80FD\u3002\u63A5\u4E0B\u6765\uFF0C\u6211\u4EEC\u901A\u8FC7log\u5305\u7684"),vs={href:"https://github.com/marmotedu/iam/blob/master/pkg/log/options.go#L47",target:"_blank",rel:"noopener noreferrer"},ms=s("Options"),bs=s("\uFF0C\u6765\u770B\u4E0Blog\u5305\u6240\u5B9E\u73B0\u7684\u529F\u80FD\uFF1A"),qs=p('<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// Options contains configuration items related to log.</span>\n<span class="token keyword">type</span> Options <span class="token keyword">struct</span> <span class="token punctuation">{</span>\n	OutputPaths       <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span> <span class="token string">`json:&quot;output-paths&quot;       mapstructure:&quot;output-paths&quot;`</span>\n	ErrorOutputPaths  <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span> <span class="token string">`json:&quot;error-output-paths&quot; mapstructure:&quot;error-output-paths&quot;`</span>\n	Level             <span class="token builtin">string</span>   <span class="token string">`json:&quot;level&quot;              mapstructure:&quot;level&quot;`</span>\n	Format            <span class="token builtin">string</span>   <span class="token string">`json:&quot;format&quot;             mapstructure:&quot;format&quot;`</span>\n	DisableCaller     <span class="token builtin">bool</span>     <span class="token string">`json:&quot;disable-caller&quot;     mapstructure:&quot;disable-caller&quot;`</span>\n	DisableStacktrace <span class="token builtin">bool</span>     <span class="token string">`json:&quot;disable-stacktrace&quot; mapstructure:&quot;disable-stacktrace&quot;`</span>\n	EnableColor       <span class="token builtin">bool</span>     <span class="token string">`json:&quot;enable-color&quot;       mapstructure:&quot;enable-color&quot;`</span>\n	Development       <span class="token builtin">bool</span>     <span class="token string">`json:&quot;development&quot;        mapstructure:&quot;development&quot;`</span>\n	Name              <span class="token builtin">string</span>   <span class="token string">`json:&quot;name&quot;               mapstructure:&quot;name&quot;`</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Options\u5404\u914D\u7F6E\u9879\u542B\u4E49\u5982\u4E0B\uFF1A</strong></p><ul><li>development\uFF1A\u662F\u5426\u662F\u5F00\u53D1\u6A21\u5F0F\u3002\u5982\u679C\u662F\u5F00\u53D1\u6A21\u5F0F\uFF0C\u4F1A\u5BF9DPanicLevel\u8FDB\u884C\u5806\u6808\u8DDF\u8E2A\u3002</li><li>name\uFF1ALogger\u7684\u540D\u5B57\u3002</li><li>disable-caller\uFF1A\u662F\u5426\u5F00\u542F caller\uFF0C\u5982\u679C\u5F00\u542F\u4F1A\u5728\u65E5\u5FD7\u4E2D\u663E\u793A\u8C03\u7528\u65E5\u5FD7\u6240\u5728\u7684\u6587\u4EF6\u3001\u51FD\u6570\u548C\u884C\u53F7\u3002</li><li>disable-stacktrace\uFF1A\u662F\u5426\u5728Panic\u53CA\u4EE5\u4E0A\u7EA7\u522B\u7981\u6B62\u6253\u5370\u5806\u6808\u4FE1\u606F\u3002</li><li>enable-color\uFF1A\u662F\u5426\u5F00\u542F\u989C\u8272\u8F93\u51FA\uFF0Ctrue\uFF0C\u662F\uFF1Bfalse\uFF0C\u5426\u3002</li><li>level\uFF1A\u65E5\u5FD7\u7EA7\u522B\uFF0C\u4F18\u5148\u7EA7\u4ECE\u4F4E\u5230\u9AD8\u4F9D\u6B21\u4E3A\uFF1ADebug, Info, Warn, Error, Dpanic, Panic, Fatal\u3002</li><li>format\uFF1A\u652F\u6301\u7684\u65E5\u5FD7\u8F93\u51FA\u683C\u5F0F\uFF0C\u76EE\u524D\u652F\u6301Console\u548CJSON\u4E24\u79CD\u3002Console\u5176\u5B9E\u5C31\u662FText\u683C\u5F0F\u3002</li><li>output-paths\uFF1A\u652F\u6301\u8F93\u51FA\u5230\u591A\u4E2A\u8F93\u51FA\uFF0C\u7528\u9017\u53F7\u5206\u5F00\u3002\u652F\u6301\u8F93\u51FA\u5230\u6807\u51C6\u8F93\u51FA\uFF08stdout\uFF09\u548C\u6587\u4EF6\u3002</li><li>error-output-paths\uFF1Azap\u5185\u90E8(\u975E\u4E1A\u52A1)\u9519\u8BEF\u65E5\u5FD7\u8F93\u51FA\u8DEF\u5F84\uFF0C\u591A\u4E2A\u8F93\u51FA\uFF0C\u7528\u9017\u53F7\u5206\u5F00\u3002</li></ul><p><strong>log\u5305\u7684Options\u7ED3\u6784\u4F53\u652F\u6301\u4EE5\u4E0B3\u4E2A\u65B9\u6CD5\uFF1A</strong></p><ul><li>Build\u65B9\u6CD5\u3002Build\u65B9\u6CD5\u53EF\u4EE5\u6839\u636EOptions\u6784\u5EFA\u4E00\u4E2A\u5168\u5C40\u7684Logger\u3002</li><li>AddFlags\u65B9\u6CD5\u3002AddFlags\u65B9\u6CD5\u53EF\u4EE5\u5C06Options\u7684\u5404\u4E2A\u5B57\u6BB5\u8FFD\u52A0\u5230\u4F20\u5165\u7684pflag.FlagSet\u53D8\u91CF\u4E2D\u3002</li><li>String\u65B9\u6CD5\u3002String\u65B9\u6CD5\u53EF\u4EE5\u5C06Options\u7684\u503C\u4EE5JSON\u683C\u5F0F\u5B57\u7B26\u4E32\u8FD4\u56DE\u3002</li></ul><p><strong>log\u5305\u5B9E\u73B0\u4E86\u4EE5\u4E0B3\u79CD\u65E5\u5FD7\u8BB0\u5F55\u65B9\u6CD5\uFF1A</strong></p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>log<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;This is a info message&quot;</span><span class="token punctuation">,</span> log<span class="token punctuation">.</span><span class="token function">Int32</span><span class="token punctuation">(</span><span class="token string">&quot;int_key&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\nlog<span class="token punctuation">.</span><span class="token function">Infof</span><span class="token punctuation">(</span><span class="token string">&quot;This is a formatted %s message&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;info&quot;</span><span class="token punctuation">)</span>\nlog<span class="token punctuation">.</span><span class="token function">Infow</span><span class="token punctuation">(</span><span class="token string">&quot;Message printed with Infow&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;X-Request-ID&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;fbf54504-64da-4088-9b86-67824a7fb508&quot;</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Info</code> \u4F7F\u7528\u6307\u5B9A\u7684 <code>key/value</code> \u8BB0\u5F55\u65E5\u5FD7\u3002<code>Infof</code> \u683C\u5F0F\u5316\u8BB0\u5F55\u65E5\u5FD7\u3002 <code>Infow</code> \u4E5F\u662F\u4F7F\u7528\u6307\u5B9A\u7684 <code>key/value</code>\u8BB0\u5F55\u65E5\u5FD7\uFF0C\u8DDF <code>Info</code> \u7684\u533A\u522B\u662F\uFF1A\u4F7F\u7528 <code>Info</code> \u9700\u8981\u6307\u5B9A\u503C\u7684\u7C7B\u578B\uFF0C\u901A\u8FC7\u6307\u5B9A\u503C\u7684\u65E5\u5FD7\u7C7B\u578B\uFF0C\u65E5\u5FD7\u5E93\u5E95\u5C42\u4E0D\u9700\u8981\u8FDB\u884C\u53CD\u5C04\u64CD\u4F5C\uFF0C\u6240\u4EE5\u4F7F\u7528 <code>Info</code> \u8BB0\u5F55\u65E5\u5FD7\u6027\u80FD\u6700\u9AD8\u3002</p>',8),fs=s("log\u5305\u652F\u6301\u975E\u5E38\u4E30\u5BCC\u7684\u7C7B\u578B\uFF0C\u5177\u4F53\u4F60\u53EF\u4EE5\u53C2\u8003 "),hs={href:"https://github.com/marmotedu/iam/blob/master/pkg/log/types.go#L56",target:"_blank",rel:"noopener noreferrer"},_s=s("types.go"),ys=s("\u3002"),xs=p(`<p><strong>\u4E0A\u8FF0\u65E5\u5FD7\u8F93\u51FA\u4E3A\uFF1A</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">2021</span>-07-06 <span class="token number">14</span>:02:07.070 INFO This is a info message <span class="token punctuation">{</span><span class="token string">&quot;int_key&quot;</span><span class="token builtin class-name">:</span> <span class="token number">10</span><span class="token punctuation">}</span>
<span class="token number">2021</span>-07-06 <span class="token number">14</span>:02:07.071 INFO This is a formatted info message
<span class="token number">2021</span>-07-06 <span class="token number">14</span>:02:07.071 INFO Message printed with Infow <span class="token punctuation">{</span><span class="token string">&quot;X-Request-ID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;fbf54504-64da-4088-9b86-67824a7fb508&quot;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>log\u5305\u4E3A\u6BCF\u79CD\u7EA7\u522B\u7684\u65E5\u5FD7\u90FD\u63D0\u4F9B\u4E863\u79CD\u65E5\u5FD7\u8BB0\u5F55\u65B9\u5F0F\uFF0C\u4E3E\u4E2A\u4F8B\u5B50\uFF1A\u5047\u8BBE\u65E5\u5FD7\u683C\u5F0F\u4E3A <code>Xyz</code> \uFF0C\u5219\u5206\u522B\u63D0\u4F9B\u4E86 <code>Xyz(msg string, fields ...Field)</code> \uFF0C<code>Xyzf(format string, v ...interface{})</code> \uFF0C<code>Xyzw(msg string, keysAndValues ...interface{})</code> 3\u79CD\u65E5\u5FD7\u8BB0\u5F55\u65B9\u6CD5\u3002</p><p>\u53E6\u5916\uFF0Clog\u5305\u76F8\u8F83\u4E8E\u4E00\u822C\u7684\u65E5\u5FD7\u5305\uFF0C\u8FD8\u63D0\u4F9B\u4E86\u4F17\u591A\u8BB0\u5F55\u65E5\u5FD7\u7684\u65B9\u6CD5\u3002</p><p><strong>\u7B2C\u4E00\u4E2A\u65B9\u6CD5\uFF0C</strong> log\u5305\u652F\u6301V Level\uFF0C\u53EF\u4EE5\u901A\u8FC7\u6574\u578B\u6570\u503C\u6765\u7075\u6D3B\u6307\u5B9A\u65E5\u5FD7\u7EA7\u522B\uFF0C\u6570\u503C\u8D8A\u5927\uFF0C\u4F18\u5148\u7EA7\u8D8A\u4F4E\u3002\u4F8B\u5982\uFF1A</p><blockquote><p>\u26A0\uFE0F <code>V Level</code>\u662F\u6307\u5728<code>glog</code>\u65E5\u5FD7\u5E93\u4E2D\u7528\u4E8E\u63A7\u5236\u65E5\u5FD7\u7EA7\u522B\u7684\u4E00\u79CD\u673A\u5236\u3002<code>glog</code>\u662F\u4E00\u4E2A Go \u8BED\u8A00\u7684\u65E5\u5FD7\u5E93\uFF0C\u53EF\u4EE5\u65B9\u4FBF\u5730\u8FDB\u884C\u65E5\u5FD7\u8BB0\u5F55\u548C\u8F93\u51FA\u3002</p><p><code>V Level</code>\u8868\u793A verbose level\uFF0C\u5373\u5197\u957F\u7A0B\u5EA6\u3002\u5728<code>glog</code>\u4E2D\uFF0C\u901A\u8FC7\u8BBE\u7F6E<code>V Level</code>\u7684\u503C\uFF0C\u53EF\u4EE5\u63A7\u5236\u65E5\u5FD7\u7684\u8F93\u51FA\u7EA7\u522B\u3002<code>V Level</code>\u7684\u53D6\u503C\u8303\u56F4\u662F<code>0~~4</code>\uFF0C\u5176\u4E2D0\u8868\u793A\u53EA\u8F93\u51FA\u666E\u901A\u65E5\u5FD7\uFF0C<code>1~~4</code>\u8868\u793A\u8F93\u51FA\u5BF9\u5E94\u7EA7\u522B\u7684\u8C03\u8BD5\u4FE1\u606F\u3002</p><p><code>glog</code>\u4E2D\u901A\u8FC7<code>V()</code>\u65B9\u6CD5\u6765\u8BBE\u7F6E<code>V Level</code>\u7684\u503C\uFF0C\u4F8B\u5982\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>glog<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;This is a verbose level 1 log message.&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5728\u8FD9\u4E2A\u4F8B\u5B50\u4E2D\uFF0C\u901A\u8FC7<code>glog.V(1)</code>\u8BBE\u7F6E<code>V Level</code>\u7684\u503C\u4E3A1\uFF0C\u7136\u540E\u8C03\u7528<code>Info()</code>\u65B9\u6CD5\u8F93\u51FA\u4E00\u6761\u65E5\u5FD7\u3002\u7531\u4E8E<code>V Level</code>\u7684\u503C\u4E3A1\uFF0C\u56E0\u6B64\u8FD9\u6761\u65E5\u5FD7\u4F1A\u88AB\u8F93\u51FA\u3002</p><p>\u5728<code>glog</code>\u4E2D\uFF0C\u8FD8\u53EF\u4EE5\u4F7F\u7528<code>vmodule</code>\u9009\u9879\u6765\u63A7\u5236\u4E0D\u540C\u5305\u4E2D\u7684\u65E5\u5FD7\u8F93\u51FA\u7EA7\u522B\u3002\u901A\u8FC7\u8BBE\u7F6E<code>vmodule</code>\u9009\u9879\uFF0C\u53EF\u4EE5\u5B9E\u73B0\u66F4\u7EC6\u7C92\u5EA6\u7684\u65E5\u5FD7\u63A7\u5236\u3002\u4F8B\u5982\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ go run main.go <span class="token parameter variable">-vmodule</span><span class="token operator">=</span>module1<span class="token operator">=</span><span class="token number">2</span>,module2<span class="token operator">=</span><span class="token number">3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5728\u8FD9\u4E2A\u4F8B\u5B50\u4E2D\uFF0C\u901A\u8FC7\u8BBE\u7F6E<code>vmodule</code>\u9009\u9879\u6765\u63A7\u5236<code>module1</code>\u5305\u4E2D\u7684\u65E5\u5FD7\u8F93\u51FA\u7EA7\u522B\u4E3A2\uFF0C<code>module2</code>\u5305\u4E2D\u7684\u65E5\u5FD7\u8F93\u51FA\u7EA7\u522B\u4E3A3\u3002\u8FD9\u6837\uFF0C\u5C31\u53EF\u4EE5\u66F4\u52A0\u7075\u6D3B\u5730\u63A7\u5236\u65E5\u5FD7\u7684\u8F93\u51FA\u7EA7\u522B\uFF0C\u4EE5\u9002\u5E94\u4E0D\u540C\u7684\u5E94\u7528\u573A\u666F\u3002</p></blockquote><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// V level\u4F7F\u7528</span>
log<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;This is a V level message&quot;</span><span class="token punctuation">)</span>
log<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Infof</span><span class="token punctuation">(</span><span class="token string">&quot;This is a %s V level message&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;formatted&quot;</span><span class="token punctuation">)</span>
log<span class="token punctuation">.</span><span class="token function">V</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Infow</span><span class="token punctuation">(</span><span class="token string">&quot;This is a V level message with fields&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;X-Request-ID&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;7a7b9f24-4cae-4b2a-9464-69088b45b904&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u91CC\u8981\u6CE8\u610F\uFF0CLog.V\u53EA\u652F\u6301 <code>Info</code> \u3001<code>Infof</code> \u3001<code>Infow</code>\u4E09\u79CD\u65E5\u5FD7\u8BB0\u5F55\u65B9\u6CD5\u3002</p><p><strong>\u7B2C\u4E8C\u4E2A\u65B9\u6CD5\uFF0C</strong> log\u5305\u652F\u6301WithValues\u51FD\u6570\uFF0C\u4F8B\u5982\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// WithValues\u4F7F\u7528</span>
lv <span class="token operator">:=</span> log<span class="token punctuation">.</span><span class="token function">WithValues</span><span class="token punctuation">(</span><span class="token string">&quot;X-Request-ID&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;7a7b9f24-4cae-4b2a-9464-69088b45b904&quot;</span><span class="token punctuation">)</span>
lv<span class="token punctuation">.</span><span class="token function">Infow</span><span class="token punctuation">(</span><span class="token string">&quot;Info message printed with [WithValues] logger&quot;</span><span class="token punctuation">)</span>
lv<span class="token punctuation">.</span><span class="token function">Infow</span><span class="token punctuation">(</span><span class="token string">&quot;Debug message printed with [WithValues] logger&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u4E0A\u8FF0\u65E5\u5FD7\u8F93\u51FA\u5982\u4E0B\uFF1A</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">2021</span>-07-06 <span class="token number">14</span>:15:28.555 INFO Info message printed with <span class="token punctuation">[</span>WithValues<span class="token punctuation">]</span> logger <span class="token punctuation">{</span><span class="token string">&quot;X-Request-ID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;7a7b9f24-4cae-4b2a-9464-69088b45b904&quot;</span><span class="token punctuation">}</span>
<span class="token number">2021</span>-07-06 <span class="token number">14</span>:15:28.556 INFO Debug message printed with <span class="token punctuation">[</span>WithValues<span class="token punctuation">]</span> logger <span class="token punctuation">{</span><span class="token string">&quot;X-Request-ID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;7a7b9f24-4cae-4b2a-9464-69088b45b904&quot;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><code>WithValues</code> \u53EF\u4EE5\u8FD4\u56DE\u4E00\u4E2A\u643A\u5E26\u6307\u5B9Akey-value\u7684Logger\uFF0C\u4F9B\u540E\u9762\u4F7F\u7528\u3002</p><p><strong>\u7B2C\u4E09\u4E2A\u65B9\u6CD5\uFF0C</strong> log\u5305\u63D0\u4F9B <code>WithContext</code> \u548C <code>FromContext</code> \u7528\u6765\u5C06\u6307\u5B9A\u7684Logger\u6DFB\u52A0\u5230\u67D0\u4E2AContext\u4E2D\uFF0C\u4EE5\u53CA\u4ECE\u67D0\u4E2AContext\u4E2D\u83B7\u53D6Logger\uFF0C\u4F8B\u5982\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// Context\u4F7F\u7528</span>
ctx <span class="token operator">:=</span> lv<span class="token punctuation">.</span><span class="token function">WithContext</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
lc <span class="token operator">:=</span> log<span class="token punctuation">.</span><span class="token function">FromContext</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
lc<span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;Message printed with [WithContext] logger&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>WithContext</code>\u548C<code>FromContext</code>\u975E\u5E38\u9002\u5408\u7528\u5728\u4EE5<code>context.Context</code>\u4F20\u9012\u7684\u51FD\u6570\u4E2D\uFF0C\u4F8B\u5982\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 
    <span class="token operator">...</span>
 
    <span class="token comment">// WithValues\u4F7F\u7528</span>
    lv <span class="token operator">:=</span> log<span class="token punctuation">.</span><span class="token function">WithValues</span><span class="token punctuation">(</span><span class="token string">&quot;X-Request-ID&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;7a7b9f24-4cae-4b2a-9464-69088b45b904&quot;</span><span class="token punctuation">)</span>
     
    <span class="token comment">// Context\u4F7F\u7528</span>
    lv<span class="token punctuation">.</span><span class="token function">Infof</span><span class="token punctuation">(</span><span class="token string">&quot;Start to call pirntString&quot;</span><span class="token punctuation">)</span>
    ctx <span class="token operator">:=</span> lv<span class="token punctuation">.</span><span class="token function">WithContext</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">Background</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token function">pirntString</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> <span class="token string">&quot;World&quot;</span><span class="token punctuation">)</span>  
<span class="token punctuation">}</span>
 
<span class="token keyword">func</span> <span class="token function">pirntString</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">,</span> str <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    lc <span class="token operator">:=</span> log<span class="token punctuation">.</span><span class="token function">FromContext</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
    lc<span class="token punctuation">.</span><span class="token function">Infof</span><span class="token punctuation">(</span><span class="token string">&quot;Hello %s&quot;</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u8FF0\u4EE3\u7801\u8F93\u51FA\u5982\u4E0B\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>2021-07-06 14:38:02.050 INFO Start to call pirntString {&quot;X-Request-ID&quot;: &quot;7a7b9f24-4cae-4b2a-9464-69088b45b904&quot;}
2021-07-06 14:38:02.050 INFO Hello World {&quot;X-Request-ID&quot;: &quot;7a7b9f24-4cae-4b2a-9464-69088b45b904&quot;}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5C06Logger\u6DFB\u52A0\u5230Context\u4E2D\uFF0C\u5E76\u901A\u8FC7Context\u5728\u4E0D\u540C\u51FD\u6570\u95F4\u4F20\u9012\uFF0C\u53EF\u4EE5\u4F7Fkey-value\u5728\u4E0D\u540C\u51FD\u6570\u95F4\u4F20\u9012\u3002\u4F8B\u5982\u4E0A\u8FF0\u4EE3\u7801\u4E2D\uFF0C <code>X-Request-ID</code> \u5728main\u51FD\u6570\u3001printString\u51FD\u6570\u4E2D\u7684\u65E5\u5FD7\u8F93\u51FA\u4E2D\u5747\u6709\u8BB0\u5F55\uFF0C\u4ECE\u800C\u5B9E\u73B0\u4E86\u4E00\u79CD\u8C03\u7528\u94FE\u7684\u6548\u679C\u3002</p>`,20),Ls=n("strong",null,"\u7B2C\u56DB\u4E2A\u65B9\u6CD5\uFF0C",-1),ws=s(" \u53EF\u4EE5\u5F88\u65B9\u4FBF\u5730\u4ECEContext\u4E2D\u63D0\u53D6\u51FA\u6307\u5B9A\u7684key-value\uFF0C\u4F5C\u4E3A\u4E0A\u4E0B\u6587\u6DFB\u52A0\u5230\u65E5\u5FD7\u8F93\u51FA\u4E2D\uFF0C\u4F8B\u5982 "),Is={href:"https://github.com/marmotedu/iam/blob/v1.0.0/internal/apiserver/api/v1/user/create.go#L20",target:"_blank",rel:"noopener noreferrer"},Fs=s("internal/apiserver/api/v1/user/create.go"),Es=s("\u6587\u4EF6\u4E2D\u7684\u65E5\u5FD7\u8C03\u7528\uFF1A"),zs=p(`<div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// Info logs a message at level Info on the compatibleLogger.</span>
log<span class="token punctuation">.</span><span class="token function">L</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;user create function called.&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u901A\u8FC7\u8C03\u7528 <code>Log.L()</code> \u51FD\u6570\uFF0C\u5B9E\u73B0\u5982\u4E0B\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>
<span class="token comment">// L method output with specified context value.</span>
<span class="token keyword">func</span> <span class="token function">L</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token operator">*</span>zapLogger <span class="token punctuation">{</span>
    <span class="token keyword">return</span> std<span class="token punctuation">.</span><span class="token function">L</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">func</span> <span class="token punctuation">(</span>l <span class="token operator">*</span>zapLogger<span class="token punctuation">)</span> <span class="token function">L</span><span class="token punctuation">(</span>ctx context<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token operator">*</span>zapLogger <span class="token punctuation">{</span>
    lg <span class="token operator">:=</span> l<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
    requestID<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">Value</span><span class="token punctuation">(</span>KeyRequestID<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span>
    username<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> ctx<span class="token punctuation">.</span><span class="token function">Value</span><span class="token punctuation">(</span>KeyUsername<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token punctuation">)</span>
    lg<span class="token punctuation">.</span>zapLogger <span class="token operator">=</span> lg<span class="token punctuation">.</span>zapLogger<span class="token punctuation">.</span><span class="token function">With</span><span class="token punctuation">(</span>zap<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span>KeyRequestID<span class="token punctuation">,</span> requestID<span class="token punctuation">)</span><span class="token punctuation">,</span> zap<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span>KeyUsername<span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
    <span class="token keyword">return</span> lg
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>L()</code> \u65B9\u6CD5\u4F1A\u4ECE\u4F20\u5165\u7684Context\u4E2D\u63D0\u53D6\u51FA <code>requestID</code> \u548C <code>username</code> \uFF0C\u8FFD\u52A0\u5230Logger\u4E2D\uFF0C\u5E76\u8FD4\u56DELogger\u3002\u8FD9\u65F6\u5019\u8C03\u7528\u8BE5Logger\u7684Info\u3001Infof\u3001Infow\u7B49\u65B9\u6CD5\u8BB0\u5F55\u65E5\u5FD7\uFF0C\u8F93\u51FA\u7684\u65E5\u5FD7\u4E2D\u5747\u5305\u542B <code>requestID</code> \u548C <code>username</code> \u5B57\u6BB5\uFF0C\u4F8B\u5982\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token number">2021</span>-07-06 <span class="token number">14</span>:46:00.743 INFO    apiserver       secret/create.go:23     create secret <span class="token keyword">function</span> called.  <span class="token punctuation">{</span><span class="token string">&quot;requestID&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;73144bed-534d-4f68-8e8d-dc8a8ed48507&quot;</span>, <span class="token string">&quot;username&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u901A\u8FC7\u5C06Context\u5728\u51FD\u6570\u95F4\u4F20\u9012\uFF0C\u5F88\u5BB9\u6613\u5C31\u80FD\u5B9E\u73B0\u8C03\u7528\u94FE\u6548\u679C\uFF0C\u4F8B\u5982\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// Create add new secret key pairs to the storage.</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>s <span class="token operator">*</span>SecretHandler<span class="token punctuation">)</span> <span class="token function">Create</span><span class="token punctuation">(</span>c <span class="token operator">*</span>gin<span class="token punctuation">.</span>Context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">L</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Info</span><span class="token punctuation">(</span><span class="token string">&quot;create secret function called.&quot;</span><span class="token punctuation">)</span>
     
    <span class="token operator">...</span>
     
    secrets<span class="token punctuation">,</span> err <span class="token operator">:=</span> s<span class="token punctuation">.</span>srv<span class="token punctuation">.</span><span class="token function">Secrets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">List</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> username<span class="token punctuation">,</span> metav1<span class="token punctuation">.</span>ListOptions<span class="token punctuation">{</span>    
        Offset<span class="token punctuation">:</span> pointer<span class="token punctuation">.</span><span class="token function">ToInt64</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        Limit<span class="token punctuation">:</span>  pointer<span class="token punctuation">.</span><span class="token function">ToInt64</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
     
    <span class="token operator">...</span>
     
     <span class="token keyword">if</span> err <span class="token operator">:=</span> s<span class="token punctuation">.</span>srv<span class="token punctuation">.</span><span class="token function">Secrets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token operator">&amp;</span>r<span class="token punctuation">,</span> metav1<span class="token punctuation">.</span>CreateOptions<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
        core<span class="token punctuation">.</span><span class="token function">WriteResponse</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> err<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
 
    core<span class="token punctuation">.</span><span class="token function">WriteResponse</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u8FF0\u4EE3\u7801\u8F93\u51FA\u4E3A\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token number">2021</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">06</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">46</span><span class="token punctuation">:</span><span class="token number">00.743</span> INFO    apiserver       secret<span class="token operator">/</span>create<span class="token punctuation">.</span><span class="token keyword">go</span><span class="token punctuation">:</span><span class="token number">23</span>     create secret function called<span class="token punctuation">.</span>  <span class="token punctuation">{</span><span class="token string">&quot;requestID&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;73144bed-534d-4f68-8e8d-dc8a8ed48507&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">}</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">06</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">46</span><span class="token punctuation">:</span><span class="token number">00.744</span> INFO    apiserver       secret<span class="token operator">/</span>create<span class="token punctuation">.</span><span class="token keyword">go</span><span class="token punctuation">:</span><span class="token number">23</span>     list secret from storage<span class="token punctuation">.</span>  <span class="token punctuation">{</span><span class="token string">&quot;requestID&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;73144bed-534d-4f68-8e8d-dc8a8ed48507&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">}</span>
<span class="token number">2021</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">06</span> <span class="token number">14</span><span class="token punctuation">:</span><span class="token number">46</span><span class="token punctuation">:</span><span class="token number">00.745</span> INFO    apiserver       secret<span class="token operator">/</span>create<span class="token punctuation">.</span><span class="token keyword">go</span><span class="token punctuation">:</span><span class="token number">23</span>     insert secret to storage<span class="token punctuation">.</span>  <span class="token punctuation">{</span><span class="token string">&quot;requestID&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;73144bed-534d-4f68-8e8d-dc8a8ed48507&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;username&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u91CC\u8981\u6CE8\u610F\uFF0C <code>log.L</code> \u51FD\u6570\u9ED8\u8BA4\u4F1A\u4ECEContext\u4E2D\u53D6 <code>requestID</code> \u548C <code>username</code> \u952E\uFF0C\u8FD9\u8DDFIAM\u9879\u76EE\u6709\u8026\u5408\u5EA6\uFF0C\u4F46\u8FD9\u4E0D\u5F71\u54CD<code>log</code>\u5305\u4F9B\u7B2C\u4E09\u65B9\u9879\u76EE\u4F7F\u7528\u3002\u8FD9\u4E5F\u662F\u6211\u5EFA\u8BAE\u4F60\u81EA\u5DF1\u5C01\u88C5\u65E5\u5FD7\u5305\u7684\u539F\u56E0\u3002</p><h3 id="\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u603B\u7ED3" aria-hidden="true">#</a> \u603B\u7ED3</h3><p>\u5F00\u53D1\u4E00\u4E2A\u65E5\u5FD7\u5305\uFF0C\u6211\u4EEC\u5F88\u591A\u65F6\u5019\u9700\u8981\u57FA\u4E8E\u4E00\u4E9B\u4E1A\u754C\u4F18\u79C0\u7684\u5F00\u6E90\u65E5\u5FD7\u5305\u8FDB\u884C\u4E8C\u6B21\u5F00\u53D1\u3002\u5F53\u524D\u5F88\u591A\u9879\u76EE\u7684\u65E5\u5FD7\u5305\u90FD\u662F\u57FA\u4E8E<code>zap</code>\u65E5\u5FD7\u5305\u6765\u5C01\u88C5\u7684\uFF0C\u5982\u679C\u4F60\u6709\u5C01\u88C5\u7684\u9700\u8981\uFF0C\u6211\u5EFA\u8BAE\u4F60\u4F18\u5148\u9009\u62E9zap\u65E5\u5FD7\u5305\u3002</p><p>\u8FD9\u4E00\u8BB2\u4E2D\uFF0C\u6211\u5148\u7ED9\u4F60\u4ECB\u7ECD\u4E86\u6807\u51C6\u5E93log\u5305\u3001glog\u3001logrus\u548Czap\u8FD9\u56DB\u79CD\u5E38\u7528\u7684\u65E5\u5FD7\u5305\uFF0C\u7136\u540E\u5411\u4F60\u5C55\u73B0\u4E86\u5F00\u53D1\u4E00\u4E2A\u65E5\u5FD7\u5305\u7684\u56DB\u4E2A\u6B65\u9AA4\uFF0C\u6B65\u9AA4\u5982\u4E0B\uFF1A</p><ol><li>\u5B9A\u4E49\u65E5\u5FD7\u7EA7\u522B\u548C\u65E5\u5FD7\u9009\u9879\u3002</li><li>\u521B\u5EFALogger\u53CA\u5404\u7EA7\u522B\u65E5\u5FD7\u6253\u5370\u65B9\u6CD5\u3002</li><li>\u5C06\u65E5\u5FD7\u8F93\u51FA\u5230\u652F\u6301\u7684\u8F93\u51FA\u4E2D\u3002</li><li>\u81EA\u5B9A\u4E49\u65E5\u5FD7\u8F93\u51FA\u683C\u5F0F\u3002</li></ol><p>\u6700\u540E\uFF0C\u6211\u4ECB\u7ECD\u4E86IAM\u9879\u76EE\u5C01\u88C5\u7684log\u5305\u7684\u8BBE\u8BA1\u548C\u4F7F\u7528\u65B9\u5F0F\u3002log\u5305\u57FA\u4E8E <code>go.uber.org/zap</code>\u5C01\u88C5\uFF0C\u5E76\u63D0\u4F9B\u4E86\u4EE5\u4E0B\u5F3A\u5927\u7279\u6027\uFF1A</p><ul><li>log\u5305\u652F\u6301V Level\uFF0C\u53EF\u4EE5\u7075\u6D3B\u7684\u901A\u8FC7\u6574\u578B\u6570\u503C\u6765\u6307\u5B9A\u65E5\u5FD7\u7EA7\u522B\u3002</li><li>log\u5305\u652F\u6301 <code>WithValues</code> \u51FD\u6570\uFF0C <code>WithValues</code> \u53EF\u4EE5\u8FD4\u56DE\u4E00\u4E2A\u643A\u5E26\u6307\u5B9Akey-value\u5BF9\u7684Logger\uFF0C\u4F9B\u540E\u9762\u4F7F\u7528\u3002</li><li>log\u5305\u63D0\u4F9B <code>WithContext</code> \u548C <code>FromContext</code> \u7528\u6765\u5C06\u6307\u5B9A\u7684Logger\u6DFB\u52A0\u5230\u67D0\u4E2AContext\u4E2D\u548C\u4ECE\u67D0\u4E2AContext\u4E2D\u83B7\u53D6Logger\u3002</li><li>log\u5305\u63D0\u4F9B\u4E86 <code>Log.L()</code> \u51FD\u6570\uFF0C\u53EF\u4EE5\u5F88\u65B9\u4FBF\u7684\u4ECEContext\u4E2D\u63D0\u53D6\u51FA\u6307\u5B9A\u7684key-value\u5BF9\uFF0C\u4F5C\u4E3A\u4E0A\u4E0B\u6587\u6DFB\u52A0\u5230\u65E5\u5FD7\u8F93\u51FA\u4E2D\u3002</li></ul><h3 id="\u8BFE\u540E\u7EC3\u4E60" tabindex="-1"><a class="header-anchor" href="#\u8BFE\u540E\u7EC3\u4E60" aria-hidden="true">#</a> \u8BFE\u540E\u7EC3\u4E60</h3>`,17),Cs=n("li",null,[s("\u5C1D\u8BD5\u5B9E\u73B0\u4E00\u4E2A\u65B0\u7684Formatter\uFF0C\u53EF\u4EE5\u4F7F\u4E0D\u540C\u65E5\u5FD7\u7EA7\u522B\u4EE5\u4E0D\u540C\u989C\u8272\u8F93\u51FA\uFF08\u4F8B\u5982\uFF1AError\u7EA7\u522B\u7684\u65E5\u5FD7\u8F93\u51FA\u4E2D "),n("code",null,"Error"),s(" \u5B57\u7B26\u4E32\u7528\u7EA2\u8272\u5B57\u4F53\u8F93\u51FA\uFF0C "),n("code",null,"Info"),s(" \u5B57\u7B26\u4E32\u7528\u767D\u8272\u5B57\u4F53\u8F93\u51FA\uFF09\u3002")],-1),Ns=s("\u5C1D\u8BD5\u5C06"),Ss={href:"https://github.com/marmotedu/gopractise-demo/blob/master/log/cuslog/entry.go#L36",target:"_blank",rel:"noopener noreferrer"},Ds=s("runtime.Caller(2)"),Os=s("\u51FD\u6570\u8C03\u7528\u4E2D\u7684 "),Ws=n("code",null,"2",-1),Ps=s(" \u6539\u6210 "),Ts=n("code",null,"1",-1),Rs=s(" \uFF0C\u770B\u770B\u65E5\u5FD7\u8F93\u51FA\u662F\u5426\u8DDF\u4FEE\u6539\u524D\u6709\u5DEE\u5F02\uFF0C\u5982\u679C\u6709\u5DEE\u5F02\uFF0C\u601D\u8003\u5DEE\u5F02\u4EA7\u751F\u7684\u539F\u56E0\u3002"),Vs=n("h2",{id:"end-\u94FE\u63A5",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#end-\u94FE\u63A5","aria-hidden":"true"},"#"),s(" END \u94FE\u63A5")],-1),As=n("ul",null,[n("li",null,[n("div",null,[n("a",{href:"12.md",style:{float:"left"}},"\u2B06\uFE0F\u4E0A\u4E00\u8282\u{1F517} "),n("a",{href:"14.md",style:{float:"right"}}," \uFE0F\u4E0B\u4E00\u8282\u{1F517}")])])],-1),js=s("\u24C2\uFE0F\u56DE\u5230\u76EE\u5F55\u{1F3E0}"),Ks={href:"https://nsddd.top/archives/contributors",target:"_blank",rel:"noopener noreferrer"},Gs=n("strong",null,"\u{1FAF5}\u53C2\u4E0E\u8D21\u732E\u{1F49E}\u2764\uFE0F\u200D\u{1F525}\u{1F496}",-1),Ms=s(")"),Xs=s("\u2734\uFE0F\u7248\u6743\u58F0\u660E \xA9 \uFF1A\u672C\u4E66\u6240\u6709\u5185\u5BB9\u9075\u5FAA"),Bs={href:"http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC",target:"_blank",rel:"noopener noreferrer"},Us=s("CC-BY-SA 3.0\u534F\u8BAE\uFF08\u7F72\u540D-\u76F8\u540C\u65B9\u5F0F\u5171\u4EAB\uFF09\xA9");function Hs(Js,$s){const e=l("ExternalLinkIcon"),o=l("router-link"),i=l("RouterLink");return u(),r("div",null,[n("ul",null,[n("li",null,[n("a",k,[g,a(e)])])]),v,m,b,q,n("blockquote",null,[n("p",null,[f,n("a",h,[_,a(e)])])]),y,n("nav",x,[n("ul",null,[n("li",null,[a(o,{to:"#\u4F18\u79C0\u7684\u5F00\u6E90\u65E5\u5FD7\u5305"},{default:t(()=>[L]),_:1})]),n("li",null,[a(o,{to:"#\u6807\u51C6\u5E93log\u5305\u4F7F\u7528"},{default:t(()=>[w]),_:1})]),n("li",null,[a(o,{to:"#glog"},{default:t(()=>[I]),_:1})]),n("li",null,[a(o,{to:"#logrus\u4ECB\u7ECD"},{default:t(()=>[F]),_:1})]),n("li",null,[a(o,{to:"#zap\u5305\u4ECB\u7ECD"},{default:t(()=>[E]),_:1}),n("ul",null,[n("li",null,[a(o,{to:"#zap\u4F7F\u7528\u65B9\u6CD5"},{default:t(()=>[z]),_:1})])])]),n("li",null,[a(o,{to:"#\u5176\u5B83\u5F00\u6E90\u5305"},{default:t(()=>[C]),_:1})]),n("li",null,[a(o,{to:"#\u5F00\u6E90\u65E5\u5FD7\u5305\u9009\u62E9"},{default:t(()=>[N]),_:1})]),n("li",null,[a(o,{to:"#\u4ECE0\u7F16\u5199\u4E00\u4E2A\u65E5\u5FD7\u5305"},{default:t(()=>[S]),_:1}),n("ul",null,[n("li",null,[a(o,{to:"#\u5B9A\u4E49\u65E5\u5FD7\u7EA7\u522B\u548C\u65E5\u5FD7\u9009\u9879"},{default:t(()=>[D]),_:1})]),n("li",null,[a(o,{to:"#\u521B\u5EFAlogger\u53CA\u5404\u7EA7\u522B\u65E5\u5FD7\u6253\u5370\u65B9\u6CD5"},{default:t(()=>[O]),_:1})]),n("li",null,[a(o,{to:"#\u5C06\u65E5\u5FD7\u8F93\u51FA\u5230\u652F\u6301\u7684\u8F93\u51FA\u4E2D"},{default:t(()=>[W]),_:1})]),n("li",null,[a(o,{to:"#\u81EA\u5B9A\u4E49\u65E5\u5FD7\u8F93\u51FA\u683C\u5F0F"},{default:t(()=>[P]),_:1})]),n("li",null,[a(o,{to:"#\u6D4B\u8BD5\u65E5\u5FD7\u5305"},{default:t(()=>[T]),_:1})]),n("li",null,[a(o,{to:"#iam\u9879\u76EE\u65E5\u5FD7\u5305\u8BBE\u8BA1"},{default:t(()=>[R]),_:1})]),n("li",null,[a(o,{to:"#\u603B\u7ED3"},{default:t(()=>[V]),_:1})]),n("li",null,[a(o,{to:"#\u8BFE\u540E\u7EC3\u4E60"},{default:t(()=>[A]),_:1})])])]),n("li",null,[a(o,{to:"#end-\u94FE\u63A5"},{default:t(()=>[j]),_:1})])])]),K,n("p",null,[n("a",G,[M,a(e)]),X]),B,n("p",null,[n("a",U,[H,a(e)]),J,$,Y,Q,Z]),nn,n("p",null,[n("a",sn,[an,a(e)]),en]),tn,n("ul",null,[on,pn,ln,n("li",null,[cn,un,n("a",rn,[dn,a(e)]),kn])]),gn,n("p",null,[vn,mn,bn,n("a",qn,[fn,a(e)]),hn]),_n,yn,xn,n("p",null,[Ln,n("a",wn,[In,a(e)]),Fn]),En,n("p",null,[zn,n("a",Cn,[Nn,a(e)]),Sn]),Dn,n("p",null,[On,n("a",Wn,[Pn,a(e)]),Tn]),Rn,Vn,n("p",null,[An,jn,Kn,n("a",Gn,[Mn,a(e)]),Xn]),Bn,n("p",null,[Un,n("a",Hn,[Jn,a(e)]),$n,n("a",Yn,[Qn,a(e)]),Zn]),ns,n("p",null,[ss,n("a",as,[es,a(e)]),ts]),os,ps,n("p",null,[ls,n("a",is,[cs,a(e)]),us]),rs,n("p",null,[ds,ks,gs,n("a",vs,[ms,a(e)]),bs]),qs,n("p",null,[fs,n("a",hs,[_s,a(e)]),ys]),xs,n("p",null,[Ls,ws,n("a",Is,[Fs,a(e)]),Es]),zs,n("ol",null,[Cs,n("li",null,[Ns,n("a",Ss,[Ds,a(e)]),Os,Ws,Ps,Ts,Rs])]),Vs,As,n("ul",null,[n("li",null,[n("p",null,[a(i,{to:"/projects/"},{default:t(()=>[js]),_:1})])]),n("li",null,[n("p",null,[n("a",Ks,[Gs,a(e)]),Ms])]),n("li",null,[n("p",null,[Xs,n("a",Bs,[Us,a(e)])])])])])}const Qs=c(d,[["render",Hs],["__file","13.html.vue"]]);export{Qs as default};
