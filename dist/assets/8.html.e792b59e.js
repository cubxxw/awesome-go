import{_ as c,r as i,o as r,c as d,a as s,b as n,w as e,e as a,d as l}from"./app.798d5e9d.js";const u={},m={href:"https://github.com/cubxxw/iam",target:"_blank",rel:"noopener noreferrer"},k=a("\u{1F525} \u5F00\u6E90\u5730\u5740"),v=s("h1",{id:"\u7B2C8\u8282-iam-\u9879\u76EE\u5982\u4F55\u8FDB\u884C\u7814\u53D1\u6D41\u7A0B\u7BA1\u7406",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#\u7B2C8\u8282-iam-\u9879\u76EE\u5982\u4F55\u8FDB\u884C\u7814\u53D1\u6D41\u7A0B\u7BA1\u7406","aria-hidden":"true"},"#"),a(" \u7B2C8\u8282 IAM \u9879\u76EE\u5982\u4F55\u8FDB\u884C\u7814\u53D1\u6D41\u7A0B\u7BA1\u7406")],-1),h=s("br",null,null,-1),g=s("div",null,[s("a",{href:"7.md",style:{float:"left"}},"\u2B06\uFE0F\u4E0A\u4E00\u8282\u{1F517} "),s("a",{href:"9.md",style:{float:"right"}}," \u2B07\uFE0F\u4E0B\u4E00\u8282\u{1F517}")],-1),b=s("br",null,null,-1),f=a("\u2764\uFE0F\u{1F495}\u{1F495}During the winter vacation, I followed up and learned two projects: tiktok project and IAM project, and summarized and practiced the CloudNative project and Go language. I learned a lot in the process.Myblog:"),_={href:"http://nsddd.top/",target:"_blank",rel:"noopener noreferrer"},x=a("http://nsddd.top"),w=s("hr",null,null,-1),C={class:"table-of-contents"},y=a("\u5F00\u59CB"),A=a("\u7B2C\u4E00\u6B65\uFF1A\u65B0\u5EFA\u5206\u652F"),E=a("\u7B2C\u4E8C\u6B65\uFF0C\u6DFB\u52A0\u81EA\u52A8\u5316\u547D\u4EE4"),G=a("\u7B2C\u4E09\u6B65\uFF0C\u751F\u6210\u4EE3\u7801"),I=a("\u7B2C\u56DB\u6B65\uFF0C\u7248\u6743\u68C0\u67E5"),$=a("\u5982\u4F55\u5B89\u88C5 addlicense\uFF1F"),M=a("\u5982\u4F55\u4F7F\u7528 addlicense\uFF1F"),q=a("\u652F\u6301\u7684\u8BB8\u53EF\u8BC1\u7C7B\u578B"),N=a("\u7B2C\u4E94\u6B65\uFF0C\u4EE3\u7801\u683C\u5F0F\u5316"),O=a("\u7B2C\u516D\u6B65\uFF0C\u9759\u6001\u4EE3\u7801\u68C0\u67E5"),H=a("\u7B2C\u4E03\u6B65\uFF0C\u5355\u5143\u6D4B\u8BD5"),S=a("\u7B2C\u516B\u6B65\uFF0C\u6784\u5EFA"),L=a("\u4EE3\u7801\u63D0\u4EA4"),R=a("Github Action \u914D\u7F6E"),T=a("\u6D4B\u8BD5\u9636\u6BB5"),V=a("IAM \u9879\u76EE\u7684 Makefile \u9879\u76EE\u7BA1\u7406\u6280\u5DE7"),D=a("help \u81EA\u52A8\u89E3\u6790"),B=a("Options \u4E2D\u6307\u5B9A\u53D8\u91CF\u503C"),j=a("\u81EA\u52A8\u751F\u6210 CHANGELOG"),P=a("\u81EA\u52A8\u751F\u6210\u7248\u672C\u53F7"),z=a("\u4FDD\u6301\u884C\u4E3A\u4E00\u81F4"),F=a("\u603B\u7ED3"),Y=a("END \u94FE\u63A5"),U=l(`<p>[TOC]</p><h2 id="\u5F00\u59CB" tabindex="-1"><a class="header-anchor" href="#\u5F00\u59CB" aria-hidden="true">#</a> \u5F00\u59CB</h2><p><strong>\u5F00\u53D1\u9636\u6BB5\u4E3B\u8981\u8981\u505A\u7684\u4E24\u4EF6\u4E8B\u60C5\u5206\u522B\u662F\u4EE3\u7801\u5F00\u53D1\u548C\u4EE3\u7801\u63D0\u4EA4\u4E24\u4E2A\u90E8\u5206\u3002</strong></p><p>\u62FF\u5230\u9700\u6C42\u4E4B\u540E\uFF0C\u9996\u5148\u9700\u8981\u5F00\u53D1\u4EE3\u7801\u3002\u8FD9\u65F6\uFF0C\u6211\u4EEC\u5C31\u9700\u8981\u9009\u62E9\u4E00\u4E2A\u9002\u5408\u56E2\u961F\u548C\u9879\u76EE\u7684 Git \u5DE5\u4F5C\u6D41\u3002\u56E0\u4E3A Git Flow \u5DE5\u4F5C\u6D41\u6BD4\u8F83\u9002\u5408\u5927\u578B\u7684\u975E\u5F00\u6E90\u9879\u76EE\uFF0C\u6240\u4EE5\u8FD9\u91CC\u6211\u4EEC\u9009\u62E9 Git Flow \u5DE5\u4F5C\u6D41\u3002\u4EE3\u7801\u5F00\u53D1\u7684\u5177\u4F53\u6B65\u9AA4\u5982\u4E0B\uFF1A</p><h2 id="\u7B2C\u4E00\u6B65-\u65B0\u5EFA\u5206\u652F" tabindex="-1"><a class="header-anchor" href="#\u7B2C\u4E00\u6B65-\u65B0\u5EFA\u5206\u652F" aria-hidden="true">#</a> \u7B2C\u4E00\u6B65\uFF1A\u65B0\u5EFA\u5206\u652F</h2><p><strong>\u57FA\u4E8E develop \u65B0\u5EFA\u4E00\u4E2A\u5206\u652F <code>feature/helloworld</code></strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">git</span> checkout <span class="token parameter variable">-b</span> feature/helloworld develop
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u26A0\uFE0F <strong>\u8FD9\u91CC\u9700\u8981\u6CE8\u610F</strong>\uFF1A\u65B0\u5EFA\u7684 branch \u540D\u8981\u7B26\u5408 Git Flow \u5DE5\u4F5C\u6D41\u4E2D\u7684\u5206\u652F\u547D\u540D\u89C4\u5219\u3002\u5426\u5219\uFF0C\u5728 git commit \u9636\u6BB5\uFF0C\u4F1A\u56E0\u4E3A <code>branch</code> \u4E0D\u89C4\u8303\u5BFC\u81F4 <code>commit</code> \u5931\u8D25\u3002IAM \u9879\u76EE\u7684\u5206\u652F\u547D\u4EE4\u89C4\u5219\u5177\u4F53\u5982\u4E0B\u56FE\u6240\u793A\uFF1A</p><p><img src="http://sm.nsddd.top/sm202302200959749.png" alt="image-20230220095937613"></p><blockquote><p>IAM \u9879\u76EE\u901A\u8FC7 <code>pre-commit githooks</code> \u6765\u786E\u4FDD\u5206\u652F\u540D\u662F\u7B26\u5408\u89C4\u8303\u7684\u3002\u5728 IAM \u9879\u76EE\u6839\u76EE\u5F55\u4E0B\u6267\u884C <code>git commit</code> \u547D\u4EE4\uFF0Cgit \u4F1A\u81EA\u52A8\u6267\u884C<code>pre-commit</code>\u811A\u672C\uFF0C\u8BE5\u811A\u672C\u4F1A\u68C0\u67E5\u5F53\u524D branch \u7684\u540D\u5B57\u662F\u5426\u7B26\u5408\u89C4\u8303\u3002</p></blockquote><p>\u8FD9\u91CC\u8FD8\u6709\u4E00\u4E2A\u5730\u65B9\u9700\u8981\u4F60\u6CE8\u610F\uFF1Agit \u4E0D\u4F1A\u63D0\u4EA4 <code>.git/hooks</code> \u76EE\u5F55\u4E0B\u7684 <code>githooks</code> \u811A\u672C\uFF0C\u6240\u4EE5\u6211\u4EEC\u9700\u8981\u901A\u8FC7\u4EE5\u4E0B\u624B\u6BB5\uFF0C\u786E\u4FDD\u5F00\u53D1\u8005 clone \u4ED3\u5E93\u4E4B\u540E\uFF0C\u4ECD\u7136\u80FD\u5B89\u88C5\u6211\u4EEC\u6307\u5B9A\u7684 githooks \u811A\u672C\u5230 <code>.git/hooks</code> \u76EE\u5F55\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># Copy githook scripts when execute makefile    </span>
COPY_GITHOOK:<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>shell <span class="token function">cp</span> <span class="token parameter variable">-f</span> githooks/* .git/hooks/<span class="token variable">)</span></span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u8FF0\u4EE3\u7801\u653E\u5728<code>scripts/make-rules/common.mk</code>\u6587\u4EF6\u4E2D\uFF0C\u6BCF\u6B21\u6267\u884C make \u547D\u4EE4\u65F6\u90FD\u4F1A\u6267\u884C\uFF0C\u53EF\u4EE5\u786E\u4FDD <code>githooks</code> \u90FD\u5B89\u88C5\u5230 <code>.git/hooks</code>\u76EE\u5F55\u4E0B\u3002</p><h2 id="\u7B2C\u4E8C\u6B65-\u6DFB\u52A0\u81EA\u52A8\u5316\u547D\u4EE4" tabindex="-1"><a class="header-anchor" href="#\u7B2C\u4E8C\u6B65-\u6DFB\u52A0\u81EA\u52A8\u5316\u547D\u4EE4" aria-hidden="true">#</a> \u7B2C\u4E8C\u6B65\uFF0C\u6DFB\u52A0\u81EA\u52A8\u5316\u547D\u4EE4</h2><p><strong>\u5728 <code>feature/helloworld</code> \u5206\u652F\u4E2D\uFF0C\u5B8C\u6210 <code>helloworld</code> \u547D\u4EE4\u7684\u6DFB\u52A0\u3002</strong></p><p>\u9996\u5148\uFF0C\u901A\u8FC7 iamctl new helloworld \u547D\u4EE4\u521B\u5EFA helloworld \u547D\u4EE4\u6A21\u677F\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ iamctl new helloworld <span class="token parameter variable">-d</span> internal/iamctl/cmd/helloworld
Command <span class="token function">file</span> generated: internal/iamctl/cmd/helloworld/helloworld.go
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u63A5\u7740\uFF0C\u7F16\u8F91<code>internal/iamctl/cmd/cmd.go</code>\u6587\u4EF6\uFF0C\u5728\u6E90\u7801\u6587\u4EF6\u4E2D\u6DFB\u52A0<code>helloworld.NewCmdHelloworld(f, ioStreams</code>),\u52A0\u8F7D <code>helloworld</code> \u547D\u4EE4\u3002\u8FD9\u91CC\u5C06 helloworld \u547D\u4EE4\u8BBE\u7F6E\u4E3ATroubleshooting and Debugging Commands\u547D\u4EE4\u5206\u7EC4\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;github.com/marmotedu/iam/internal/iamctl/cmd/helloworld&quot;</span>
<span class="token punctuation">)</span>
        <span class="token operator">...</span>
        <span class="token punctuation">{</span>
            Message<span class="token punctuation">:</span> <span class="token string">&quot;Troubleshooting and Debugging Commands:&quot;</span><span class="token punctuation">,</span>
            Commands<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>cobra<span class="token punctuation">.</span>Command<span class="token punctuation">{</span>
                validate<span class="token punctuation">.</span><span class="token function">NewCmdValidate</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> ioStreams<span class="token punctuation">)</span><span class="token punctuation">,</span>
                helloworld<span class="token punctuation">.</span><span class="token function">NewCmdHelloworld</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> ioStreams<span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u4E9B\u64CD\u4F5C\u4E2D\u5305\u542B\u4E86 <code>low code</code> \u7684\u601D\u60F3\u3002\u4F7F\u7528\u4EE3\u7801\u81EA\u52A8\u751F\u6210\u8FD9\u4E00\u6280\u672F\u3002\u8FD9\u6837\u505A\u6709\u4E24\u4E2A\u597D\u5904\uFF1A</p><ul><li>\u4E00\u65B9\u9762\u80FD\u591F\u63D0\u9AD8\u6211\u4EEC\u7684\u4EE3\u7801\u5F00\u53D1\u6548\u7387\uFF1B</li><li>\u53E6\u4E00\u65B9\u9762\u4E5F\u80FD\u591F\u4FDD\u8BC1\u89C4\u8303\uFF0C\u51CF\u5C11\u624B\u52A8\u64CD\u4F5C\u53EF\u80FD\u5E26\u6765\u7684\u9519\u8BEF\u3002</li></ul><p>\u6240\u4EE5\u8FD9\u91CC\u5C06 <code>iamctl</code> \u7684\u547D\u4EE4\u4E5F\u6A21\u677F\u5316\uFF0C\u5E76\u901A\u8FC7 <code>iamctl new</code> \u81EA\u52A8\u751F\u6210\u3002</p><h2 id="\u7B2C\u4E09\u6B65-\u751F\u6210\u4EE3\u7801" tabindex="-1"><a class="header-anchor" href="#\u7B2C\u4E09\u6B65-\u751F\u6210\u4EE3\u7801" aria-hidden="true">#</a> \u7B2C\u4E09\u6B65\uFF0C\u751F\u6210\u4EE3\u7801</h2><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>$ make gen
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5982\u679C\u6539\u52A8\u4E0D\u6D89\u53CA\u4EE3\u7801\u751F\u6210\uFF0C\u53EF\u4EE5\u4E0D\u6267\u884Cmake gen\u64CD\u4F5C\u3002 make gen \u6267\u884C\u7684\u5176\u5B9E\u662F gen.run \u4F2A\u76EE\u6807\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>gen.run: gen.clean gen.errcode gen.docgo.doc
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u770B\u5230\uFF0C\u5F53\u6267\u884C <code>make gen.run</code> \u65F6\uFF0C\u5176\u5B9E\u4F1A\u5148\u6E05\u7406\u4E4B\u524D\u751F\u6210\u7684\u6587\u4EF6\uFF0C\u518D\u5206\u522B\u81EA\u52A8\u751F\u6210 error code \u548C doc.go \u6587\u4EF6\u3002</p><p>\u8FD9\u91CC\u9700\u8981\u6CE8\u610F\uFF0C\u901A\u8FC7<code>make gen</code> \u751F\u6210\u7684\u5B58\u91CF\u4EE3\u7801\u8981\u5177\u6709\u5E42\u7B49\u6027\u3002\u53EA\u6709\u8FD9\u6837\uFF0C\u624D\u80FD\u786E\u4FDD\u6BCF\u6B21\u751F\u6210\u7684\u4EE3\u7801\u662F\u4E00\u6837\u7684\uFF0C\u907F\u514D\u4E0D\u4E00\u81F4\u5E26\u6765\u7684\u95EE\u9898\u3002</p><p>\u6211\u4EEC\u53EF\u4EE5\u5C06\u66F4\u591A\u7684\u4E0E\u81EA\u52A8\u751F\u6210\u4EE3\u7801\u76F8\u5173\u7684\u529F\u80FD\u653E\u5728 <code>gen.mk Makefile</code> \u4E2D\u3002\u4F8B\u5982\uFF1A</p><ul><li><code>gen.docgo.doc</code>\uFF0C\u4EE3\u8868\u81EA\u52A8\u751F\u6210 doc.go \u6587\u4EF6\u3002</li><li><code>gen.ca.%</code>\uFF0C\u4EE3\u8868\u81EA\u52A8\u751F\u6210 iamctl\u3001iam-apiserver\u3001iam-authz-server \u8BC1\u4E66\u6587\u4EF6\u3002</li></ul><h2 id="\u7B2C\u56DB\u6B65-\u7248\u6743\u68C0\u67E5" tabindex="-1"><a class="header-anchor" href="#\u7B2C\u56DB\u6B65-\u7248\u6743\u68C0\u67E5" aria-hidden="true">#</a> \u7B2C\u56DB\u6B65\uFF0C\u7248\u6743\u68C0\u67E5</h2><p>\u5982\u679C\u6709\u65B0\u6587\u4EF6\u6DFB\u52A0\uFF0C\u6211\u4EEC\u8FD8\u9700\u8981\u6267\u884C <code>make verify-copyright</code> \uFF0C\u6765\u68C0\u67E5\u65B0\u6587\u4EF6\u6709\u6CA1\u6709\u6DFB\u52A0\u7248\u6743\u5934\u4FE1\u606F\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">make</span> verify-copyright
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5982\u679C\u7248\u6743\u68C0\u67E5\u5931\u8D25\uFF0C\u53EF\u4EE5\u6267\u884C<code>make add-copyright</code>\u81EA\u52A8\u6DFB\u52A0\u7248\u6743\u5934\u3002\u6DFB\u52A0\u7248\u6743\u4FE1\u606F\u53EA\u9488\u5BF9\u5F00\u6E90\u8F6F\u4EF6\uFF0C\u5982\u679C\u4F60\u7684\u8F6F\u4EF6\u4E0D\u9700\u8981\u6DFB\u52A0\uFF0C\u5C31\u53EF\u4EE5\u7565\u8FC7\u8FD9\u4E00\u6B65\u3002</p><p>\u8FD9\u91CC\u8FD8\u6709\u4E2A Makefile \u7F16\u5199\u6280\u5DE7\uFF1A\u5982\u679C Makefile \u7684 command \u9700\u8981\u67D0\u4E2A\u547D\u4EE4\uFF0C\u5C31\u53EF\u4EE5\u4F7F\u8BE5\u76EE\u6807\u4F9D\u8D56\u7C7B\u4F3C <code>tools.verify.addlicense</code> \u8FD9\u79CD\u76EE\u6807\uFF0C<code>tools.verify.addlicense</code> \u4F1A\u68C0\u67E5\u8BE5\u5DE5\u5177\u662F\u5426\u5DF2\u5B89\u88C5\uFF0C\u5982\u679C\u6CA1\u6709\u5C31\u5148\u5B89\u88C5\u3002</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code><span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span> copyright.verify    
<span class="token target symbol">copyright.verify</span><span class="token punctuation">:</span> tools.verify.addlicense 
  ...
<span class="token target symbol">tools.verify.%</span><span class="token punctuation">:</span>          
  <span class="token operator">@</span>if ! which <span class="token variable">$*</span> &amp;&gt;/dev/null<span class="token punctuation">;</span> then <span class="token variable">$</span><span class="token punctuation">(</span>MAKE<span class="token punctuation">)</span> tools.install.<span class="token variable">$*;</span> fi
<span class="token builtin-target builtin">.PHONY</span><span class="token punctuation">:</span> install.addlicense                              
<span class="token target symbol">install.addlicense</span><span class="token punctuation">:</span>        
  <span class="token operator">@</span><span class="token variable">$</span><span class="token punctuation">(</span>GO<span class="token punctuation">)</span> get -u github.com/marmotedu/addlicense
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u901A\u8FC7\u8FD9\u79CD\u65B9\u5F0F\uFF0C\u53EF\u4EE5\u4F7F make copyright.verify \u5C3D\u53EF\u80FD\u81EA\u52A8\u5316\uFF0C\u51CF\u5C11\u624B\u52A8\u4ECB\u5165\u7684\u6982\u7387\u3002</p><h3 id="\u5982\u4F55\u5B89\u88C5-addlicense" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u5B89\u88C5-addlicense" aria-hidden="true">#</a> \u5982\u4F55\u5B89\u88C5 addlicense\uFF1F</h3><p>\u5728\u7EC8\u7AEF\u4E2D\u8F93\u5165\u4EE5\u4E0B\u547D\u4EE4\u5373\u53EF\u5B89\u88C5 addlicense\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>go get -u github.com/google/addlicense
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="\u5982\u4F55\u4F7F\u7528-addlicense" tabindex="-1"><a class="header-anchor" href="#\u5982\u4F55\u4F7F\u7528-addlicense" aria-hidden="true">#</a> \u5982\u4F55\u4F7F\u7528 addlicense\uFF1F</h3><p>\u5728\u7EC8\u7AEF\u4E2D\u8FDB\u5165\u60A8\u7684\u9879\u76EE\u76EE\u5F55\uFF0C\u7136\u540E\u8F93\u5165\u4EE5\u4E0B\u547D\u4EE4\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>addlicense -c &quot;\u8BB8\u53EF\u8BC1\u7C7B\u578B&quot; \u6587\u4EF6\u540D
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4F8B\u5982\uFF0C\u5982\u679C\u60A8\u60F3\u8981\u4E3A\u60A8\u7684\u9879\u76EE\u6DFB\u52A0 MIT \u8BB8\u53EF\u8BC1\uFF0C\u60A8\u53EF\u4EE5\u8F93\u5165\u4EE5\u4E0B\u547D\u4EE4\uFF1A</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>addlicense -c &quot;MIT&quot; LICENSE
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u63A5\u4E0B\u6765\uFF0Caddlicense \u4F1A\u81EA\u52A8\u5728 LICENSE \u6587\u4EF6\u4E2D\u6DFB\u52A0 MIT \u8BB8\u53EF\u8BC1\u6761\u6B3E\u3002</p><p>\u4EE5\u4E0B\u662F addlicense \u53EF\u63A5\u53D7\u7684\u53C2\u6570\uFF1A</p>`,47),K=s("li",null,[s("code",null,"c"),a("\uFF1A\u6307\u5B9A\u8981\u6DFB\u52A0\u7684\u8BB8\u53EF\u8BC1\u7C7B\u578B\u3002\u4F8B\u5982\uFF0C"),s("code",null,'c "MIT"'),a(" \u8868\u793A\u6DFB\u52A0 MIT \u8BB8\u53EF\u8BC1\u3002")],-1),W=s("li",null,[s("code",null,"l"),a("\uFF1A\u6307\u5B9A\u8BB8\u53EF\u8BC1\u7684\u94FE\u63A5\u3002\u4F8B\u5982\uFF0C"),s("code",null,'l "<https://opensource.org/licenses/MIT>"'),a(" \u8868\u793A\u6DFB\u52A0 MIT \u8BB8\u53EF\u8BC1\u94FE\u63A5\u3002")],-1),Z=s("code",null,"f",-1),X=a("\uFF1A\u6307\u5B9A\u8981\u6DFB\u52A0\u8BB8\u53EF\u8BC1\u7684\u6587\u4EF6\u5217\u8868\u3002\u4F8B\u5982\uFF0C"),J=s("code",null,'f "LICENSE, README.md"',-1),Q=a(" \u8868\u793A\u5728 LICENSE \u548C "),ss={href:"http://readme.md/",target:"_blank",rel:"noopener noreferrer"},as=a("README.md"),ns=a(" \u6587\u4EF6\u4E2D\u6DFB\u52A0\u8BB8\u53EF\u8BC1\u3002"),es=l(`<p>\u60A8\u53EF\u4EE5\u5728 GitHub \u4E0A\u67E5\u770B addlicense \u7684\u5B8C\u6574\u6587\u6863\uFF0C\u4EE5\u83B7\u53D6\u66F4\u591A\u53C2\u6570\u53CA\u4F7F\u7528\u65B9\u6CD5\u3002</p><h3 id="\u652F\u6301\u7684\u8BB8\u53EF\u8BC1\u7C7B\u578B" tabindex="-1"><a class="header-anchor" href="#\u652F\u6301\u7684\u8BB8\u53EF\u8BC1\u7C7B\u578B" aria-hidden="true">#</a> \u652F\u6301\u7684\u8BB8\u53EF\u8BC1\u7C7B\u578B</h3><p>addlicense \u652F\u6301\u8BB8\u591A\u5E38\u89C1\u7684\u8BB8\u53EF\u8BC1\u7C7B\u578B\uFF0C\u4F8B\u5982\uFF1A</p><ul><li>MIT</li><li>Apache</li><li>BSD-2-Clause</li><li>BSD-3-Clause</li><li>GPL-2.0</li><li>GPL-3.0</li></ul><p>\u60A8\u53EF\u4EE5\u5728 GitHub \u4E0A\u67E5\u770B addlicense \u7684\u5B8C\u6574\u6587\u6863\uFF0C\u4EE5\u83B7\u53D6\u66F4</p><h2 id="\u7B2C\u4E94\u6B65-\u4EE3\u7801\u683C\u5F0F\u5316" tabindex="-1"><a class="header-anchor" href="#\u7B2C\u4E94\u6B65-\u4EE3\u7801\u683C\u5F0F\u5316" aria-hidden="true">#</a> \u7B2C\u4E94\u6B65\uFF0C\u4EE3\u7801\u683C\u5F0F\u5316</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">make</span> <span class="token function">format</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u6267\u884Cmake format\u4F1A\u4F9D\u6B21\u6267\u884C\u4EE5\u4E0B\u683C\u5F0F\u5316\u64CD\u4F5C\uFF1A</p><ul><li>\u8C03\u7528 gofmt \u683C\u5F0F\u5316\u4F60\u7684\u4EE3\u7801\u3002</li><li>\u8C03\u7528 goimports \u5DE5\u5177\uFF0C\u81EA\u52A8\u589E\u5220\u4F9D\u8D56\u7684\u5305\uFF0C\u5E76\u5C06\u4F9D\u8D56\u5305\u6309\u5B57\u6BCD\u5E8F\u6392\u5E8F\u5E76\u5206\u7C7B\u3002</li><li>\u8C03\u7528 golines \u5DE5\u5177\uFF0C\u628A\u8D85\u8FC7 120 \u884C\u7684\u4EE3\u7801\u6309 golines \u89C4\u5219\uFF0C\u683C\u5F0F\u5316\u6210 <code>&lt;120</code> \u884C\u7684\u4EE3\u7801\u3002</li><li>\u8C03\u7528 go mod edit -fmt \u683C\u5F0F\u5316 go.mod \u6587\u4EF6</li></ul><h2 id="\u7B2C\u516D\u6B65-\u9759\u6001\u4EE3\u7801\u68C0\u67E5" tabindex="-1"><a class="header-anchor" href="#\u7B2C\u516D\u6B65-\u9759\u6001\u4EE3\u7801\u68C0\u67E5" aria-hidden="true">#</a> \u7B2C\u516D\u6B65\uFF0C\u9759\u6001\u4EE3\u7801\u68C0\u67E5</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">make</span> lint
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5173\u4E8E\u9759\u6001\u4EE3\u7801\u68C0\u67E5\uFF0C\u5728\u8FD9\u91CC\u4F60\u53EF\u4EE5\u5148\u4E86\u89E3\u4EE3\u7801\u5F00\u53D1\u9636\u6BB5\u6709\u8FD9\u4E2A\u6B65\u9AA4\uFF0C\u81F3\u4E8E\u5982\u4F55\u64CD\u4F5C\uFF0C\u6211\u4F1A\u5728\u4E0B\u4E00\u8BB2\u7ED9\u4F60\u8BE6\u7EC6\u4ECB\u7ECD\u3002</p><h2 id="\u7B2C\u4E03\u6B65-\u5355\u5143\u6D4B\u8BD5" tabindex="-1"><a class="header-anchor" href="#\u7B2C\u4E03\u6B65-\u5355\u5143\u6D4B\u8BD5" aria-hidden="true">#</a> \u7B2C\u4E03\u6B65\uFF0C\u5355\u5143\u6D4B\u8BD5</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ make test
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8FD9\u91CC\u8981\u6CE8\u610F\uFF0C\u5E76\u4E0D\u662F\u6240\u6709\u7684\u5305\u90FD\u9700\u8981\u6267\u884C\u5355\u5143\u6D4B\u8BD5\u3002\u4F60\u53EF\u4EE5\u901A\u8FC7\u5982\u4E0B\u547D\u4EE4\uFF0C\u6392\u9664\u6389\u4E0D\u9700\u8981\u5355\u5143\u6D4B\u8BD5\u7684\u5305\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>go <span class="token builtin class-name">test</span> <span class="token variable"><span class="token variable">\`</span>go list ./<span class="token punctuation">..</span>.<span class="token operator">|</span><span class="token function">egrep</span> <span class="token parameter variable">-v</span> <span class="token punctuation">$(</span>subst <span class="token punctuation">$(</span>SPACE<span class="token punctuation">)</span>,<span class="token string">&#39;|&#39;</span>,<span class="token punctuation">$(</span>sort <span class="token punctuation">$(</span>EXCLUDE_TESTS<span class="token punctuation">))</span><span class="token punctuation">)</span><span class="token variable">\`</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u8FD0\u884C\u8BE5\u547D\u4EE4\u7684\u76EE\u7684\uFF0C\u662F\u628A <code>mock_.* .go</code> \u6587\u4EF6\u4E2D\u7684\u51FD\u6570\u5355\u5143\u6D4B\u8BD5\u4FE1\u606F\u4ECE <code>coverage.out</code> \u4E2D\u5220\u9664\u3002<code>mock_.*.go</code> \u6587\u4EF6\u4E2D\u7684\u51FD\u6570\u662F\u4E0D\u9700\u8981\u5355\u5143\u6D4B\u8BD5\u7684\uFF0C\u5982\u679C\u4E0D\u5220\u9664\uFF0C\u5C31\u4F1A\u5F71\u54CD\u540E\u9762\u7684\u5355\u5143\u6D4B\u8BD5\u8986\u76D6\u7387\u7684\u8BA1\u7B97\u3002</p><p>\u5982\u679C\u60F3\u68C0\u67E5\u5355\u5143\u6D4B\u8BD5\u8986\u76D6\u7387\uFF0C\u8BF7\u6267\u884C\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">make</span> cover
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u9ED8\u8BA4\u6D4B\u8BD5\u8986\u76D6\u7387\u81F3\u5C11\u4E3A 60%\uFF0C\u4E5F\u53EF\u4EE5\u5728\u547D\u4EE4\u884C\u6307\u5B9A\u8986\u76D6\u7387\u9608\u503C\u4E3A\u5176\u4ED6\u503C\uFF0C\u4F8B\u5982\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">make</span> cover <span class="token assign-left variable">COVERAGE</span><span class="token operator">=</span><span class="token number">90</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5982\u679C\u6D4B\u8BD5\u8986\u76D6\u7387\u4E0D\u6EE1\u8DB3\u8981\u6C42\uFF0C\u5C31\u4F1A\u8FD4\u56DE\u4EE5\u4E0B\u9519\u8BEF\u4FE1\u606F\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">test</span> coverage is <span class="token number">62.1</span>%
<span class="token builtin class-name">test</span> coverage does not meet expectations: <span class="token number">90</span>%, please <span class="token function">add</span> <span class="token builtin class-name">test</span> cases<span class="token operator">!</span>
make<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: *** <span class="token punctuation">[</span>go.test.cover<span class="token punctuation">]</span> Error <span class="token number">1</span>
make: *** <span class="token punctuation">[</span>cover<span class="token punctuation">]</span> Error <span class="token number">2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u91CC make \u547D\u4EE4\u7684\u9000\u51FA\u7801\u4E3A1\u3002</p><p>\u5982\u679C\u5355\u5143\u6D4B\u8BD5\u8986\u76D6\u7387\u8FBE\u4E0D\u5230\u8BBE\u7F6E\u7684\u9608\u503C\uFF0C\u5C31\u9700\u8981\u8865\u5145\u6D4B\u8BD5\u7528\u4F8B\uFF0C\u5426\u5219\u7981\u6B62\u5408\u5E76\u5230 <code>develop</code> \u548C master \u5206\u652F\u3002IAM \u9879\u76EE\u914D\u7F6E\u4E86 <code>GitHub Actions CI</code> \u81EA\u52A8\u5316\u6D41\u6C34\u7EBF\uFF0CCI \u6D41\u6C34\u7EBF\u4F1A\u81EA\u52A8\u8FD0\u884C\uFF0C\u68C0\u67E5\u5355\u5143\u6D4B\u8BD5\u8986\u76D6\u7387\u662F\u5426\u8FBE\u5230\u8981\u6C42\u3002</p><h2 id="\u7B2C\u516B\u6B65-\u6784\u5EFA" tabindex="-1"><a class="header-anchor" href="#\u7B2C\u516B\u6B65-\u6784\u5EFA" aria-hidden="true">#</a> \u7B2C\u516B\u6B65\uFF0C\u6784\u5EFA</h2><p>\u6700\u540E\uFF0C\u6211\u4EEC\u6267\u884Cmake build\u547D\u4EE4\uFF0C\u6784\u5EFA\u51FAcmd/\u76EE\u5F55\u4E0B\u6240\u6709\u7684\u4E8C\u8FDB\u5236\u5B89\u88C5\u6587\u4EF6\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">make</span> build
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>make build \u4F1A\u81EA\u52A8\u6784\u5EFA cmd/ \u76EE\u5F55\u4E0B\u7684\u6240\u6709\u7EC4\u4EF6\uFF0C\u5982\u679C\u53EA\u60F3\u6784\u5EFA\u5176\u4E2D\u7684\u4E00\u4E2A\u6216\u591A\u4E2A\u7EC4\u4EF6\uFF0C\u53EF\u4EE5\u4F20\u5165 BINS\u9009\u9879\uFF0C\u7EC4\u4EF6\u4E4B\u95F4\u7528\u7A7A\u683C\u9694\u5F00\uFF0C\u5E76\u7528\u53CC\u5F15\u53F7\u5F15\u8D77\u6765\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">make</span> build <span class="token assign-left variable">BINS</span><span class="token operator">=</span><span class="token string">&quot;iam-apiserver iamctl&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u5230\u8FD9\u91CC\uFF0C\u6211\u4EEC\u5C31\u5B8C\u6210\u4E86\u4EE3\u7801\u5F00\u53D1\u9636\u6BB5\u7684\u5168\u90E8\u64CD\u4F5C\u3002</p><p>\u5982\u679C\u4F60\u89C9\u5F97\u624B\u52A8\u6267\u884C\u7684 make \u547D\u4EE4\u6BD4\u8F83\u591A\uFF0C\u53EF\u4EE5\u76F4\u63A5\u6267\u884C make \u547D\u4EE4\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">make</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">&gt;</span> Generating iam error code go <span class="token builtin class-name">source</span> files
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">&gt;</span> Generating error code markdown documentation
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">&gt;</span> Generating missing doc.go <span class="token keyword">for</span> go packages
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">&gt;</span> Verifying the boilerplate headers <span class="token keyword">for</span> all files
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">&gt;</span> Formating codes
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">&gt;</span> Run golangci to lint <span class="token builtin class-name">source</span> codes
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">&gt;</span> Run unit <span class="token builtin class-name">test</span>
<span class="token punctuation">..</span>.
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">&gt;</span> Building binary iam-pump v0.7.2-24-g5814e7b <span class="token keyword">for</span> linux amd64
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">&gt;</span> Building binary iamctl v0.7.2-24-g5814e7b <span class="token keyword">for</span> linux amd64
<span class="token punctuation">..</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u76F4\u63A5\u6267\u884Cmake\u4F1A\u6267\u884C\u4F2A\u76EE\u6807all\u6240\u4F9D\u8D56\u7684\u4F2A\u76EE\u6807 <code>all: tidy gen add-copyright format lint cover build</code>\uFF0C\u4E5F\u5373\u6267\u884C\u4EE5\u4E0B\u64CD\u4F5C\uFF1A<strong>\u4F9D\u8D56\u5305\u6DFB\u52A0 / \u5220\u9664\u3001\u751F\u6210\u4EE3\u7801\u3001\u81EA\u52A8\u6DFB\u52A0\u7248\u6743\u5934\u3001\u4EE3\u7801\u683C\u5F0F\u5316\u3001\u9759\u6001\u4EE3\u7801\u68C0\u67E5\u3001\u8986\u76D6\u7387\u6D4B\u8BD5\u3001\u6784\u5EFA\u3002</strong></p><p>\u8FD9\u91CC\u4F60\u9700\u8981\u6CE8\u610F\u4E00\u70B9\uFF1Aall \u4E2D\u4F9D\u8D56 <code>cover</code>\uFF0Ccover \u5B9E\u9645\u6267\u884C\u7684\u662F <code>go.test.cover</code> \uFF0C\u800C <code>go.test.cover</code> \u53C8\u4F9D\u8D56 <code>go.test</code> \uFF0C\u6240\u4EE5 <code>cover</code> \u5B9E\u9645\u4E0A\u662F\u5148\u6267\u884C\u5355\u5143\u6D4B\u8BD5\uFF0C\u518D\u68C0\u67E5\u5355\u5143\u6D4B\u8BD5\u8986\u76D6\u7387\u662F\u5426\u6EE1\u8DB3\u9884\u8BBE\u7684\u9608\u503C\u3002</p><p>\u6700\u540E\u8865\u5145\u4E00\u70B9\uFF0C\u5728\u5F00\u53D1\u9636\u6BB5\u6211\u4EEC\u53EF\u4EE5\u6839\u636E\u9700\u8981\u968F\u65F6\u6267\u884C make gen \u3001 make format \u3001 make lint \u3001 make cover \u7B49\u64CD\u4F5C\uFF0C\u4E3A\u7684\u662F\u80FD\u591F\u63D0\u524D\u53D1\u73B0\u95EE\u9898\u5E76\u6539\u6B63\u3002</p><h2 id="\u4EE3\u7801\u63D0\u4EA4" tabindex="-1"><a class="header-anchor" href="#\u4EE3\u7801\u63D0\u4EA4" aria-hidden="true">#</a> \u4EE3\u7801\u63D0\u4EA4</h2><p>\u4EE3\u7801\u5F00\u53D1\u5B8C\u6210\u4E4B\u540E\uFF0C\u6211\u4EEC\u5C31\u9700\u8981\u5C06\u4EE3\u7801\u63D0\u4EA4\u5230\u8FDC\u7A0B\u4ED3\u5E93\uFF0C\u6574\u4E2A\u6D41\u7A0B\u5206\u4E3A\u4EE5\u4E0B\u51E0\u4E2A\u6B65\u9AA4\u3002</p><p>\u7B2C\u4E00\u6B65\uFF0C\u5F00\u53D1\u5B8C\u540E\uFF0C\u5C06\u4EE3\u7801\u63D0\u4EA4\u5230 <code>feature/helloworld</code> \u5206\u652F\uFF0C\u5E76 push \u5230\u8FDC\u7AEF\u4ED3\u5E93\u3002</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">git</span> <span class="token function">add</span> internal/iamctl/cmd/helloworld internal/iamctl/cmd/cmd.go
$ <span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">&quot;feat: add new iamctl command &#39;helloworld&#39;&quot;</span>
$ <span class="token function">git</span> push origin feature/helloworld
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u91CC\u6211\u5EFA\u8BAE\u4F60\u53EA\u6DFB\u52A0\u8DDF<code>feature/helloworld</code>\u76F8\u5173\u7684\u6539\u52A8\uFF0C\u8FD9\u6837\u5C31\u77E5\u9053\u4E00\u4E2A commit \u505A\u4E86\u54EA\u4E9B\u53D8\u66F4\uFF0C\u65B9\u4FBF\u4EE5\u540E\u8FFD\u6EAF\u3002\u6240\u4EE5\uFF0C\u6211\u4E0D\u5EFA\u8BAE\u76F4\u63A5\u6267\u884C<code>git add .</code>\u8FD9\u7C7B\u65B9\u5F0F\u63D0\u4EA4\u6539\u52A8\u3002</p>`,41),ts=a("\u5728\u63D0\u4EA4 commit \u65F6\uFF0Ccommit-msg githooks \u4F1A\u68C0\u67E5 commit message \u662F\u5426\u7B26\u5408 Angular Commit Message \u89C4\u8303\uFF0C\u5982\u679C\u4E0D\u7B26\u5408\u4F1A\u62A5\u9519\u3002commit-msage \u8C03\u7528\u4E86"),os={href:"https://github.com/llorllale/go-gitlint",target:"_blank",rel:"noopener noreferrer"},ls=a("go-gitlint"),is=a("\u6765\u68C0\u67E5 commit message\u3002go-gitlint \u4F1A\u8BFB\u53D6 "),ps=s("code",null,".gitlint",-1),cs=a(" \u4E2D\u914D\u7F6E\u7684 commit message \u683C\u5F0F\uFF1A"),rs=l(`<div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>--subject-regex<span class="token operator">=</span>^<span class="token variable"><span class="token punctuation">((</span>Merge branch.<span class="token operator">*</span>of.<span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">((</span>revert<span class="token operator">:</span> <span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">(</span>feat<span class="token operator">|</span>fix<span class="token operator">|</span>perf<span class="token operator">|</span>style<span class="token operator">|</span>refactor<span class="token operator">|</span>test<span class="token operator">|</span>ci<span class="token operator">|</span>docs<span class="token operator">|</span>chore<span class="token punctuation">)</span><span class="token punctuation">(</span>\\<span class="token punctuation">(</span>.<span class="token operator">+</span>\\<span class="token punctuation">))</span></span>?: <span class="token punctuation">[</span>^A-Z<span class="token punctuation">]</span>.*<span class="token punctuation">[</span>^.<span class="token punctuation">]</span>$<span class="token punctuation">))</span>
--subject-maxlen<span class="token operator">=</span><span class="token number">72</span>
--body-regex<span class="token operator">=</span>^<span class="token punctuation">(</span><span class="token punctuation">[</span>^<span class="token punctuation">\\</span>r<span class="token punctuation">\\</span>n<span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token number">0,72</span><span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">\\</span>r?<span class="token punctuation">\\</span>n<span class="token operator">|</span>$<span class="token punctuation">))</span>*$
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>IAM \u9879\u76EE\u914D\u7F6E\u4E86 GitHub Actions\uFF0C\u5F53\u6709\u4EE3\u7801\u88AB push \u540E\uFF0C\u4F1A\u89E6\u53D1 CI \u6D41\u6C34\u7EBF\uFF0C\u6D41\u6C34\u7EBF\u4F1A\u6267\u884Cmake all\u76EE\u6807\u3002GitHub Actions CI \u6D41\u7A0B\u6267\u884C\u8BB0\u5F55\u5982\u4E0B\u56FE\uFF1A</p><p><img src="http://sm.nsddd.top/sm202302202032620.png" alt="image-20230220203225172"></p><p>\u5982\u679C CI \u4E0D\u901A\u8FC7\uFF0C\u5C31\u9700\u8981\u4FEE\u6539\u4EE3\u7801\uFF0C\u76F4\u5230 CI \u6D41\u6C34\u7EBF\u901A\u8FC7\u4E3A\u6B62\u3002</p><h3 id="github-action-\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#github-action-\u914D\u7F6E" aria-hidden="true">#</a> Github Action \u914D\u7F6E</h3><p><strong>\u8FD9\u91CC\uFF0C\u6211\u4EEC\u6765\u770B\u4E0B GitHub Actions \u7684\u914D\u7F6E\uFF1A</strong></p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">name</span><span class="token punctuation">:</span> IamCI

<span class="token key atrule">on</span><span class="token punctuation">:</span> 
  <span class="token key atrule">push</span><span class="token punctuation">:</span>
    <span class="token key atrule">branchs</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">&#39;*&#39;</span>
  <span class="token key atrule">pull_request</span><span class="token punctuation">:</span>
    <span class="token key atrule">types</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>opened<span class="token punctuation">,</span> reopened<span class="token punctuation">]</span>

<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">build</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2

    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Set up Go
      <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/setup<span class="token punctuation">-</span>go@v2
      <span class="token key atrule">with</span><span class="token punctuation">:</span>
        <span class="token key atrule">go-version</span><span class="token punctuation">:</span> <span class="token number">1.16</span>

    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> all
      <span class="token key atrule">run</span><span class="token punctuation">:</span> make
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53EF\u4EE5\u770B\u5230\uFF0CGitHub Actions \u5B9E\u9645\u4E0A\u6267\u884C\u4E86 3 \u6B65\uFF1A\u62C9\u53D6\u4EE3\u7801\u3001\u8BBE\u7F6E Go \u7F16\u8BD1\u73AF\u5883\u3001\u6267\u884C make \u547D\u4EE4\uFF08\u4E5F\u5C31\u662F\u6267\u884C make all \u76EE\u6807\uFF09\u3002</p><p>GitHub Actions \u4E5F\u6267\u884C\u4E86 make all \u76EE\u6807\uFF0C\u548C\u624B\u52A8\u64CD\u4F5C\u6267\u884C\u7684 make all \u76EE\u6807\u4FDD\u6301\u4E00\u81F4\uFF0C\u8FD9\u6837\u505A\u662F\u4E3A\u4E86\u8BA9\u7EBF\u4E0A\u7684 CI \u6D41\u7A0B\u548C\u672C\u5730\u7684 CI \u6D41\u7A0B\u5B8C\u5168\u4FDD\u6301\u4E00\u81F4\u3002\u8FD9\u6837\uFF0C\u5F53\u6211\u4EEC\u5728\u672C\u5730\u6267\u884C make \u547D\u4EE4\u901A\u8FC7\u540E\uFF0C\u5728\u7EBF\u4E0A\u4E5F\u4F1A\u901A\u8FC7\u3002\u4FDD\u6301\u4E00\u4E2A\u4E00\u81F4\u7684\u6267\u884C\u6D41\u7A0B\u548C\u6267\u884C\u7ED3\u679C\u5F88\u91CD\u8981\u3002\u5426\u5219\uFF0C\u672C\u5730\u6267\u884C make \u901A\u8FC7\uFF0C\u4F46\u662F\u7EBF\u4E0A\u5374\u4E0D\u901A\u8FC7\uFF0C\u5C82\u4E0D\u5F88\u8BA9\u4EBA\u5934\u75BC\uFF1F</p><p><strong>\u7B2C\u4E8C\u6B65\uFF0C\u63D0\u4EA4 pull request\u3002</strong></p><p>\u767B\u9646 GitHub\uFF0C\u57FA\u4E8E feature/helloworld \u521B\u5EFA pull request\uFF0C\u5E76\u6307\u5B9A Reviewers \u8FDB\u884C code review\u3002\u5177\u4F53\u64CD\u4F5C\u5982\u4E0B\u56FE\uFF1A</p><p><img src="http://sm.nsddd.top/sm202302202041557.png" alt="image-20230220204115977"></p><p>\u5F53\u6709\u65B0\u7684 pull request \u88AB\u521B\u5EFA\u540E\uFF0C\u4E5F\u4F1A\u89E6\u53D1 CI \u6D41\u6C34\u7EBF\u3002</p><p><strong>\u7B2C\u4E09\u6B65\uFF0C\u521B\u5EFA\u5B8C pull request \u540E\uFF0C\u5C31\u53EF\u4EE5\u901A\u77E5 reviewers \u6765 review \u4EE3\u7801\uFF0CGitHub \u4E5F\u4F1A\u53D1\u7AD9\u5185\u4FE1\u3002</strong></p><p><strong>\u7B2C\u56DB\u6B65\uFF0CReviewers \u5BF9\u4EE3\u7801\u8FDB\u884C review\u3002</strong></p><blockquote><p>Reviewer \u901A\u8FC7 <code>review github diff</code> \u540E\u7684\u5185\u5BB9\uFF0C\u5E76\u7ED3\u5408 CI \u6D41\u7A0B\u662F\u5426\u901A\u8FC7\u6DFB\u52A0\u8BC4\u8BBA\uFF0C\u5E76\u9009\u62E9 Comment\uFF08\u4EC5\u8BC4\u8BBA\uFF09\u3001Approve\uFF08\u901A\u8FC7\uFF09\u3001Request Changes\uFF08\u4E0D\u901A\u8FC7\uFF0C\u9700\u8981\u4FEE\u6539\uFF09\uFF0C\u5982\u4E0B\u56FE\u6240\u793A\uFF1A</p><p><img src="http://sm.nsddd.top/sm202302202043133.png" alt="image-20230220204310055"></p></blockquote><p>\u5982\u679C review \u4E0D\u901A\u8FC7\uFF0Cfeature \u5F00\u53D1\u8005\u53EF\u4EE5\u76F4\u63A5\u5728 <code>feature/helloworld</code> \u5206\u652F\u4FEE\u6B63\u4EE3\u7801\uFF0C\u5E76 push \u5230\u8FDC\u7AEF\u7684 <code>feature/helloworld</code> \u5206\u652F\uFF0C\u7136\u540E\u901A\u77E5 reviewers \u518D\u6B21 review\u3002\u56E0\u4E3A\u6709 push \u4E8B\u4EF6\u53D1\u751F\uFF0C\u6240\u4EE5\u4F1A\u89E6\u53D1 GitHub Actions CI \u6D41\u6C34\u7EBF\u3002</p><p><strong>\u7B2C\u4E94\u6B65\uFF0Ccode review \u901A\u8FC7\u540E\uFF0Cmaintainer \u5C31\u53EF\u4EE5\u5C06\u65B0\u7684\u4EE3\u7801\u5408\u5E76\u5230 develop \u5206\u652F\u3002</strong></p><p>\u4F7F\u7528 Create a merge commit \u7684\u65B9\u5F0F\uFF0C\u5C06 pull request \u5408\u5E76\u5230 develop \u5206\u652F\uFF0C\u5982\u4E0B\u56FE\u6240\u793A\uFF1A</p><p><img src="http://sm.nsddd.top/sm202302202044187.png" alt="image-20230220204403904"></p><p><code>Create a merge commit</code> \u7684\u5B9E\u9645\u64CD\u4F5C\u662F <code>git merge --no-ff</code>\uFF0C<code>feature/helloworld</code> \u5206\u652F\u4E0A\u6240\u6709\u7684 commit \u90FD\u4F1A\u52A0\u5230 develop \u5206\u652F\u4E0A\uFF0C\u5E76\u4E14\u4F1A\u751F\u6210\u4E00\u4E2A merge commit\u3002\u4F7F\u7528\u8FD9\u79CD\u65B9\u5F0F\uFF0C\u53EF\u4EE5\u6E05\u6670\u5730\u77E5\u9053\u662F\u8C01\u505A\u4E86\u54EA\u4E9B\u63D0\u4EA4\uFF0C\u56DE\u6EAF\u5386\u53F2\u7684\u65F6\u5019\u4E5F\u4F1A\u66F4\u52A0\u65B9\u4FBF\u3002</p><p><strong>\u7B2C\u516D\u6B65\uFF0C\u5408\u5E76\u5230 develop \u5206\u652F\u540E\uFF0C\u89E6\u53D1 CI \u6D41\u7A0B\u3002</strong></p><p>\u5230\u8FD9\u91CC\uFF0C\u5F00\u53D1\u9636\u6BB5\u7684\u64CD\u4F5C\u5C31\u5168\u90E8\u5B8C\u6210\u4E86\uFF0C\u6574\u4F53\u6D41\u7A0B\u5982\u4E0B\uFF1A</p><p><img src="http://sm.nsddd.top/sm202302202045792.png" alt="image-20230220204511699"></p><p>\u5408\u5E76\u5230 develop \u5206\u652F\u4E4B\u540E\uFF0C\u6211\u4EEC\u5C31\u53EF\u4EE5\u8FDB\u5165\u5F00\u53D1\u9636\u6BB5\u7684\u4E0B\u4E00\u9636\u6BB5\uFF0C\u4E5F\u5C31\u662F\u6D4B\u8BD5\u9636\u6BB5\u4E86\u3002</p><h2 id="\u6D4B\u8BD5\u9636\u6BB5" tabindex="-1"><a class="header-anchor" href="#\u6D4B\u8BD5\u9636\u6BB5" aria-hidden="true">#</a> \u6D4B\u8BD5\u9636\u6BB5</h2><p>\u5728\u6D4B\u8BD5\u9636\u6BB5\uFF0C\u5F00\u53D1\u4EBA\u5458\u4E3B\u8981\u8D1F\u8D23\u63D0\u4F9B\u6D4B\u8BD5\u5305\u548C\u4FEE\u590D\u6D4B\u8BD5\u671F\u95F4\u53D1\u73B0\u7684 bug\uFF0C\u8FD9\u4E2A\u8FC7\u7A0B\u4E2D\u4E5F\u53EF\u80FD\u4F1A\u53D1\u73B0\u4E00\u4E9B\u65B0\u7684\u9700\u6C42\u6216\u53D8\u52A8\u70B9\uFF0C\u6240\u4EE5\u9700\u8981\u5408\u7406\u8BC4\u4F30\u8FD9\u4E9B\u65B0\u7684\u9700\u6C42\u6216\u53D8\u52A8\u70B9\u662F\u5426\u8981\u653E\u5728\u5F53\u524D\u8FED\u4EE3\u4FEE\u6539\u3002</p><p>\u6D4B\u8BD5\u9636\u6BB5\u7684\u64CD\u4F5C\u6D41\u7A0B\u5982\u4E0B\u3002</p><p><strong>\u7B2C\u4E00\u6B65\uFF0C\u57FA\u4E8E develop \u5206\u652F\uFF0C\u521B\u5EFA release \u5206\u652F\uFF0C\u6D4B\u8BD5\u4EE3\u7801\u3002</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">git</span> checkout <span class="token parameter variable">-b</span> release/1.0.0 develop
$ <span class="token function">make</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u7B2C\u4E8C\u6B65\uFF0C\u63D0\u4EA4\u6D4B\u8BD5\u3002</strong></p><p>\u5C06 <code>release/1.0.0</code> \u5206\u652F\u7684\u4EE3\u7801\u63D0\u4EA4\u7ED9\u6D4B\u8BD5\u540C\u5B66\u8FDB\u884C\u6D4B\u8BD5\u3002\u8FD9\u91CC\u5047\u8BBE\u4E00\u4E2A\u6D4B\u8BD5\u5931\u8D25\u7684\u573A\u666F\uFF1A\u6211\u4EEC\u8981\u6C42\u6253\u5370\u201Chello world\u201D\uFF0C\u4F46\u6253\u5370\u7684\u662F\u201CHello World\u201D\uFF0C\u9700\u8981\u4FEE\u590D\u3002\u90A3\u5177\u4F53\u5E94\u8BE5\u600E\u4E48\u64CD\u4F5C\u5462\uFF1F</p><p>\u4F60\u53EF\u4EE5\u76F4\u63A5\u5728 <code>release/1.0.0</code> \u5206\u652F\u4FEE\u6539\u4EE3\u7801\uFF0C\u4FEE\u6539\u5B8C\u6210\u540E\uFF0C\u672C\u5730\u6784\u5EFA\u5E76\u63D0\u4EA4\u4EE3\u7801\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">make</span>
$ <span class="token function">git</span> <span class="token function">add</span> internal/iamctl/cmd/helloworld/
$ <span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">&quot;fix: fix helloworld print bug&quot;</span>
$ <span class="token function">git</span> push origin release/1.0.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>push \u5230 release/1.0.0</code> \u540E\uFF0CGitHub Actions \u4F1A\u6267\u884C CI \u6D41\u6C34\u7EBF\u3002\u5982\u679C\u6D41\u6C34\u7EBF\u6267\u884C\u6210\u529F\uFF0C\u5C31\u5C06\u4EE3\u7801\u63D0\u4F9B\u7ED9\u6D4B\u8BD5\uFF1B\u5982\u679C\u6D4B\u8BD5\u4E0D\u6210\u529F\uFF0C\u518D\u91CD\u65B0\u4FEE\u6539\uFF0C\u76F4\u5230\u6D41\u6C34\u7EBF\u6267\u884C\u6210\u529F\u3002</p><p>\u6D4B\u8BD5\u540C\u5B66\u4F1A\u5BF9 release/1.0.0 \u5206\u652F\u7684\u4EE3\u7801\u8FDB\u884C\u5145\u5206\u7684\u6D4B\u8BD5\uFF0C\u4F8B\u5982\u529F\u80FD\u6D4B\u8BD5\u3001\u6027\u80FD\u6D4B\u8BD5\u3001\u96C6\u6210\u6D4B\u8BD5\u3001\u7CFB\u7EDF\u6D4B\u8BD5\u7B49\u3002</p><p><strong>\u7B2C\u4E09\u6B65\uFF0C\u6D4B\u8BD5\u901A\u8FC7\u540E\uFF0C\u5C06\u529F\u80FD\u5206\u652F\u5408\u5E76\u5230 master \u5206\u652F\u548C develop \u5206\u652F\u3002</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">git</span> checkout develop
$ <span class="token function">git</span> merge --no-ff release/1.0.0
$ <span class="token function">git</span> checkout master
$ <span class="token function">git</span> merge --no-ff release/1.0.0
$ <span class="token function">git</span> tag <span class="token parameter variable">-a</span> v1.0.0 <span class="token parameter variable">-m</span> <span class="token string">&quot;add print hello world&quot;</span> <span class="token comment"># master\u5206\u652F\u6253tag</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5230\u8FD9\u91CC\uFF0C\u6D4B\u8BD5\u9636\u6BB5\u7684\u64CD\u4F5C\u5C31\u57FA\u672C\u5B8C\u6210\u4E86\u3002\u6D4B\u8BD5\u9636\u6BB5\u7684\u4EA7\u7269\u662F master/develop \u5206\u652F\u7684\u4EE3\u7801\u3002</p><p><strong>\u7B2C\u56DB\u6B65\uFF0C\u5220\u9664 feature/helloworld \u5206\u652F\uFF0C\u4E5F\u53EF\u4EE5\u9009\u62E9\u6027\u5220\u9664 release/1.0.0 \u5206\u652F\u3002</strong></p><p>\u6211\u4EEC\u7684\u4EE3\u7801\u90FD\u5408\u5E76\u5165 master/develop \u5206\u652F\u540E\uFF0Cfeature \u5F00\u53D1\u8005\u53EF\u4EE5\u9009\u62E9\u662F\u5426\u8981\u4FDD\u7559 feature\u3002\u4E0D\u8FC7\uFF0C\u5982\u679C\u6CA1\u6709\u7279\u522B\u7684\u539F\u56E0\uFF0C\u6211\u5EFA\u8BAE\u5220\u6389\uFF0C\u56E0\u4E3A feature \u5206\u652F\u592A\u591A\u7684\u8BDD\uFF0C\u4E0D\u4EC5\u770B\u8D77\u6765\u5F88\u4E71\uFF0C\u8FD8\u4F1A\u5F71\u54CD\u6027\u80FD\uFF0C\u5220\u9664\u64CD\u4F5C\u5982\u4E0B\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">git</span> branch <span class="token parameter variable">-d</span> feature/helloworld
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="iam-\u9879\u76EE\u7684-makefile-\u9879\u76EE\u7BA1\u7406\u6280\u5DE7" tabindex="-1"><a class="header-anchor" href="#iam-\u9879\u76EE\u7684-makefile-\u9879\u76EE\u7BA1\u7406\u6280\u5DE7" aria-hidden="true">#</a> IAM \u9879\u76EE\u7684 Makefile \u9879\u76EE\u7BA1\u7406\u6280\u5DE7</h2><p>\u5728\u4E0A\u9762\u7684\u5185\u5BB9\u4E2D\uFF0C\u6211\u4EEC\u4EE5\u7814\u53D1\u6D41\u7A0B\u4E3A\u4E3B\u7EBF\uFF0C\u4EB2\u8EAB\u4F53\u9A8C\u4E86 IAM \u9879\u76EE\u7684 Makefile \u9879\u76EE\u7BA1\u7406\u529F\u80FD\u3002\u8FD9\u4E9B\u662F\u4F60\u6700\u5E94\u8BE5\u638C\u63E1\u7684\u6838\u5FC3\u529F\u80FD\uFF0C\u4F46 IAM \u9879\u76EE\u7684 Makefile \u8FD8\u6709\u5F88\u591A\u529F\u80FD\u548C\u8BBE\u8BA1\u6280\u5DE7\u3002\u63A5\u4E0B\u6765\uFF0C\u6211\u4F1A\u7ED9\u4F60\u5206\u4EAB\u4E00\u4E9B\u5F88\u6709\u4EF7\u503C\u7684 Makefile \u9879\u76EE\u7BA1\u7406\u6280\u5DE7\u3002</p><h3 id="help-\u81EA\u52A8\u89E3\u6790" tabindex="-1"><a class="header-anchor" href="#help-\u81EA\u52A8\u89E3\u6790" aria-hidden="true">#</a> help \u81EA\u52A8\u89E3\u6790</h3><p>\u56E0\u4E3A\u968F\u7740\u9879\u76EE\u7684\u6269\u5C55\uFF0CMakefile \u5927\u6982\u7387\u4F1A\u4E0D\u65AD\u52A0\u5165\u65B0\u7684\u7BA1\u7406\u529F\u80FD\uFF0C\u8FD9\u4E9B\u7BA1\u7406\u529F\u80FD\u4E5F\u9700\u8981\u52A0\u5165\u5230 make help \u8F93\u51FA\u4E2D\u3002\u4F46\u5982\u679C\u6BCF\u6DFB\u52A0\u4E00\u4E2A\u76EE\u6807\uFF0C\u90FD\u8981\u4FEE\u6539 make help \u547D\u4EE4\uFF0C\u5C31\u6BD4\u8F83\u9EBB\u70E6\uFF0C\u8FD8\u5BB9\u6613\u51FA\u9519\u3002\u6240\u4EE5\u8FD9\u91CC\uFF0C\u6211\u901A\u8FC7\u81EA\u52A8\u89E3\u6790\u7684\u65B9\u5F0F\uFF0C\u6765\u751F\u6210make help\u8F93\u51FA\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment">## help: Show this help info.    </span>
.PHONY: <span class="token builtin class-name">help</span>           
help: Makefile               
  @echo <span class="token parameter variable">-e</span> <span class="token string">&quot;<span class="token entity" title="\\n">\\n</span>Usage: make &lt;TARGETS&gt; &lt;OPTIONS&gt; ...<span class="token entity" title="\\n">\\n</span><span class="token entity" title="\\n">\\n</span>Targets:&quot;</span>                         
  @sed <span class="token parameter variable">-n</span> <span class="token string">&#39;s/^##//p&#39;</span> $<span class="token operator">&lt;</span> <span class="token operator">|</span> <span class="token function">column</span> <span class="token parameter variable">-t</span> <span class="token parameter variable">-s</span> <span class="token string">&#39;:&#39;</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token parameter variable">-e</span> <span class="token string">&#39;s/^/ /&#39;</span>    
  @echo <span class="token string">&quot;<span class="token variable">$$</span>USAGE_OPTIONS&quot;</span>    
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u76EE\u6807 help \u7684\u547D\u4EE4\u4E2D\uFF0C\u901A\u8FC7 <code>sed -n &#39;s/^##//p&#39; $&lt; | column -t -s &#39;:&#39; | sed -e &#39;s/^/ /&#39;</code> \u547D\u4EE4\uFF0C\u81EA\u52A8\u89E3\u6790 <code>Makefile \u4E2D ##</code> \u5F00\u5934\u7684\u6CE8\u91CA\u884C\uFF0C\u4ECE\u800C\u81EA\u52A8\u751F\u6210 make help \u8F93\u51FA\u3002</p><h3 id="options-\u4E2D\u6307\u5B9A\u53D8\u91CF\u503C" tabindex="-1"><a class="header-anchor" href="#options-\u4E2D\u6307\u5B9A\u53D8\u91CF\u503C" aria-hidden="true">#</a> Options \u4E2D\u6307\u5B9A\u53D8\u91CF\u503C</h3><p>\u901A\u8FC7\u4EE5\u4E0B\u8D4B\u503C\u65B9\u5F0F\uFF0C\u53D8\u91CF\u53EF\u4EE5\u5728 <code>Makefile options</code> \u4E2D\u88AB\u6307\u5B9A\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>ifeq <span class="token punctuation">(</span><span class="token variable"><span class="token variable">$(</span>origin COVERAGE<span class="token variable">)</span></span>,undefined<span class="token punctuation">)</span>    
COVERAGE :<span class="token operator">=</span> <span class="token number">60</span>  
endif
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F8B\u5982\uFF0C\u5982\u679C\u6211\u4EEC\u6267\u884C<code>make</code> \uFF0C\u5219 <code>COVERAGE</code> \u8BBE\u7F6E\u4E3A\u9ED8\u8BA4\u503C <code>60</code>\uFF1B\u5982\u679C\u6211\u4EEC\u6267\u884C<code>make COVERAGE=90</code> \uFF0C\u5219 COVERAGE \u503C\u4E3A 90\u3002\u901A\u8FC7\u8FD9\u79CD\u65B9\u5F0F\uFF0C\u6211\u4EEC\u53EF\u4EE5\u66F4\u7075\u6D3B\u5730\u63A7\u5236 Makefile \u7684\u884C\u4E3A\u3002</p><h3 id="\u81EA\u52A8\u751F\u6210-changelog" tabindex="-1"><a class="header-anchor" href="#\u81EA\u52A8\u751F\u6210-changelog" aria-hidden="true">#</a> \u81EA\u52A8\u751F\u6210 CHANGELOG</h3>`,53),ds=a("\u4E00\u4E2A\u9879\u76EE\u6700\u597D\u6709 CHANGELOG \u7528\u6765\u5C55\u793A\u6BCF\u4E2A\u7248\u672C\u4E4B\u95F4\u7684\u53D8\u66F4\u5185\u5BB9\uFF0C\u4F5C\u4E3A Release Note \u7684\u4E00\u90E8\u5206\u3002\u4F46\u662F\uFF0C\u5982\u679C\u6BCF\u6B21\u90FD\u8981\u624B\u52A8\u7F16\u5199 CHANGELOG\uFF0C\u4F1A\u5F88\u9EBB\u70E6\uFF0C\u4E5F\u4E0D\u5BB9\u6613\u575A\u6301\uFF0C\u6240\u4EE5\u8FD9\u91CC\u6211\u4EEC\u53EF\u4EE5\u501F\u52A9"),us={href:"https://github.com/git-chglog/git-chglog",target:"_blank",rel:"noopener noreferrer"},ms=a("git-chglog"),ks=a("\u5DE5\u5177\u6765\u81EA\u52A8\u751F\u6210\u3002"),vs=s("p",null,[a("IAM \u9879\u76EE\u7684 git-chglog \u5DE5\u5177\u7684\u914D\u7F6E\u6587\u4EF6\u653E\u5728"),s("code",null,".chglog"),a("\u76EE\u5F55\u4E0B\uFF0C\u5728\u5B66\u4E60 git-chglog \u5DE5\u5177\u65F6\uFF0C\u4F60\u53EF\u4EE5\u53C2\u8003\u4E0B\u3002")],-1),hs=s("h3",{id:"\u81EA\u52A8\u751F\u6210\u7248\u672C\u53F7",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#\u81EA\u52A8\u751F\u6210\u7248\u672C\u53F7","aria-hidden":"true"},"#"),a(" \u81EA\u52A8\u751F\u6210\u7248\u672C\u53F7")],-1),gs=a("\u4E00\u4E2A\u9879\u76EE\u4E5F\u9700\u8981\u6709\u4E00\u4E2A\u7248\u672C\u53F7\uFF0C\u5F53\u524D\u7528\u5F97\u6BD4\u8F83\u591A\u7684\u662F\u8BED\u4E49\u5316\u7248\u672C\u53F7\u89C4\u8303\u3002\u4F46\u5982\u679C\u9760\u5F00\u53D1\u8005\u624B\u52A8\u6253\u7248\u672C\u53F7\uFF0C\u5DE5\u4F5C\u6548\u7387\u4F4E\u4E0D\u8BF4\uFF0C\u7ECF\u5E38\u8FD8\u4F1A\u51FA\u73B0\u6F0F\u6253\u3001\u6253\u7684\u7248\u672C\u53F7\u4E0D\u89C4\u8303\u7B49\u95EE\u9898\u3002\u6240\u4EE5\u6700\u597D\u7684\u529E\u6CD5\u662F\uFF0C\u7248\u672C\u53F7\u4E5F\u901A\u8FC7\u5DE5\u5177\u81EA\u52A8\u751F\u6210\u3002\u5728 IAM \u9879\u76EE\u4E2D\uFF0C\u91C7\u7528\u4E86"),bs={href:"https://github.com/arnaud-deprez/gsemver",target:"_blank",rel:"noopener noreferrer"},fs=a("gsemver"),_s=a("\u5DE5\u5177\u6765\u81EA\u52A8\u751F\u6210\u7248\u672C\u53F7\u3002"),xs=l(`<p>\u6574\u4E2A IAM \u9879\u76EE\u7684\u7248\u672C\u53F7\uFF0C\u90FD\u662F\u901A\u8FC7scripts/ensure_tag.sh\u811A\u672C\u6765\u751F\u6210\u7684\uFF1A</p><div class="language-makefile ext-makefile line-numbers-mode"><pre class="language-makefile"><code>version<span class="token operator">=</span>v\`gsemver bump\`
if [ -z <span class="token string">&quot;\`git tag -l $version\`&quot;</span> ]<span class="token punctuation">;</span>then
  git tag -a -m <span class="token string">&quot;release version $version&quot;</span> <span class="token variable">$version</span>
fi
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728 <code>scripts/ensure_tag.sh</code> \u811A\u672C\u4E2D\uFF0C\u901A\u8FC7 <code>gsemver bump</code> \u547D\u4EE4\u6765\u81EA\u52A8\u5316\u751F\u6210\u8BED\u4E49\u5316\u7684\u7248\u672C\u53F7\uFF0C\u5E76\u6267\u884C <code>git tag -a</code> \u7ED9\u4ED3\u5E93\u6253\u4E0A\u7248\u672C\u53F7\u6807\u7B7E\uFF0Cgsemver \u547D\u4EE4\u4F1A\u6839\u636E Commit Message \u81EA\u52A8\u751F\u6210\u7248\u672C\u53F7\u3002</p><p>\u4E4B\u540E\uFF0CMakefile \u548C Shell \u811A\u672C\u7528\u5230\u7684\u6240\u6709\u7248\u672C\u53F7\u5747\u7EDF\u4E00\u4F7F\u7528<a href="scripts/make-rules/common.mk">scripts/make-rules/common.mk</a>\u6587\u4EF6\u4E2D\u7684 VERSION \u53D8\u91CF\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>VERSION :<span class="token operator">=</span> <span class="token variable"><span class="token variable">$(</span>shell <span class="token function">git</span> describe <span class="token parameter variable">--tags</span> <span class="token parameter variable">--always</span> <span class="token parameter variable">--match</span><span class="token operator">=</span><span class="token string">&#39;v*&#39;</span><span class="token variable">)</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>\u4E0A\u8FF0\u7684 Shell \u547D\u4EE4\u901A\u8FC7 git describe \u6765\u83B7\u53D6\u79BB\u5F53\u524D\u63D0\u4EA4\u6700\u8FD1\u7684 tag\uFF08\u7248\u672C\u53F7\uFF09\u3002</p><p>\u5728\u6267\u884C git describe \u65F6\uFF0C\u5982\u679C\u7B26\u5408\u6761\u4EF6\u7684 tag \u6307\u5411\u6700\u65B0\u63D0\u4EA4\uFF0C\u5219\u53EA\u663E\u793A tag \u7684\u540D\u5B57\uFF0C\u5426\u5219\u4F1A\u6709\u76F8\u5173\u7684\u540E\u7F00\uFF0C\u6765\u63CF\u8FF0\u8BE5 tag \u4E4B\u540E\u6709\u591A\u5C11\u6B21\u63D0\u4EA4\uFF0C\u4EE5\u53CA\u6700\u65B0\u7684\u63D0\u4EA4 commit id\u3002\u4F8B\u5982\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">git</span> describe <span class="token parameter variable">--tags</span> <span class="token parameter variable">--always</span> <span class="token parameter variable">--match</span><span class="token operator">=</span><span class="token string">&#39;v*&#39;</span>
v1.0.0-3-g1909e47
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u8FD9\u91CC\u89E3\u91CA\u4E0B\u7248\u672C\u53F7\u4E2D\u5404\u5B57\u7B26\u7684\u542B\u4E49</strong>\uFF1A</p><ul><li>3\uFF1A\u8868\u793A\u81EA\u6253 tag v1.0.0 \u4EE5\u6765\u6709 3 \u6B21\u63D0\u4EA4\u3002</li><li><code>g1909e47\uFF1Ag</code> \u4E3A git \u7684\u7F29\u5199\uFF0C\u5728\u591A\u79CD\u7BA1\u7406\u5DE5\u5177\u5E76\u5B58\u7684\u73AF\u5883\u4E2D\u5F88\u6709\u7528\u5904\u3002</li><li><code>1909e47\uFF1A7</code> \u4F4D\u5B57\u7B26\u8868\u793A\u4E3A\u6700\u65B0\u63D0\u4EA4\u7684 commit id \u524D 7 \u4F4D\u3002</li></ul><p><strong>\u6700\u540E\u89E3\u91CA\u4E0B\u53C2\u6570\uFF1A</strong></p><ul><li><code>\u2013tags</code>\uFF0C\u4F7F\u7528\u6240\u6709\u7684\u6807\u7B7E\uFF0C\u800C\u4E0D\u662F\u53EA\u4F7F\u7528\u5E26\u6CE8\u91CA\u7684\u6807\u7B7E\uFF08annotated tag\uFF09\u3002</li><li><code>git tag</code> \u751F\u6210\u4E00\u4E2A unannotated tag\uFF0Cgit tag -a <code>&lt;tagname&gt;</code> -m <code>&lt;massage&gt;</code>&#39;&#39; \u751F\u6210\u4E00\u4E2A annotated tag\u3002</li><li><code>\u2013always</code>\uFF0C\u5982\u679C\u4ED3\u5E93\u6CA1\u6709\u53EF\u7528\u7684\u6807\u7B7E\uFF0C\u90A3\u4E48\u4F7F\u7528 commit \u7F29\u5199\u6765\u66FF\u4EE3\u6807\u7B7E\u3002</li><li><code>\u2013match</code>\uFF0C\u53EA\u8003\u8651\u4E0E\u7ED9\u5B9A\u6A21\u5F0F\u76F8\u5339\u914D\u7684\u6807\u7B7E\u3002</li></ul><h3 id="\u4FDD\u6301\u884C\u4E3A\u4E00\u81F4" tabindex="-1"><a class="header-anchor" href="#\u4FDD\u6301\u884C\u4E3A\u4E00\u81F4" aria-hidden="true">#</a> \u4FDD\u6301\u884C\u4E3A\u4E00\u81F4</h3><p>\u4E0A\u9762\u6211\u4EEC\u4ECB\u7ECD\u4E86\u4E00\u4E9B\u7BA1\u7406\u529F\u80FD\uFF0C\u4F8B\u5982\u68C0\u67E5 Commit Message \u662F\u5426\u7B26\u5408\u89C4\u8303\u3001\u81EA\u52A8\u751F\u6210 CHANGELOG\u3001\u81EA\u52A8\u751F\u6210\u7248\u672C\u53F7\u3002\u8FD9\u4E9B\u53EF\u4EE5\u901A\u8FC7 Makefile \u6765\u64CD\u4F5C\uFF0C\u6211\u4EEC\u4E5F\u53EF\u4EE5\u624B\u52A8\u6267\u884C\u3002\u4F8B\u5982\uFF0C\u901A\u8FC7\u4EE5\u4E0B\u547D\u4EE4\uFF0C\u68C0\u67E5 IAM \u7684\u6240\u6709 Commit \u662F\u5426\u7B26\u5408 Angular Commit Message \u89C4\u8303\uFF1A</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ go-gitlint
b62db1f: subject does not match regex <span class="token punctuation">[</span>^<span class="token punctuation">(</span>revert: <span class="token punctuation">)</span>?<span class="token punctuation">(</span>feat<span class="token operator">|</span>fix<span class="token operator">|</span>perf<span class="token operator">|</span>style<span class="token operator">|</span>refactor<span class="token operator">|</span><span class="token builtin class-name">test</span><span class="token operator">|</span>ci<span class="token operator">|</span>docs<span class="token operator">|</span>chore<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">\\</span><span class="token punctuation">(</span>.+<span class="token punctuation">\\</span><span class="token punctuation">))</span>?: <span class="token punctuation">[</span>^A-Z<span class="token punctuation">]</span>.*<span class="token punctuation">[</span>^.<span class="token punctuation">]</span>$<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u4E5F\u53EF\u4EE5\u901A\u8FC7\u4EE5\u4E0B\u547D\u4EE4\uFF0C\u624B\u52A8\u6765\u751F\u6210 CHANGELOG\uFF1A</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ git-chglog v1.0.0 CHANGELOG/CHANGELOG-1.0.0.md
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>\u8FD8\u53EF\u4EE5\u6267\u884C gsemver \u6765\u751F\u6210\u7248\u672C\u53F7\uFF1A</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ gsemver bump
1.0.1
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u8FD9\u91CC\u8981\u5F3A\u8C03\u7684\u662F\uFF0C\u6211\u4EEC\u8981\u4FDD\u8BC1\u4E0D\u7BA1\u4F7F\u7528\u624B\u52A8\u64CD\u4F5C\uFF0C\u8FD8\u662F\u901A\u8FC7 Makefile \u64CD\u4F5C\uFF0C\u90FD\u8981\u786E\u4FDD git commit message \u89C4\u8303\u68C0\u67E5\u7ED3\u679C\u3001\u751F\u6210\u7684 CHANGELOG\u3001\u751F\u6210\u7684\u7248\u672C\u53F7\u662F\u4E00\u81F4\u7684\u3002\u8FD9\u9700\u8981\u6211\u4EEC\u91C7\u7528\u540C\u4E00\u79CD\u64CD\u4F5C\u65B9\u5F0F\u3002</p><h2 id="\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u603B\u7ED3" aria-hidden="true">#</a> \u603B\u7ED3</h2><p>\u5728\u6574\u4E2A\u7814\u53D1\u6D41\u7A0B\u4E2D\uFF0C\u9700\u8981\u5F00\u53D1\u4EBA\u5458\u6DF1\u5EA6\u53C2\u4E0E\u7684\u9636\u6BB5\u6709\u4E24\u4E2A\uFF0C\u5206\u522B\u662F\u5F00\u53D1\u9636\u6BB5\u548C\u6D4B\u8BD5\u9636\u6BB5\u3002\u5728\u5F00\u53D1\u9636\u6BB5\uFF0C\u5F00\u53D1\u8005\u5B8C\u6210\u4EE3\u7801\u5F00\u53D1\u4E4B\u540E\uFF0C\u901A\u5E38\u9700\u8981\u6267\u884C\u751F\u6210\u4EE3\u7801\u3001\u7248\u6743\u68C0\u67E5\u3001\u4EE3\u7801\u683C\u5F0F\u5316\u3001\u9759\u6001\u4EE3\u7801\u68C0\u67E5\u3001\u5355\u5143\u6D4B\u8BD5\u3001\u6784\u5EFA\u7B49\u64CD\u4F5C\u3002\u6211\u4EEC\u53EF\u4EE5\u5C06\u8FD9\u4E9B\u64CD\u4F5C\u96C6\u6210\u5728 Makefile \u4E2D\uFF0C\u6765\u63D0\u9AD8\u6548\u7387\uFF0C\u5E76\u501F\u6B64\u7EDF\u4E00\u64CD\u4F5C\u3002</p><h2 id="end-\u94FE\u63A5" tabindex="-1"><a class="header-anchor" href="#end-\u94FE\u63A5" aria-hidden="true">#</a> END \u94FE\u63A5</h2><ul><li><div><a href="7.md" style="float:left;">\u2B06\uFE0F\u4E0A\u4E00\u8282\u{1F517} </a><a href="9.md" style="float:right;"> \uFE0F\u4E0B\u4E00\u8282\u{1F517}</a></div></li></ul>`,24),ws=a("\u24C2\uFE0F\u56DE\u5230\u76EE\u5F55\u{1F3E0}"),Cs={href:"https://nsddd.top/archives/contributors",target:"_blank",rel:"noopener noreferrer"},ys=s("strong",null,"\u{1FAF5}\u53C2\u4E0E\u8D21\u732E\u{1F49E}\u2764\uFE0F\u200D\u{1F525}\u{1F496}",-1),As=a(")"),Es=a("\u2734\uFE0F\u7248\u6743\u58F0\u660E \xA9 \uFF1A\u672C\u4E66\u6240\u6709\u5185\u5BB9\u9075\u5FAA"),Gs={href:"http://zh.wikipedia.org/wiki/Wikipedia:CC-by-sa-3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC",target:"_blank",rel:"noopener noreferrer"},Is=a("CC-BY-SA 3.0\u534F\u8BAE\uFF08\u7F72\u540D-\u76F8\u540C\u65B9\u5F0F\u5171\u4EAB\uFF09\xA9");function $s(Ms,qs){const o=i("ExternalLinkIcon"),t=i("router-link"),p=i("RouterLink");return r(),d("div",null,[s("ul",null,[s("li",null,[s("a",m,[k,n(o)])])]),v,h,g,b,s("blockquote",null,[s("p",null,[f,s("a",_,[x,n(o)])])]),w,s("nav",C,[s("ul",null,[s("li",null,[n(t,{to:"#\u5F00\u59CB"},{default:e(()=>[y]),_:1})]),s("li",null,[n(t,{to:"#\u7B2C\u4E00\u6B65-\u65B0\u5EFA\u5206\u652F"},{default:e(()=>[A]),_:1})]),s("li",null,[n(t,{to:"#\u7B2C\u4E8C\u6B65-\u6DFB\u52A0\u81EA\u52A8\u5316\u547D\u4EE4"},{default:e(()=>[E]),_:1})]),s("li",null,[n(t,{to:"#\u7B2C\u4E09\u6B65-\u751F\u6210\u4EE3\u7801"},{default:e(()=>[G]),_:1})]),s("li",null,[n(t,{to:"#\u7B2C\u56DB\u6B65-\u7248\u6743\u68C0\u67E5"},{default:e(()=>[I]),_:1}),s("ul",null,[s("li",null,[n(t,{to:"#\u5982\u4F55\u5B89\u88C5-addlicense"},{default:e(()=>[$]),_:1})]),s("li",null,[n(t,{to:"#\u5982\u4F55\u4F7F\u7528-addlicense"},{default:e(()=>[M]),_:1})]),s("li",null,[n(t,{to:"#\u652F\u6301\u7684\u8BB8\u53EF\u8BC1\u7C7B\u578B"},{default:e(()=>[q]),_:1})])])]),s("li",null,[n(t,{to:"#\u7B2C\u4E94\u6B65-\u4EE3\u7801\u683C\u5F0F\u5316"},{default:e(()=>[N]),_:1})]),s("li",null,[n(t,{to:"#\u7B2C\u516D\u6B65-\u9759\u6001\u4EE3\u7801\u68C0\u67E5"},{default:e(()=>[O]),_:1})]),s("li",null,[n(t,{to:"#\u7B2C\u4E03\u6B65-\u5355\u5143\u6D4B\u8BD5"},{default:e(()=>[H]),_:1})]),s("li",null,[n(t,{to:"#\u7B2C\u516B\u6B65-\u6784\u5EFA"},{default:e(()=>[S]),_:1})]),s("li",null,[n(t,{to:"#\u4EE3\u7801\u63D0\u4EA4"},{default:e(()=>[L]),_:1}),s("ul",null,[s("li",null,[n(t,{to:"#github-action-\u914D\u7F6E"},{default:e(()=>[R]),_:1})])])]),s("li",null,[n(t,{to:"#\u6D4B\u8BD5\u9636\u6BB5"},{default:e(()=>[T]),_:1})]),s("li",null,[n(t,{to:"#iam-\u9879\u76EE\u7684-makefile-\u9879\u76EE\u7BA1\u7406\u6280\u5DE7"},{default:e(()=>[V]),_:1}),s("ul",null,[s("li",null,[n(t,{to:"#help-\u81EA\u52A8\u89E3\u6790"},{default:e(()=>[D]),_:1})]),s("li",null,[n(t,{to:"#options-\u4E2D\u6307\u5B9A\u53D8\u91CF\u503C"},{default:e(()=>[B]),_:1})]),s("li",null,[n(t,{to:"#\u81EA\u52A8\u751F\u6210-changelog"},{default:e(()=>[j]),_:1})]),s("li",null,[n(t,{to:"#\u81EA\u52A8\u751F\u6210\u7248\u672C\u53F7"},{default:e(()=>[P]),_:1})]),s("li",null,[n(t,{to:"#\u4FDD\u6301\u884C\u4E3A\u4E00\u81F4"},{default:e(()=>[z]),_:1})])])]),s("li",null,[n(t,{to:"#\u603B\u7ED3"},{default:e(()=>[F]),_:1})]),s("li",null,[n(t,{to:"#end-\u94FE\u63A5"},{default:e(()=>[Y]),_:1})])])]),U,s("ul",null,[K,W,s("li",null,[Z,X,J,Q,s("a",ss,[as,n(o)]),ns])]),es,s("p",null,[ts,s("a",os,[ls,n(o)]),is,ps,cs]),rs,s("p",null,[ds,s("a",us,[ms,n(o)]),ks]),vs,hs,s("p",null,[gs,s("a",bs,[fs,n(o)]),_s]),xs,s("ul",null,[s("li",null,[s("p",null,[n(p,{to:"/projects/"},{default:e(()=>[ws]),_:1})])]),s("li",null,[s("p",null,[s("a",Cs,[ys,n(o)]),As])]),s("li",null,[s("p",null,[Es,s("a",Gs,[Is,n(o)])])])])])}const Os=c(u,[["render",$s],["__file","8.html.vue"]]);export{Os as default};
